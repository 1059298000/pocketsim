(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{206:function(e,t,n){"use strict";(function(e){var a=n(1),r=n(353),i=n(18),o=n(16),s=n(37),c=n(36),l=n(38),u=n(0),d=n.n(u),h=n(48),p=n(90),m=n.n(p),g=n(12),f=n.n(g),v=n(17),b=n.n(v),M=n(89),S=n.n(M),y=n(91),x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return Math.min(Math.max(e,t),n)};function O(e,t,n,a){return e.addEventListener(t,n,a),{remove:function(){e.removeEventListener(t,n,a)}}}function w(e,t,n){return(n-t)*e/100+t}function j(t,n,a,r){var i=t.getBoundingClientRect(),o=i.width,s=i.height,c=function(t){var n=e,a=n.scrollY,r=n.scrollX,i=t.getBoundingClientRect(),o=i.left;return{top:i.top+a,left:o+r}}(t),l=c.top,u=c.left,d=function(e){return e.changedTouches&&e.changedTouches[0]?{x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY}:{x:e.pageX,y:e.pageY}}(n),h=d.x,p=d.y,m=a?p-l:h-u,g=(a?s:o)/100;return r?100-x(m/g):x(m/g)}function E(e){e.preventDefault()}var T=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={currentState:"initial"},n.handleKeyDown=function(e){var t,a=n.props,r=a.min,i=a.max,o=a.value,s=Math.abs((i-r)/100),c=n.props.step||s;switch(m()(e)){case"home":t=r;break;case"end":t=i;break;case"page up":t=o+10*s;break;case"page down":t=o-10*s;break;case"right":case"up":t=o+c;break;case"left":case"down":t=o-c;break;default:return}e.preventDefault(),t=x(t,r,i),n.emitChange(e,t)},n.handleFocus=function(){n.setState({currentState:"focused"})},n.handleBlur=function(){n.setState({currentState:"normal"})},n.handleClick=function(e){var t=n.props,a=t.min,r=t.max,i=t.vertical,o=t.reverse,s=w(j(n.container,e,i,o),a,r);n.emitChange(e,s,function(){n.playJumpAnimation()})},n.handleTouchStart=function(e){n.setState({currentState:"activated"}),n.globalMouseUpListener=O(document,"touchend",n.handleMouseUp),"function"===typeof n.props.onDragStart&&n.props.onDragStart(e)},n.handleMouseDown=function(e){n.setState({currentState:"activated"}),n.globalMouseUpListener=O(document,"mouseup",n.handleMouseUp),n.globalMouseMoveListener=O(document,"mousemove",n.handleMouseMove),"function"===typeof n.props.onDragEnd&&n.props.onDragEnd(e)},n.handleMouseUp=function(e){n.setState({currentState:"normal"}),n.globalMouseUpListener&&n.globalMouseUpListener.remove(),n.globalMouseMoveListener&&n.globalMouseMoveListener.remove(),"function"===typeof n.props.onDragEnd&&n.props.onDragEnd(e)},n.handleMouseMove=function(e){var t=n.props,a=t.min,r=t.max,i=t.vertical,o=t.reverse,s=w(j(n.container,e,i,o),a,r);n.emitChange(e,s)},n}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.container&&this.container.addEventListener("touchstart",E,{passive:!1})}},{key:"componentWillUnmount",value:function(){this.container.removeEventListener("touchstart",E,{passive:!1})}},{key:"emitChange",value:function(e,t,n){var a=this.props,r=a.step,i=a.trackValue,o=a.value,s=a.onChange,c=t;c=r?function(e,t){return Math.round(e/t)*t}(t,r):Number(t.toFixed(3)),"function"===typeof s&&c!==o&&(s(e,Math.min(c,i)),"function"===typeof n&&n())}},{key:"calculateTrackAfterStyles",value:function(e){switch(this.state.currentState){case"activated":return"calc(100% - ".concat(0===e?7:5,"px)");case"disabled":return"calc(".concat(100-e,"% - 6px)");default:return"calc(100% - 5px)"}}},{key:"calculateTrackBeforeStyles",value:function(e){switch(this.state.currentState){case"disabled":return"calc(".concat(e,"% - 6px)");default:return"".concat(e,"%")}}},{key:"playJumpAnimation",value:function(){var e=this;this.setState({currentState:"jumped"},function(){setTimeout(function(){e.setState({currentState:"normal"})},e.props.theme.transitions.duration.complex)})}},{key:"render",value:function(){var e,t,n=this,i=this.state.currentState,o=this.props,s=o.component,c=o.classes,l=o.value,u=o.trackValue,p=o.min,m=o.max,g=o.vertical,v=o.reverse,b=o.disabled,M=Object(r.a)(o,["component","classes","value","trackValue","min","max","vertical","reverse","disabled"]),y=x(100*(l-p)/(m-p)),O=x(100*(u-p)/(m-p)),w=(e={},Object(a.a)(e,c.disabled,b),Object(a.a)(e,c.jumped,!b&&"jumped"===i),Object(a.a)(e,c.focused,!b&&"focused"===i),Object(a.a)(e,c.activated,!b&&"activated"===i),e),j=f()(c.container,(t={},Object(a.a)(t,c.vertical,g),Object(a.a)(t,c.reverse,v),Object(a.a)(t,c.disabled,b),t)),E=f()(c.track,c.trackBefore,w,Object(a.a)({},c.vertical,g)),T=f()(c.track,c.trackAfter,w,Object(a.a)({},c.vertical,g)),P=f()(c.thumb,w,Object(a.a)({},c.zero,0===y)),A=g?"height":"width",k=g?"top":"left",C=Object(a.a)({},A,this.calculateTrackBeforeStyles(O)),L=Object(a.a)({},A,this.calculateTrackAfterStyles(O)),R=Object(a.a)({},k,"".concat(y,"%"));return d.a.createElement(s,Object.assign({role:"slider",className:j,"aria-valuenow":l,"aria-valuemin":p,"aria-valuemax":m,"aria-orientation":g?"vertical":"horizontal",onClick:this.handleClick,ref:function(e){n.container=Object(h.findDOMNode)(e)}},M),d.a.createElement("div",{className:E,style:C}),d.a.createElement(S.a,{className:P,disableRipple:!0,style:R,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onMouseDown:this.handleMouseDown,onTouchStartCapture:this.handleTouchStart,onTouchMove:this.handleMouseMove,onFocusVisible:this.handleFocus}),d.a.createElement("div",{className:T,style:L}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.disabled?{currentState:"disabled"}:e.disabled||"disabled"!==t.currentState?null:{currentState:"normal"}}}]),t}(d.a.Component);T.defaultProps={min:0,max:100,value:50,component:"div"},t.a=b()(function(e){var t={duration:e.transitions.duration.short,easing:e.transitions.easing.easeOut},n=e.transitions.create(["width","height","box-shadow","left","top"],t),a={loaded:"#999999",loading:"#777777",handle:"#dddddd",primary:e.palette.primary.main,secondary:e.palette.grey[400],focused:e.palette.grey[500],disabled:e.palette.grey[400]};return{container:{position:"relative",width:"100%",margin:"10px 0",padding:"6px 0",cursor:"pointer",WebkitTapHighlightColor:"transparent","&$disabled":{cursor:"no-drop"},"&$vertical":{height:"100%",margin:"0 10px",padding:"0 6px"},"&$reverse":{transform:"scaleX(-1)"},"&$vertical$reverse":{transform:"scaleY(-1)"}},track:{position:"absolute",transform:"translate(0, -50%)",top:"50%",height:2,"&$focused, &$activated":{transition:"none"},"&$disabled":{backgroundColor:a.secondary},"&$vertical":{transform:"translate(-50%, 0)",left:"50%",top:"initial",width:2},"&$jumped":{}},trackBefore:{zIndex:1,left:0,backgroundColor:a.loaded,transition:n,"&$focused, &$activated, &$jumped":{backgroundColor:a.loaded}},trackAfter:{right:0,backgroundColor:a.loading,transition:n,"&$vertical":{bottom:0}},thumb:{position:"absolute",zIndex:2,transform:"translate(-50%, -50%)",width:12,height:12,borderRadius:"50%",transition:n,backgroundColor:a.handle,"&$focused":{boxShadow:"0px 0px 0px 9px ".concat(Object(y.fade)(a.handle,.16))},"&$activated":{width:17,height:17,transition:"none"},"&$disabled":{cursor:"no-drop",width:9,height:9,backgroundColor:a.disabled},"&$zero":{border:"2px solid ".concat(a.disabled),backgroundColor:"transparent"},"&$focused$zero":{border:"2px solid ".concat(a.focused),backgroundColor:Object(y.fade)(a.focused,.34),boxShadow:"0px 0px 0px 9px ".concat(Object(y.fade)(a.focused,.34))},"&$activated$zero":{border:"2px solid ".concat(a.focused)},"&$jumped":{width:17,height:17}},focused:{},activated:{},disabled:{},zero:{},vertical:{},reverse:{},jumped:{}}},{name:"MuiSlider",withTheme:!0})(T)}).call(this,n(30))},323:function(e,t,n){e.exports=n.p+"static/media/pocketnc.2eac3182.png"},354:function(e,t,n){e.exports=n(798)},359:function(e,t,n){},378:function(e,t){},380:function(e,t){},412:function(e,t){},413:function(e,t){},480:function(e,t){},672:function(e,t){ace.define("ace/mode/gcode_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(e,t,n){var a=e("../lib/oop"),r=e("./text_highlight_rules").TextHighlightRules,i=function(){var e=this.createKeywordMapper({"support.function":"ATAN|ABS|ACOS|ASIN|SIN|COS|EXP|FIX|FUP|ROUND|LN|TAN",keyword:"IF|DO|WHILE|ENDWHILE|CALL|ENDIF|SUB|ENDSUB|GOTO|REPEAT|ENDREPEAT|CALL","constant.language":"PI"},"identifier",!0);this.$rules={start:[{token:"comment",regex:"\\(.*\\)"},{token:"blockNumber",regex:"([N])([0-9]+)"},{token:"string",regex:"([G])([0-9]+\\.?[0-9]?)"},{token:"string",regex:"([M])([0-9]+\\.?[0-9]?)"},{token:"constant.numeric",regex:"([-+]?([0-9]*\\.?[0-9]+\\.?))|(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)"},{token:e,regex:"[A-Z]"},{token:"keyword.operator",regex:"EQ|LT|GT|NE|GE|LE|OR|XOR"},{token:"paren.lparen",regex:"[\\[]"},{token:"paren.rparen",regex:"[\\]]"},{token:"text",regex:"\\s+"}]}};a.inherits(i,r),t.GcodeHighlightRules=i}),ace.define("ace/mode/gcode",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/gcode_highlight_rules","ace/range"],function(e,t,n){var a=e("../lib/oop"),r=e("./text").Mode,i=e("./gcode_highlight_rules").GcodeHighlightRules,o=function(){this.HighlightRules=i,this.$behaviour=this.$defaultBehaviour};a.inherits(o,r),function(){this.$id="ace/mode/gcode"}.call(o.prototype),t.Mode=o})},675:function(e,t,n){},798:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"BASE",function(){return we}),n.d(a,"B_AXIS",function(){return je}),n.d(a,"A_AXIS",function(){return Ee}),n.d(a,"Y_AXIS",function(){return Te}),n.d(a,"TOOL",function(){return Pe}),n.d(a,"DENTAL_FIXTURE",function(){return Ae});var r={};n.r(r),n.d(r,"ABSOLUTE",function(){return Le}),n.d(r,"INCREMENTAL",function(){return Re}),n.d(r,"ABSOLUTE_ARC",function(){return Ie}),n.d(r,"INCREMENTAL_ARC",function(){return Ge});var i={};n.r(i),n.d(i,"INVERSE_TIME",function(){return De}),n.d(i,"UNITS_PER_MINUTE",function(){return Ne}),n.d(i,"UNITS_PER_REVOLUTION",function(){return _e});var o={};n.r(o),n.d(o,"FIVE_AXIS",function(){return ze}),n.d(o,"TRIVIAL",function(){return Fe});var s={};n.r(s),n.d(s,"XY",function(){return Ze}),n.d(s,"ZX",function(){return Ve}),n.d(s,"YZ",function(){return Be}),n.d(s,"UV",function(){return He}),n.d(s,"WU",function(){return Ue}),n.d(s,"VW",function(){return Xe});var c={};n.r(c),n.d(c,"IN",function(){return Ye}),n.d(c,"MM",function(){return We});var l={};n.r(l),n.d(l,"OFF",function(){return Ke});var u={};n.r(u),n.d(u,"LOAD_MODEL",function(){return Je}),n.d(u,"POSITION_MODEL",function(){return qe}),n.d(u,"EDIT_PATH",function(){return $e}),n.d(u,"PREVIEW_PATH",function(){return Qe}),n.d(u,"CUT_PATH",function(){return et}),n.d(u,"FIXTURE_HEIGHT",function(){return tt});var d={};n.r(d),n.d(d,"toolOrientation",function(){return _t}),n.d(d,"workPieceSpace",function(){return zt}),n.d(d,"forwardFiveAxis",function(){return Ft}),n.d(d,"inverseFiveAxis",function(){return Zt}),n.d(d,"kinematics",function(){return Vt}),n.d(d,"limits",function(){return Bt}),n.d(d,"jointLabels",function(){return Ht}),n.d(d,"getLimitErrors",function(){return Ut});var h={};n.r(h),n.d(h,"toolOrientation",function(){return Xt}),n.d(h,"workPieceSpace",function(){return Yt}),n.d(h,"forwardFiveAxis",function(){return Wt}),n.d(h,"inverseFiveAxis",function(){return Kt}),n.d(h,"kinematics",function(){return Jt}),n.d(h,"limits",function(){return qt}),n.d(h,"jointLabels",function(){return $t}),n.d(h,"getLimitErrors",function(){return Qt});var p={};n.r(p),n.d(p,"messages",function(){return Oa}),n.d(p,"annotations",function(){return wa}),n.d(p,"maxLimitMessage",function(){return ja}),n.d(p,"minLimitMessage",function(){return Ea}),n.d(p,"unimplementedMessages",function(){return Ta}),n.d(p,"nonSummarizedErrors",function(){return Pa}),n.d(p,"nonSummarizedWarnings",function(){return Aa}),n.d(p,"setToolLengthOffsetMessages",function(){return ka});var m=n(0),g=n.n(m),f=n(48),v=n.n(f),b=(n(359),n(28)),M=n(69),S=n(7),y=Object(S.b)({MACHINE_STATE:{DISTANCE_MODE:{SET_ABSOLUTE:void 0,SET_INCREMENTAL:void 0,SET_ABSOLUTE_ARC:void 0,SET_INCREMENTAL_ARC:void 0}}}),x=Object(S.b)({MACHINE_STATE:{FEED_RATE_MODE:{SET_INVERSE_TIME:void 0,SET_UNITS_PER_MINUTE:void 0,SET_UNITS_PER_REVOLUTION:void 0}}}),O=Object(S.b)({MACHINE_STATE:{FEED_RATE:{SET:function(e){return e}}}}),w=Object(S.b)({MACHINE_STATE:{UNITS:{SET_IN:void 0,SET_MM:void 0}}}),j=Object(S.b)({MACHINE_STATE:{KINEMATICS_MODE:{SET_FIVE_AXIS:void 0,SET_TRIVIAL:void 0}}}),E=Object(S.b)({MACHINE_STATE:{CUTTER_COMPENSATION:{OFF:void 0}}}),T=Object(S.b)({MACHINE_STATE:{MOTION:{OFF:void 0,RAPID:void 0,LINEAR:void 0,ARC_C_W:void 0,ARC_C_C_W:void 0,SET_POSITION:void 0,NON_MOTION_COMMAND:void 0}}}),P=Object(S.b)({MACHINE_STATE:{PLANE_SELECT:{SET_X_Y:void 0,SET_Z_X:void 0,SET_Y_Z:void 0,SET_U_V:void 0,SET_W_U:void 0,SET_V_W:void 0}}}),A=Object(S.b)({MACHINE_STATE:{SPINDLE_CONTROL:{OFF:void 0,CW:void 0,CCW:void 0}}}),k=Object(S.b)({MACHINE_STATE:{SPINDLE_SPEED:{SET:void 0}}}),C=Object(S.b)({MACHINE_STATE:{TOOL:{SET:void 0,CHANGE:void 0,SET_TOOL_LENGTH_OFFSET:void 0,CLEAR_TOOL_LENGTH_OFFSET:void 0,TABLE:{SET_TOOL:void 0}}}}),L=Object(S.b)({MACHINE_STATE:{MACHINE:{SET:void 0}}}),R={machineState:Object(M.a)({},y.machineState,x.machineState,O.machineState,j.machineState,P.machineState,w.machineState,E.machineState,T.machineState,A.machineState,k.machineState,C.machineState,L.machineState)},I=Object(S.b)({INTERPRETER:{SET_FILE_NAME:void 0,START_LOADING:void 0,END_LOADING:void 0,SET_LOADING_PROGRESS:void 0,SET_LINES:function(e,t){return{lines:e,preview:t}},START_PROCESSING:void 0,END_PROCESSING:void 0,SET_PROCESSING_PROGRESS:void 0,SET_INITIAL_STATE:void 0,APPEND_INDICES:void 0,APPEND_TIMES:void 0,APPEND_MESSAGES:void 0,INCREMENT_TIME:void 0,SET_CURRENT_LINE_WITH_PERCENTAGE:void 0,SET_CURRENT_LINE_WITH_TIME:void 0,SET_CURRENT_LINE:void 0,NEXT_LINE:void 0,PREVIOUS_LINE:void 0,PAUSE:void 0,UNPAUSE:void 0,RUN:void 0,STOP:void 0,SET_TIME_MULTIPLIER:void 0}}),G=Object(S.b)({UI:{GCODE_PANE:{TOGGLE_PANE:void 0,SET_WIDTH:void 0,SET_SELECTED:void 0,SET_LINE_OFFSET:void 0,SET_SHOW_LINES:void 0,SCROLL:void 0,SET_TAB:void 0}}}),D=Object(S.b)({UI:{CONTROLS_OVERLAY:{SET_VISIBLE:void 0,TOGGLE_PANE:void 0,PLAY:void 0,PREVIOUS:void 0,NEXT:void 0,HOME:void 0,SHUFFLE:void 0}}}),N={ui:Object(M.a)({},G.ui,D.ui)},_=Object(S.b)({IFRAME:{INITIALIZE:void 0,ROCKHOPPER:void 0,TO_ROCKHOPPER:void 0,EMBED_GCODE:void 0}}),z=Object(S.b)({VIEWER3D:{PARENT_CAMERA:void 0,SHOW_MODEL:void 0,HIDE_MODEL:void 0,LOAD_MODEL:void 0,SET_PERSPECTIVE:void 0,SET_ORTHOGRAPHIC:void 0,SET_DIMENSIONS:function(e,t){return{width:e,height:t}},CAMERA_ZOOM:void 0,CAMERA_START_ROTATING:void 0,CAMERA_ROTATE:function(e,t){return{dx:e,dy:t}},CAMERA_STOP_ROTATING:void 0,CAMERA_SET_DIRECTION:function(e,t,n){return{x:e,y:t,z:n}},CAMERA_SET_RADIUS:void 0,CAMERA_SET_ORTHOGRAPHIC_ZOOM:void 0,CAMERA_SET_PHI:void 0,CAMERA_SET_THETA:void 0}}),F=Object(S.b)({ALIGNER_STATE:{SET_RFID:void 0,SET_STEP:void 0,MODEL_LOADED:void 0,MODEL_UPLOADED:void 0,FINISHED_PROCESSING:void 0,FINALIZE_MODEL:void 0,FINALIZE_MODEL_CLICK:void 0,CLEAR_FINALIZE_MODEL_CLICK:void 0,UPLOAD_MODEL:void 0,LOADING:function(e,t,n,a){return{id:e,label:t,variant:n,progress:a}},LOADING_PROGRESS:function(e,t){return{id:e,progress:t}},STOP_LOADING:function(e){return{id:e}},ALIGNER_STATUS_RESPONSE:void 0,DOWNLOAD_PROCESSED_MODEL:void 0,DOWNLOAD_G_CODE:void 0,SET_JOINTS:void 0,RESET_TO_DEFAULTS:void 0,SHOW_GHOST_SPHERE:void 0,HIDE_GHOST_SPHERE:void 0,SET_GHOST_SPHERE_OPACITY:void 0,SET_GHOST_SPHERE_POSITION:function(e,t,n){return{x:e,y:t,z:n}},ADD_POINT:function(e,t,n,a,r,i){return{posx:e,posy:t,posz:n,dirx:a,diry:r,dirz:i}},UPDATE_POINT_POSITION:function(e,t,n){return{posx:e,posy:t,posz:n}},DELETE_POINT:void 0,CLOSE_PATH:void 0,SET_ACTIVE_POINT:void 0,NEXT_POINT:void 0,PREV_POINT:void 0,INCREMENT_TIME:void 0,PLAY:void 0,PAUSE:void 0,SET_TIME_MULTIPLIER:void 0,SET_TIME_WITH_PERCENTAGE:void 0,SET_HIGHLIGHTED_POINT:void 0,START_ROTATING_MACHINE:function(e,t){return{x:e,y:t}},ROTATE_MACHINE:function(e,t){return{x:e,y:t}},STOP_ROTATING_MACHINE:void 0,SET_DIMENSIONS:function(e,t){return{width:e,height:t}},SAVE_TRANSFORM:void 0,TRANSFORM_SAVED:void 0,SAVE_POINTS:void 0,POINTS_SAVED:void 0,RESET_STATE:void 0,SET_HIGHLIGHT_MODEL:void 0,SET_DRAG_MODEL_START_POINT:function(e,t){return{x:e,z:t}},DRAG_MODEL:function(e,t){return{x:e,z:t}},SET_MODEL_ORIENTATION:function(e,t,n){return{x:e,y:t,z:n}},SET_MODEL_POSITION:function(e,t,n){return{x:e,y:t,z:n}},ROTATE_C_W:void 0,ROTATE_C_C_W:void 0,SET_MACHINE:void 0,IMPORT_TRANSFORM_AND_POINTS:void 0,CANCEL_IMPORT_TRANSFORM_AND_POINTS:void 0,IMPORTED_TRANSFORM_AND_POINTS:void 0,SET_TIMES:void 0}}),Z=Object(S.b)({RFID:{RECEIVED_RFID_SCAN_MESSAGE:void 0,RECEIVED_ERROR_MESSAGE:void 0,RECEIVED_INCOMPLETE_MESSAGE:void 0,CONNECTED_SCANNER:void 0,DISCONNECTED_SCANNER:void 0}}),V=Object(M.a)({},R,I,N,_,z,F,Z),B=n(18),H=n(16),U=n(37),X=n(36),Y=n(38),W=n(52),K=n(29),J=n.n(K),q=n(201),$=n.n(q),Q=n(319),ee=n.n(Q),te=function(){function e(){Object(B.a)(this,e),this.callback=function(e){e&&console.error("Error while issuing analytics request",e)};var t=window.sessionStorage,n=t.getItem("uuid");n||(n=$()(),t.setItem("uuid",n)),this.visitor=ee()("UA-129057873-2",n),this.originalVisitor=this.visitor}return Object(H.a)(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),Object(H.a)(e,[{key:"pageview",value:function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return this.visitor=(e=this.visitor).pageview.apply(e,n),this}},{key:"send",value:function(){return this.visitor.send(),this.visitor=this.originalVisitor,this}},{key:"event",value:function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return this.visitor=(e=this.visitor).event.apply(e,n),this}},{key:"exception",value:function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return this.visitor=(e=this.visitor).exception.apply(e,n),this}},{key:"timing",value:function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return this.visitor=(e=this.visitor).timing.apply(e,n),this}}]),e}().getInstance,ne=n(42),ae=n(320),re=n.n(ae),ie=n(321),oe=n.n(ie),se=ne;re()(se),se.STLLoader=oe()(se);var ce=se,le=function(){return new ce.ShaderMaterial({uniforms:{offset:{value:.004},minTime:{value:0},maxTime:{value:9999999999},minLine:{value:0},maxLine:{value:9999999999},maxY:{value:99999999},maxXZ:{value:99999999}},vertexColors:ce.VertexColors,vertexShader:"\nuniform float minTime;\nuniform float maxTime;\nuniform float minLine;\nuniform float maxLine;\nuniform float offset;\nuniform float maxXZ;\nuniform float maxY;\n\nattribute float line;\nattribute float time;\nattribute float speed;\nvarying vec3 vPos;\nvarying vec3 vColor;\nvarying float vLine;\nvarying float vTime;\nvoid main() {\n  vPos = position + offset*normal;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( vPos, 1.0 );\n  vColor = color;\n  vLine = line;\n  vTime = time;\n}\n",fragmentShader:"\nuniform float minTime;\nuniform float maxTime;\nuniform float minLine;\nuniform float maxLine;\nuniform float maxXZ;\nuniform float maxY;\n\nvarying vec3 vColor;\nvarying vec3 vPos;\nvarying float vLine;\nvarying float vTime;\nvoid main()\t{\n  if(length(vPos.xz) > maxXZ || \n     abs(vPos.y) > maxY ||\n     vTime < minTime || vTime > maxTime ||\n     vLine < minLine || vLine > maxLine) {\n\n    discard;\n  }\n  gl_FragColor = vec4(vColor, 1.);\n}\n"})},ue=new Float32Array([0,0,.5]),de=new Float32Array([1,1,1]),he=(new Float32Array([1,.5,0]),new Float32Array([0,0,1]),function(){function e(t,n){Object(B.a)(this,e);var a="object"===typeof t;if(this.capacity=a?2*t.capacity:t,this.numPoints=0,this.geometry=new ce.BufferGeometry,this.vertices=new Float32Array(3*this.capacity),this.colors=new Float32Array(3*this.capacity),this.normals=new Float32Array(3*this.capacity),this.lines=new Float32Array(this.capacity),this.times=new Float32Array(this.capacity),a){var r=t;this.vertices.set(r.vertices),this.colors.set(r.colors),this.normals.set(r.normals),this.lines.set(r.lines),this.times.set(r.times),this.geometry.setDrawRange(r.geometry.drawRange.start,r.geometry.drawRange.count),this.numPoints=r.numPoints}this.geometry.addAttribute("position",new ce.BufferAttribute(this.vertices,3)),this.geometry.addAttribute("color",new ce.BufferAttribute(this.colors,3)),this.geometry.addAttribute("normal",new ce.BufferAttribute(this.normals,3)),this.geometry.addAttribute("line",new ce.BufferAttribute(this.lines,1)),this.geometry.addAttribute("time",new ce.BufferAttribute(this.times,1)),a&&(this.geometry.attributes.position.updateRange.offset=0,this.geometry.attributes.color.updateRange.offset=0,this.geometry.attributes.normal.updateRange.offset=0,this.geometry.attributes.line.updateRange.offset=0,this.geometry.attributes.time.updateRange.offset=0,this.geometry.attributes.position.updateRange.count=3*this.numPoints,this.geometry.attributes.color.updateRange.count=3*this.numPoints,this.geometry.attributes.normal.updateRange.count=3*this.numPoints,this.geometry.attributes.line.updateRange.count=this.numPoints,this.geometry.attributes.time.updateRange.count=this.numPoints,this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.color.needsUpdate=!0,this.geometry.attributes.normal.needsUpdate=!0,this.geometry.attributes.line.needsUpdate=!0,this.geometry.attributes.time.needsUpdate=!0),this.geometry.attributes.position.setDynamic(!0),this.geometry.attributes.color.setDynamic(!0),this.geometry.attributes.normal.setDynamic(!0),this.geometry.attributes.line.setDynamic(!0),this.geometry.attributes.time.setDynamic(!0),this.geometry.setDrawRange(0,0),this.object=new ce.Line(this.geometry,n),this.object.frustumCulled=!1}return Object(H.a)(e,[{key:"clear",value:function(){this.numPoints=0,this.updateDrawRange()}},{key:"updateDrawRange",value:function(){this.geometry.setDrawRange(0,this.numPoints)}},{key:"updateAttribute",value:function(e,t,n){var a=this.geometry.attributes[e];a.updateRange.count>-1?(a.updateRange.count+=n,a.needsUpdate=!0):(a.updateRange.offset=t,a.updateRange.count=n,a.needsUpdate=!0)}},{key:"addPoint",value:function(e){var t=3*this.numPoints;this.vertices[t]=e.position[0],this.vertices[t+1]=e.position[1],this.vertices[t+2]=e.position[2],this.colors[t]=e.color[0],this.colors[t+1]=e.color[1],this.colors[t+2]=e.color[2],this.normals[t]=e.normal[0],this.normals[t+1]=e.normal[1],this.normals[t+2]=e.normal[2],this.lines[this.numPoints]=e.line,this.times[this.numPoints]=e.time,this.updateAttribute("position",t,3),this.updateAttribute("color",t,3),this.updateAttribute("normal",t,3),this.updateAttribute("line",this.numPoints,1),this.updateAttribute("time",this.numPoints,1),this.numPoints++,this.updateDrawRange()}}]),e}()),pe=function(){function e(){Object(B.a)(this,e),this.material=le(),this.object=new ce.Group,this.lineObject=new he(1e5,this.material),this.object.frustumCulled=!1,this.object.add(this.lineObject.object)}return Object(H.a)(e,null,[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),Object(H.a)(e,[{key:"clear",value:function(){this.lineObject.clear()}},{key:"setMaxXZ",value:function(e){this.material.uniforms.maxXZ.value=e}},{key:"setMaxY",value:function(e){this.material.uniforms.maxY.value=e}},{key:"setOffset",value:function(e){this.material.uniforms.offset.value=e}},{key:"setMinLine",value:function(e){this.material.uniforms.minLine.value=e}},{key:"setMaxLine",value:function(e){this.material.uniforms.maxLine.value=e}},{key:"setMinTime",value:function(e){this.material.uniforms.minTime.value=e}},{key:"setMaxTime",value:function(e){this.material.uniforms.maxTime.value=e}},{key:"addPoints",value:function(e){var t=this;e.forEach(function(e){t.lineObject.numPoints===t.lineObject.capacity&&(t.object.remove(t.lineObject.object),t.lineObject=new he(t.lineObject,t.material),t.object.add(t.lineObject.object)),t.lineObject.addPoint(e)})}}]),e}(),me=(new Float32Array([0,0,.5]),new Float32Array([1,1,1]),new Float32Array([1,.5,0]),new Float32Array([0,0,1]),function(){function e(t,n){Object(B.a)(this,e);var a="object"===typeof t;if(this.capacity=a?2*t.capacity:t,this.numPoints=0,this.geometry=new ce.BufferGeometry,this.vertices=new Float32Array(3*this.capacity),this.colors=new Float32Array(3*this.capacity),this.normals=new Float32Array(3*this.capacity),this.lines=new Float32Array(this.capacity),this.times=new Float32Array(this.capacity),a){var r=t;this.vertices.set(r.vertices),this.colors.set(r.colors),this.normals.set(r.normals),this.lines.set(r.lines),this.times.set(r.times),this.geometry.setDrawRange(r.geometry.drawRange.start,r.geometry.drawRange.count),this.numPoints=r.numPoints}this.geometry.addAttribute("position",new ce.BufferAttribute(this.vertices,3)),this.geometry.addAttribute("normal",new ce.BufferAttribute(this.normals,3)),a&&(this.geometry.attributes.position.updateRange.offset=0,this.geometry.attributes.normal.updateRange.offset=0,this.geometry.attributes.position.updateRange.count=3*this.numPoints,this.geometry.attributes.normal.updateRange.count=3*this.numPoints,this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.normal.needsUpdate=!0),this.geometry.attributes.position.setDynamic(!0),this.geometry.attributes.normal.setDynamic(!0),this.geometry.setDrawRange(0,0),this.object=new ce.Mesh(this.geometry,n),this.object.drawMode=ce.TriangleStripDrawMode,this.object.frustumCulled=!1}return Object(H.a)(e,[{key:"clear",value:function(){this.numPoints=0,this.updateDrawRange()}},{key:"updateDrawRange",value:function(){this.geometry.setDrawRange(0,this.numPoints)}},{key:"updateAttribute",value:function(e,t,n){var a=this.geometry.attributes[e];a.updateRange.count>-1?(a.updateRange.count+=n,a.needsUpdate=!0):(a.updateRange.offset=t,a.updateRange.count=n,a.needsUpdate=!0)}},{key:"addPoint",value:function(e){var t=3*this.numPoints;this.vertices[t]=e.position[0],this.vertices[t+1]=e.position[1],this.vertices[t+2]=e.position[2],this.colors[t]=e.color[0],this.colors[t+1]=e.color[1],this.colors[t+2]=e.color[2],this.normals[t]=e.normal[0],this.normals[t+1]=e.normal[1],this.normals[t+2]=e.normal[2],this.lines[this.numPoints]=e.line,this.times[this.numPoints]=e.time,this.updateAttribute("position",t,3),this.updateAttribute("normal",t,3),this.numPoints++,this.updateDrawRange()}}]),e}()),ge=function(){function e(){Object(B.a)(this,e),this.material=new ce.MeshBasicMaterial({color:16777215,opacity:.5,transparent:!0}),this.object=new ce.Group,this.stripObject=new me(1e5,this.material),this.object.frustumCulled=!1,this.object.add(this.stripObject.object)}return Object(H.a)(e,null,[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),Object(H.a)(e,[{key:"clear",value:function(){this.stripObject.clear()}},{key:"setMaxXZ",value:function(e){this.material.uniforms.maxXZ.value=e}},{key:"setMaxY",value:function(e){this.material.uniforms.maxY.value=e}},{key:"setOffset",value:function(e){this.material.uniforms.offset.value=e}},{key:"setMinLine",value:function(e){this.material.uniforms.minLine.value=e}},{key:"setMaxLine",value:function(e){this.material.uniforms.maxLine.value=e}},{key:"setMinTime",value:function(e){this.material.uniforms.minTime.value=e}},{key:"setMaxTime",value:function(e){this.material.uniforms.maxTime.value=e}},{key:"addPoints",value:function(e){var t=this;e.forEach(function(e){t.stripObject.numPoints===t.stripObject.capacity&&(t.object.remove(t.stripObject.object),t.stripObject=new me(t.stripObject,t.material),t.object.add(t.stripObject.object)),t.stripObject.addPoint(e)})}}]),e}(),fe=function(){return new ce.ShaderMaterial({uniforms:{hitNormal:{value:new ce.Vector3},texture:{type:"t"},opacity:{value:.25}},vertexColors:ce.VertexColors,vertexShader:"\n      varying vec3 vNormal;\n      varying vec2 vUV;\n      void main() {\n        vNormal = normal;\n        vUV = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n      }\n    ",fragmentShader:"\n      uniform sampler2D texture;\n      uniform vec3 hitNormal;\n      uniform float opacity;\n\n      varying vec3 vNormal;\n      varying vec2 vUV;\n      void main() {\n        vec3 multColor = vec3(1,1,1);\n        if(dot(vNormal, hitNormal) > .99) {\n          multColor = vec3(.3,.7, .9);\n        }\n        gl_FragColor = vec4(texture2D(texture, vUV).xyz*multColor, opacity);\n      }\n    "})},ve=function(){function e(t,n,a,r,i){var o=this;Object(B.a)(this,e),this.callbacks={click:[],mouseover:[]},this.left=n,this.top=a,this.width=r,this.height=i,this.opacity=.25,this.scene=new ce.Scene;var s=this.height/this.width;this.camera=new ce.OrthographicCamera(-2.5,2.5,2.5*s,-2.5*s,-2.5,2.5),this.scene.add(this.camera),this.raycaster=new ce.Raycaster,this.material=new fe;var c=new ce.OBJLoader,l=new ce.TextureLoader;c.load("models/rhombicuboctahedron.obj",function(e){o.object=e,e.traverse(function(e){e instanceof ce.Mesh&&(e.material=o.material)}),o.scene.add(e),o.loadedModel=!0,o.loaded=o.loadedModel&&o.loadedTexture},function(e){},function(e){console.error(e)}),this.material.uniforms.texture.value=l.load("textures/viewCube.png",function(e){o.material.uniforms.texture.value=e,o.loadedTexture=!0,o.loaded=o.loadedModel&&o.loadedTexture},void 0,function(e){console.error(e)}),t.addEventListener("click",function(e){var t=e.offsetX-o.left,n=e.offsetY,a=t/o.width*2-1,r=-n/o.height*2+1;if(o.loaded&&a>-1&&a<1&&r>-1&&r<1){o.raycaster.set(new ce.Vector3(2.5*a,2.5*r,10).applyQuaternion(o.camera.quaternion),new ce.Vector3(0,0,-1).applyQuaternion(o.camera.quaternion));var i=o.raycaster.intersectObject(o.object,!0);if(i.length>0){var s=i[0];o.doCallback("click",s.face.normal)}}}),t.addEventListener("mousemove",function(e){var t=e.offsetX-o.left,n=e.offsetY,a=t/o.width*2-1,r=-n/o.height*2+1;if(o.loaded)if(a>-1&&a<1&&r>-1&&r<1){o.raycaster.set(new ce.Vector3(2.5*a,2.5*r,10).applyQuaternion(o.camera.quaternion),new ce.Vector3(0,0,-1).applyQuaternion(o.camera.quaternion));var i=o.raycaster.intersectObject(o.object,!0);if(i.length>0){var s=i[0];o.doCallback("mouseover",s.face.normal),o.material.uniforms.hitNormal.value.copy(s.face.normal),o.opacity=1}else o.material.uniforms.hitNormal.value.set(0,0,0),o.opacity=.25}else o.material.uniforms.hitNormal.value.set(0,0,0),o.opacity=.25})}return Object(H.a)(e,[{key:"doCallback",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.callbacks[e].forEach(function(e){return e.apply(void 0,n)})}},{key:"addEventListener",value:function(e,t){this.callbacks[e].push(t)}},{key:"removeEventListener",value:function(e,t){this.callbacks[e].splice(this.callbacks[e].indexOf(t),1)}},{key:"setOrientation",value:function(e){this.camera.quaternion.copy(e)}},{key:"setPosition",value:function(e,t){this.left=e,this.top=t}},{key:"setDimensions",value:function(e,t){this.width=e,this.height=t}},{key:"step",value:function(e){this.material.uniforms.opacity.value=.9*this.material.uniforms.opacity.value+.1*this.opacity,this.material.uniforms.opacity.value<1?this.material.transparent=!0:this.material.transparent=!1}},{key:"render",value:function(e){this.loaded&&(e.setViewport(this.left,this.top,this.width,this.height),e.setScissor(this.left,this.top,this.width,this.height),e.setScissorTest(!0),e.clearDepth(),e.render(this.scene,this.camera))}}]),e}(),be=function(){function e(t,n){Object(B.a)(this,e),this.width=n.width,this.height=n.height,this.spherical=new ce.Spherical(16,Math.PI/4,-Math.PI/2),this.spherical.makeSafe(),this.currentSpherical=new ce.Spherical(16,Math.PI/4,-Math.PI/2),this.currentSpherical.makeSafe(),this.Y=new ce.Vector3(0,1,0),this.X=new ce.Vector3(1,0,0),this.rotatedX=new ce.Vector3(1,0,0),this.focus=new ce.Vector3(0,0,0),this.parent=new ce.Object3D,this.parentPosition=new ce.Vector3,this.parentOrientation=new ce.Quaternion,this.worldPosition=new ce.Vector3(-16,0,0),this.worldOrientation=new ce.Quaternion,this.localOrientation=new ce.Quaternion,this.phiOrientation=new ce.Quaternion,this.thetaOrientation=new ce.Quaternion,this.localOrientation.setFromAxisAngle(new ce.Vector3(0,1,0),-Math.PI/2),this.worldOrientation.copy(this.localOrientation),this.startRotate=new ce.Vector2,this.dRotate=new ce.Vector2,this.transitionFilter=.1,this.transitionSphericalFilter=.4,this.rotateFilter=.4,this.rotateSphericalFilter=.8,this.lockedFilter=1,this.lockedSphericalFilter=1,this.filter=1,this.sphericalFilter=1,this.scene=t;var a=this.width/this.height,r=this.height/this.width;this.perspectiveCamera=new ce.PerspectiveCamera(60,a,.1,1e3),this.orthographicCamera=new ce.OrthographicCamera(-10,10,10*r,-10*r,-100,100),this.camera=this.perspectiveCamera,this.camera.position.x=-3,this.scene.add(this.camera),this.canvas=n}return Object(H.a)(e,[{key:"updateCanvasDimensions",value:function(e,t){this.width=e,this.height=t;var n=this.width/this.height,a=this.height/this.width;this.perspectiveCamera.aspect=n,this.perspectiveCamera.updateProjectionMatrix(),this.orthographicCamera.top=10*a,this.orthographicCamera.bottom=-10*a,this.orthographicCamera.updateProjectionMatrix()}},{key:"setPerspective",value:function(){this.camera=this.perspectiveCamera}},{key:"setOrthographic",value:function(){this.camera=this.orthographicCamera}},{key:"update",value:function(){var e=this.rotating?this.rotateFilter:this.transitionFilter,t=this.rotating?this.rotateFilter:this.transitionSphericalFilter;this.currentSpherical.radius=(1-t)*this.currentSpherical.radius+t*this.spherical.radius,this.currentSpherical.phi=(1-t)*this.currentSpherical.phi+t*this.spherical.phi,this.currentSpherical.theta-this.spherical.theta>Math.PI?this.currentSpherical.theta-=2*Math.PI:this.spherical.theta-this.currentSpherical.theta>Math.PI&&(this.currentSpherical.theta+=2*Math.PI),this.currentSpherical.theta=(1-t)*this.currentSpherical.theta+t*this.spherical.theta,this.currentSpherical.makeSafe(),this.worldPosition.setFromSpherical(this.currentSpherical),this.parent.getWorldQuaternion(this.parentOrientation),this.parent.getWorldPosition(this.parentPosition),this.worldPosition.applyQuaternion(this.parentOrientation),this.worldPosition.add(this.parentPosition),this.thetaOrientation.setFromAxisAngle(this.Y,this.currentSpherical.theta),this.phiOrientation.setFromAxisAngle(this.rotatedX.copy(this.X).applyQuaternion(this.thetaOrientation),-Math.PI/2+this.currentSpherical.phi),this.localOrientation.copy(this.thetaOrientation),this.localOrientation.premultiply(this.phiOrientation),this.worldOrientation.copy(this.localOrientation),this.worldOrientation.premultiply(this.parentOrientation),this.perspectiveCamera.quaternion.slerp(this.worldOrientation,e),this.perspectiveCamera.position.lerp(this.worldPosition,e),this.orthographicCamera.quaternion.slerp(this.worldOrientation,e),this.orthographicCamera.position.lerp(this.worldPosition,e)}},{key:"setParent",value:function(e){e&&this.parent!==e&&(this.parent=e,this.filter=this.transitionFilter,this.sphericalFilter=this.transitionSphericalFilter)}}]),e}(),Me="LONG",Se="SHORT",ye="V2",xe="V2_50",Oe=n(352),we="BASE",je="B_AXIS",Ee="A_AXIS",Te="Y_AXIS",Pe="TOOL",Ae="DENTAL_FIXTURE",ke="PERSPECTIVE",Ce="ORTHOGRAPHIC",Le="ABSOLUTE",Re="INCREMENTAL",Ie="ABSOLUTE_ARC",Ge="INCREMENTAL_ARC",De="INVERSE_TIME",Ne="UNITS_PER_MINUTE",_e="UNITS_PER_REVOLUTION",ze="FIVE_AXIS",Fe="TRIVIAL",Ze="XY",Ve="ZX",Be="YZ",He="UV",Ue="WU",Xe="VW",Ye="IN",We="MM",Ke="OFF",Je=0,qe=1,$e=2,Qe=3,et=4,tt=28.775,nt=1e-6,at=te(),rt=function(e){var t;if(e instanceof ce.Mesh)t=e;else for(var n=[e];n.length>0;)for(var a=n.shift(),r=0;r<a.children.length;r++){var i=a.children[r];if(i instanceof ce.Mesh)return i;n.push(i)}return t},it=function(e){var t={},n={},a=function(e,a,r,i,o,s,c,l,u){var d=i-e,h=o-a,p=s-r,m=c-e,g=l-a,f=u-r,v=h*f-p*g,b=p*m-d*f,M=d*g-h*m,S=Math.sqrt(v*v+b*b+M*M),y=1/S,x=y*v,O=y*b,w=y*M,j=-(e*x+a*O+r*w);x<.05&&x>-.05?x=0:Math.abs(1-x)<.05?x=1:Math.abs(-1-x)<.05&&(x=-1),O<.05&&O>-.05?O=0:Math.abs(1-O)<.05?O=1:Math.abs(-1-O)<.05&&(O=-1),w<.05&&w>-.05?w=0:Math.abs(1-w)<.05?w=1:Math.abs(-1-w)<.05&&(w=-1);var E=Math.round(x/.05),T=Math.round(O/.05),P=Math.round(w/.05),A=Math.round(j/.1),k="".concat(E,",").concat(T,",").concat(P,",").concat(A),C=.5*S;t[k]||(t[k]=0,n[k]={nx:x,ny:O,nz:w,dist:j}),t[k]+=C},r=e.geometry.getAttribute("position"),i=e.geometry.getAttribute("normal"),o=e.geometry.getIndex();if(null===o){for(var s=0;s<r.count;s+=9){a(r.array[s],r.array[s+1],r.array[s+2],r.array[s+3],r.array[s+4],r.array[s+5],r.array[s+6],r.array[s+7],r.array[s+8])}var c,l=Object.entries(t);l.sort(function(e,t){return t[1]-e[1]});for(var u=0;u<l.length;u++){for(var d=n[l[u][0]],h=d.nx,p=d.ny,m=d.nz,g=d.dist,f=!1,v=0;v<r.count&&!f;v+=3){r.array[v]*h+r.array[v+1]*p+r.array[v+2]*m+g>.05+nt&&(f=!0)}if(!f){c=n[l[u][0]];break}}return new ce.Plane(new ce.Vector3(c.nx,c.ny,c.nz),c.dist)}console.log("position",r),console.log("normal",i),console.log("indices",o)},ot=function(){function e(t,n){var a=this;Object(B.a)(this,e),this.wheelEventListener=function(e){var t=a.props,n=t.onCameraZoom,r=t.respondToCameraGestures;e.preventDefault(),e.stopPropagation(),r&&n&&n(e.deltaY)},this.keyDownListener=function(e){var t=a.props.onDeleteActiveSphere;"Backspace"===e.key&&t&&t()},this.getViewDirection=function(){return new ce.Vector3(0,0,-1).applyMatrix4(a.cameraTransitions.camera.matrixWorld).normalize()},this.getCameraRay=function(e,t){return a.mouse.x=e/a.width*2-1,a.mouse.y=-t/a.height*2+1,a.raycaster.setFromCamera(a.mouse,a.cameraTransitions.camera),a.raycaster.ray.clone()},this.mouseDownListener=function(e){var t=a.props,n=t.onCameraStartRotating,r=t.respondToModelGestures,i=t.respondToCameraGestures,o=t.onModelPointerDown,s=t.onSpherePointerDown,c=t.onMouseDown;if(e.preventDefault(),r){var l=!1;if(a.parts.model&&(a.mouse.x=e.offsetX/a.width*2-1,a.mouse.y=-e.offsetY/a.height*2+1,a.hits.length=0,a.raycaster.setFromCamera(a.mouse,a.cameraTransitions.camera),a.raycaster.intersectObject(a.parts.model.object,!0,a.hits),a.hits.length>0&&(a.hits[0].object===a.parts.model.object?(a.modelPointerDown=!0,o&&(o(a.hits[0],e,a),l=!0)):s&&(a.spherePointerDown=a.hits[0],s(a.hits[0],e,a),l=!0),l)))return}if(i&&n&&e.button===ce.MOUSE.LEFT)return a.startRotatingX=e.offsetX,a.startRotatingY=e.offsetY,void n();c&&c(e,a)},this.mouseUpListener=function(e){e.preventDefault();var t=a.props,n=t.rotating,r=t.machineRotating,i=t.respondToCameraGestures,o=t.respondToModelGestures,s=t.onCameraStopRotating,c=t.onModelPointerUp,l=t.onSpherePointerUp,u=t.onSphereExit,d=t.onMouseUp;if(!n&&!r&&o){var h=!1;if(a.parts.model)if(a.mouse.x=e.offsetX/a.width*2-1,a.mouse.y=-e.offsetY/a.height*2+1,a.hits.length=0,a.raycaster.setFromCamera(a.mouse,a.cameraTransitions.camera),a.raycaster.intersectObject(a.parts.model.object,!0,a.hits),a.hits.length>0){if(a.hits[0].object===a.parts.model.object?(a.spherePointerDown&&l&&(l(void 0,e,a),h=!0),a.spherePointerDown=!1,c&&a.modelPointerDown&&(c(a.hits[0],e,a),h=!0),a.modelPointerDown=!1):(a.modelPointerDown&&c&&(c(void 0,e,a),h=!0),a.modelPointerDown=!1,a.spherePointerDown&&(a.hits[0].object===a.spherePointerDown.object?(l(a.hits[0],e,a),h=!0):(l(void 0,e,a),h=!0)),a.spherePointerDown=!1),h)return}else if(a.modelPointerDown&&(c&&(c(void 0,e,a),h=!0),a.modelPointerDown=!1),a.spherePointerDown&&(l&&(l(void 0,e,a),h=!0),u&&(u(a.spherePointerDown,e,a),h=!0),a.spherePointerDown=!1),h)return}i?s&&e.button===ce.MOUSE.LEFT&&s():d&&d(e,a)},this.mouseMoveListener=function(e){var t=a.props,n=t.rotating,r=t.onCameraRotate,i=t.respondToModelGestures,o=t.respondToCameraGestures,s=t.onModelEnter,c=t.onModelExit,l=t.onModelHover,u=t.onModelDrag,d=t.onSphereHover,h=t.onSphereEnter,p=t.onSphereDrag,m=t.onSphereExit,g=t.onMouseMove,f=t.machineRotating;if(!n&&!f&&i){var v=!1;if(a.parts.model)if(a.mouse.x=e.offsetX/a.width*2-1,a.mouse.y=-e.offsetY/a.height*2+1,a.hits.length=0,a.raycaster.setFromCamera(a.mouse,a.cameraTransitions.camera),a.raycaster.intersectObject(a.parts.model.object,!0,a.hits),a.hits.length>0){if(a.hits[0].object===a.parts.model.object)a.lastHitSphere&&!a.spherePointerDown&&m&&(m(a.lastHitSphere,e,a),a.lastHitSphere=!1,v=!0),a.lastHitWasModel||a.spherePointerDown||(s&&(s(a.hits[0],e,a),v=!0),a.lastHitWasModel=a.hits[0]),a.modelPointerDown?u&&(u(a.hits[0],e,a),v=!0):a.spherePointerDown?p&&(a.spherePointerDown.point.x=a.hits[0].point.x,a.spherePointerDown.point.y=a.hits[0].point.y,a.spherePointerDown.point.z=a.hits[0].point.z,a.spherePointerDown.model=a.parts.model.object,p(a.spherePointerDown,e,a),v=!0):l&&(l(a.hits[0],e,a),v=!0);else if(a.lastHitWasModel&&!a.modelPointerDown&&c&&(c(a.lastHitWasModel,e,a),v=!0),a.lastHitWasModel=!1,(!a.lastHitSphere||a.lastHitSphere&&a.hits[0].object!==a.lastHitSphere.object&&!a.spherePointerDown)&&(a.lastHitSphere&&m&&(m(a.lastHitSphere,e,a),v=!0),h&&(h(a.hits[0],e,a),v=!0),a.lastHitSphere=a.hits[0]),a.lastHitSphere&&a.spherePointerDown&&a.lastHitSphere.object===a.spherePointerDown.object){if(p)for(var b=0;b<a.hits.length;b++)if(a.parts.model.object===a.hits[b].object){a.hits[0].point.x=a.hits[b].point.x,a.hits[0].point.y=a.hits[b].point.y,a.hits[0].point.z=a.hits[b].point.z,a.hits[0].model=a.parts.model.object,p(a.hits[0],e,a),v=!0;break}}else d&&(d(a.hits[0],e,a),v=!0);if(v)return}else if(a.modelPointerDown?u&&(u(void 0,e,a),v=!0):(a.lastHitWasModel&&c&&(c(a.lastHitWasModel,e,a),v=!0),a.lastHitWasModel=!1),a.lastHitSphere&&!a.spherePointerDown&&(m&&(m(a.lastHitSphere,e,a),v=!0),a.lastHitSphere=!1),v)return}o?r&&n&&(r(e.offsetX-a.startRotatingX,e.offsetY-a.startRotatingY),a.startRotatingX=e.offsetX,a.startRotatingY=e.offsetY):g&&g(e,a)},this.touchStartListener=function(e){var t=a.props,n=t.respondToCameraGestures,r=t.onCameraStartRotating,i=t.onCameraStopRotating,o=t.rotating;if(n)switch(e.touches.length){case 1:r&&(a.startRotateX=e.touches[0].pageX,a.startRotateY=e.touches[0].pageY,r());break;case 2:i&&o&&i();var s=e.touches[0].pageX-e.touches[1].pageX,c=e.touches[0].pageY-e.touches[1].pageY;a.touchZoomStart=Math.sqrt(s*s+c*c)}},this.touchEndListener=function(e){var t=a.props,n=t.respondToCameraGestures,r=t.onCameraStartRotating,i=t.onCameraStopRotating,o=t.rotating;if(n)switch(e.touches.length){case 0:i&&o&&i();break;case 1:r&&(a.startRotateX=e.touches[0].pageX,a.startRotateY=e.touches[0].pageY,r());break;case 2:i&&o&&i()}},this.touchMoveListener=function(e){e.preventDefault(),e.stopPropagation();var t=a.props,n=t.respondToCameraGestures,r=t.onCameraRotate,i=t.onCameraStopRotating,o=t.onCameraZoom,s=t.rotating;if(n)switch(e.touches.length){case 1:r&&s&&(r(e.touches[0].pageX-a.startRotateX,e.touches[0].pageY-a.startRotateY),a.startRotateX=e.touches[0].pageX,a.startRotateY=e.touches[0].pageY);break;case 2:if(i&&s&&i(),o){var c=e.touches[0].pageX-e.touches[1].pageX,l=e.touches[0].pageY-e.touches[1].pageY,u=Math.sqrt(c*c+l*l);o(-(u-a.touchZoomStart)),a.touchZoomStart=u}}},this.addGestureListeners=function(){a.canvas.addEventListener("wheel",a.wheelEventListener,!1),a.canvas.addEventListener("mousedown",a.mouseDownListener,!1),document.addEventListener("mouseup",a.mouseUpListener,!1),a.canvas.addEventListener("mousemove",a.mouseMoveListener),a.canvas.addEventListener("touchstart",a.touchStartListener),document.addEventListener("touchend",a.touchEndListener),a.canvas.addEventListener("touchmove",a.touchMoveListener),document.addEventListener("keydown",a.keyDownListener)},this.showDentalFixture=function(){if(a.parts.dentalFixture)a.parts.dentalFixture.object.visible=!0;else if(a.parts.bAxis){var e={id:"dentalFixture",path:"models/dental_fixture.obj",material:a.toolMaterial};a.objLoader.load(e.path,function(t){t.traverse(function(t){t instanceof ce.Mesh&&(t.material=e.material)}),e.object=t,a.parts.dentalFixture=e;var n=rt(a.parts.dentalFixture.object);n.geometry.computeBoundingBox(),a.parts.dentalFixture.boundingBox=n.geometry.boundingBox.clone(),a.parts.bAxis.object.add(a.parts.dentalFixture.object)},function(e){},function(e){console.error(e)})}},this.hideDentalFixture=function(){a.parts.dentalFixture&&(a.parts.dentalFixture.object.visible=!1)},this.exportModelToSTL=function(){if(a.parts.model){var e,t=a.parts.model.object;if(a.parts.model.object instanceof ce.Mesh?e=a.parts.model.object:a.parts.model.object.traverse(function(t){t instanceof ce.Mesh&&(e=t)}),e)return t.updateMatrix(),Oe.a(e.geometry,t.matrix,!0)}},this.showModel=function(){a.parts.model&&(a.parts.model.object.visible=!0)},this.hideModel=function(){a.parts.model&&(a.parts.model.object.visible=!1)},this.computePlaneWithLargestArea=function(){var e=a.props.onModelComputePlaneWithLargestArea;e&&e(it(rt(a.parts.model.object)),a)},this.loadSTLModel=function(e){var t=a.props.smoothModelTransition,n=a.stlLoader.parse(e),r=new ce.Mesh(n,a.modelMaterial);if(r.scale.x=1/25.4,r.scale.y=1/25.4,r.scale.z=1/25.4,a.parts.model)if(a.parts.smoothModel){var i=a.parts.smoothModel.object;a.leavingModel=i,setTimeout(function(){a.parts.bAxis.object.remove(i)},1e3)}else a.parts.bAxis.object.remove(a.parts.model.object);else a.parts.model={id:"model",material:a.modelMaterial};a.parts.model.object=r,r.traverse(function(e){e instanceof ce.Mesh&&(e.material=a.parts.model.material)}),t?(a.parts.smoothModel={id:"smoothModel",object:new ce.Object3D},a.parts.smoothModel.object.position.y=a.modelTransitionStartY,a.parts.bAxis.object.add(a.parts.smoothModel.object),a.parts.smoothModel.object.add(a.parts.model.object)):a.parts.bAxis.object.add(a.parts.model.object)},this.loadObjModel=function(e){var t=a.props.smoothModelTransition,n=a.objLoader.parse(e);if(n.scale.x=1/25.4,n.scale.y=1/25.4,n.scale.z=1/25.4,a.parts.model)if(a.parts.smoothModel){var r=a.parts.smoothModel.object;a.leavingModel=r,setTimeout(function(){a.parts.bAxis.object.remove(r)},1e3)}else a.parts.bAxis.object.remove(a.parts.model.object);else a.parts.model={id:"model",material:a.modelMaterial};a.parts.model.object=n,n.traverse(function(e){e instanceof ce.Mesh&&(e.material=a.parts.model.material)}),t?(a.parts.smoothModel={id:"smoothModel",object:new ce.Object3D},a.parts.smoothModel.object.position.y=a.modelTransitionStartY,a.parts.bAxis.object.add(a.parts.smoothModel.object),a.parts.smoothModel.object.add(a.parts.model.object)):a.parts.bAxis.object.add(a.parts.model.object)},this.parentCameraToTool=function(){a.ready&&a.cameraTransitions.setParent(a.parts.tool.object)},this.parentCameraToDentalFixture=function(){a.ready&&a.cameraTransitions.setParent(a.parts.dentalFixtureFocusPoint.object)},this.parentCameraToB=function(){a.ready&&a.cameraTransitions.setParent(a.parts.bAxis.object)},this.parentCameraToA=function(){a.ready&&a.cameraTransitions.setParent(a.parts.aAxis.object)},this.parentCameraToY=function(){a.ready&&a.cameraTransitions.setParent(a.parts.yAxis.object)},this.parentCameraToBase=function(){a.ready&&a.cameraTransitions.setParent(a.parts.base.object)},this.update=function(e){a.props=e;var t=a.props,n=t.cameraParent,r=t.cameraMode,i=t.showModel,o=t.showDentalFixture,s=t.rotating,c=t.phi,l=t.theta,u=t.radius,d=t.orthographicZoom,h=t.showGhostSphere,p=t.ghostSpherePosition,m=t.ghostSphereOpacity,g=t.points,f=t.activePoint,v=t.highlightedPoint,b=t.hideTool,M=t.highlightModel,S=t.modelRX,y=t.modelRY,x=t.modelRZ,O=t.modelTX,w=t.modelTY,j=t.modelTZ,E=t.machine;if(a.ready)switch(E){case xe:a.parts.v250ToolHolder.object.visible=!0,a.parts.toolHolder.object.visible=!1,a.parts.toolHolderShort.object.visible=!1,a.parts.v250Spindle.object.visible=!0,a.parts.v210Spindle.object.visible=!1;break;case ye:a.parts.v250ToolHolder.object.visible=!1,a.parts.v250Spindle.object.visible=!1,a.parts.v210Spindle.object.visible=!0}a.parts.model&&(rt(a.parts.model.object).material=M?a.highlightedModelMaterial:a.modelMaterial,"undefined"!==typeof O&&(a.parts.model.object.position.x=O),"undefined"!==typeof w&&(a.parts.model.object.position.y=w),"undefined"!==typeof j&&(a.parts.model.object.position.z=j),"undefined"!==typeof S&&(a.parts.model.object.rotation.x=S),"undefined"!==typeof y&&(a.parts.model.object.rotation.y=y),"undefined"!==typeof x&&(a.parts.model.object.rotation.z=x),a.parts.model.object.updateMatrix(),a.parts.model.object.updateMatrixWorld()),a.parts.tool&&(a.parts.tool.object.visible=!b),a.ghostSphere.visible=h,p&&(a.ghostSphere.position.x=p.x,a.ghostSphere.position.y=p.y,a.ghostSphere.position.z=p.z);var T=m||0;if(a.ghostSphere.material.opacity=T,a.ghostSphere.material.transparent=!(T>=1),g&&a.parts.model){if(a.spheres.length<g.length)for(var P=g.length-a.spheres.length,A=0;A<P;A++){var k=new ce.Mesh(a.sphereGeometry,a.sphereMaterial);k.userData.index=a.spheres.length,a.parts.model.object.add(k),a.spheres.push(k)}for(var C=0;C<a.spheres.length;C++)a.spheres[C].parent!==a.parts.model.object&&a.parts.model.object.add(a.spheres[C]),a.spheres[C].material=C===f?C===v?a.highlightedActiveSphereMaterial:a.activeSphereMaterial:C===v?a.highlightedSphereMaterial:a.sphereMaterial,C<g.length?(a.spheres[C].visible=!0,a.spheres[C].position.x=g[C][0],a.spheres[C].position.y=g[C][1],a.spheres[C].position.z=g[C][2]):a.spheres[C].visible=!1}switch(a.cameraTransitions.rotating=s,a.cameraTransitions.spherical.phi=c,a.cameraTransitions.spherical.theta=l,a.cameraTransitions.spherical.radius=u,a.cameraTransitions.orthographicCamera.zoom=d,a.cameraTransitions.orthographicCamera.updateProjectionMatrix(),n){case we:a.parentCameraToBase();break;case Te:a.parentCameraToY();break;case je:a.parentCameraToB();break;case Ee:a.parentCameraToA();break;case Pe:a.parentCameraToTool();break;case Ae:a.parentCameraToDentalFixture()}switch(r){case ke:a.cameraTransitions.setPerspective();break;case Ce:a.cameraTransitions.setOrthographic()}i?a.showModel():a.hideModel(),o?a.showDentalFixture():a.hideDentalFixture()},this.updateDimensions=function(e,t){a.width=e,a.height=t,a.renderer.setSize(a.width,a.height),a.cameraTransitions.updateCanvasDimensions(e,t),a.viewCube.setPosition(e-150,a.height-100)},this.updateMachine=function(){var e=a.props,t=e.smoothJointTransitions,n=e.smoothModelTransition;if(a.ready){if(a.checkLimits(),a.cameraTransitions.update(),t){for(var r=0;r<a.smoothJoints.length;r++){if(4===r){var i=((a.props.joints[r]-a.smoothJoints[r])%360+360)%360;i>180&&(i-=360),a.smoothJoints[r]=a.props.joints[r]-i}a.smoothJoints[r]=a.smoothJoints[r]*a.smoothJointsFilter+a.props.joints[r]*(1-a.smoothJointsFilter)}a.parts.bAxis.object.rotation.y=a.smoothJoints[4]*Math.PI/180,a.parts.aAxis.object.rotation.x=a.smoothJoints[3]*Math.PI/180,a.parts.yAxis.object.position.y=-a.smoothJoints[1],a.parts.zAxis.object.position.z=6.26+a.smoothJoints[2],a.parts.xAxis.object.position.x=a.smoothJoints[0]}else a.parts.bAxis.object.rotation.y=a.props.joints[4]*Math.PI/180,a.parts.aAxis.object.rotation.x=a.props.joints[3]*Math.PI/180,a.parts.yAxis.object.position.y=-a.props.joints[1],a.parts.zAxis.object.position.z=6.26+a.props.joints[2],a.parts.xAxis.object.position.x=a.props.joints[0];a.parts.model&&n&&(a.parts.smoothModel.object.position.y=a.parts.smoothModel.object.position.y*a.modelTransitionFilter),a.leavingModel&&n&&(a.leavingModel.position.y=a.leavingModel.position.y*a.modelTransitionFilter+a.modelTransitionStartY*(1-a.modelTransitionFilter)),a.parts.tool&&(a.parts.tool.object.position.z=-a.props.toolLength,a.parts.tool.object.scale.x=a.props.toolDiameter,a.parts.tool.object.scale.y=a.props.toolDiameter,a.parts.toolHolder.object.rotation.z=a.props.spindleAngle,a.parts.toolHolderShort.object.rotation.z=a.props.spindleAngle,a.props.machine===ye&&(a.props.toolHolder===Se?(a.parts.toolHolderShort.object.visible=!0,a.parts.toolHolder.object.visible=!1):a.props.toolHolder===Me?(a.parts.toolHolderShort.object.visible=!1,a.parts.toolHolder.object.visible=!0):(a.parts.toolHolderShort.object.visible=!1,a.parts.toolHolder.object.visible=!1)))}},this.render=function(){var e=a.props.showViewCube;a.renderer.clear(),a.renderer.setViewport(0,0,a.width,a.height),a.renderer.setScissorTest(!1),a.renderer.render(a.scene,a.cameraTransitions.camera),e&&(a.viewCube.setOrientation(a.cameraTransitions.localOrientation),a.viewCube.render(a.renderer))},this.checkLimits=function(){for(var e={0:a.parts.xAxis,1:a.parts.yAxis,2:a.props.machine===ye?a.parts.v210Spindle:a.parts.v250Spindle,3:a.parts.aAxis,4:a.parts.bAxis},t=0;t<a.props.joints.length;t++)a.props.joints[t]<a.props.limits.min[t]?(e[t].material&&(e[t].material.color=new ce.Color(1,0,0),e[t].material.emissive=new ce.Color(.3,0,0)),a.totalTime=0):a.props.joints[t]>a.props.limits.max[t]?(e[t].material&&(e[t].material.color=new ce.Color(1,0,0),e[t].material.emissive=new ce.Color(.3,0,0)),a.totalTime=0):e[t].material&&(e[t].material.color=new ce.Color(1,1,1),e[t].material.emissive=new ce.Color(0,0,0))},this.createLights=function(){var e=new ce.DirectionalLight(16777215,.15);e.position.set(-30,30,30),e.lookAt(0,0,0);var t=new ce.DirectionalLight(16777215,.15);t.position.set(-30,30,-30),t.lookAt(0,0,0);var n=new ce.DirectionalLight(16777215,.07);n.position.set(30,30,30),n.lookAt(0,0,0);var r=new ce.DirectionalLight(16777215,.07);r.position.set(30,30,-30),r.lookAt(0,0,0);var i=new ce.DirectionalLight(16777215,.07);i.position.set(30,-30,-30),i.lookAt(0,0,0),a.scene.add(i),a.scene.add(e),a.scene.add(t),a.scene.add(n),a.scene.add(r)},this.findTime=function(e){if(e>=a.times[a.times.length-1])return a.times.length-1;for(var t=0,n=a.times.length-1,r=Math.floor(a.times.length/2);!(a.times[r]<e&&a.times[r+1]>=e);)a.times[r]>=e?n=r:t=r,r=Math.floor(.5*(t+n));return r},this.step=function(e){a.viewCube.step(e)},this.props=n,this.canvas=t,this.startTime=J()(),this.smoothJoints=Object(W.a)(n.joints),this.smoothJointsFilter=.6,this.modelTransitionFilter=.85,this.modelTransitionStartY=10,this.raycaster=new ce.Raycaster,this.hits=[],this.mouse=new ce.Vector2,this.backplot=pe.getInstance(),this.backplotStrip=ge.getInstance(),this.scene=new ce.Scene,this.scene.background=new ce.Color(13421772),this.renderer=new ce.WebGLRenderer({canvas:t}),this.renderer.autoClear=!1,this.renderer.setPixelRatio(window.devicePixelRatio),this.width=window.innerWidth,this.height=window.innerHeight,this.viewCube=new ve(t,this.width-150,this.height-100,100,100);this.viewCube.addEventListener("click",function(e){var t=a.props.onCameraSetDirection;t&&t(e.x,e.y,e.z);var n=Math.max(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)),r=e.x/n,i=e.y/n,o=e.z/n;at.event("ViewCube","clicked face ("+(r<nt&&r>-nt?0:r)+", "+(i<nt&&i>-nt?0:i)+", "+(o<nt&&o>-nt?0:o)+")").send()}),this.renderer.setSize(this.width,this.height),this.renderer.setClearColor(16777215,1),this.cameraTransitions=new be(this.scene,t),this.createLights();var r=new ce.OBJLoader;this.stlLoader=new ce.STLLoader,this.objLoader=r;var i=new ce.TextureLoader;this.textureLoader=i;var o="textures/cube/",s=[o+"px.jpg",o+"nx.jpg",o+"py.jpg",o+"ny.jpg",o+"pz.jpg",o+"nz.jpg"];this.envMap=(new ce.CubeTextureLoader).load(s),this.envMap.format=ce.RGBFormat,this.envMap.mapping=ce.CubeReflectionMapping;var c=new ce.MeshStandardMaterial({color:4539717,metalness:1,roughness:.5,envMap:this.envMap,envMapIntensity:1.5});this.toolMaterial=new ce.MeshStandardMaterial({color:16777215,metalness:1,roughness:.3,envMap:this.envMap});var l=this.toolMaterial,u=new ce.MeshStandardMaterial({color:1118481,metalness:.5,roughness:.6,envMap:this.envMap,emissive:14483456}),d=new ce.MeshStandardMaterial({color:16777215,metalness:.2,roughness:.6,envMap:this.envMap,emissive:4473929});this.sphereGeometry=new ce.SphereGeometry(.5,32,32),this.ghostSphereGeometry=new ce.SphereGeometry(.01968,32,32),this.ghostMaterial=new ce.MeshStandardMaterial({color:2616319,metalness:.7,roughness:.7,envMap:this.envMap,envMapIntensity:3,opacity:.5,transparent:!0}),this.sphereMaterial=new ce.MeshStandardMaterial({color:2616319,metalness:.7,roughness:.7,envMap:this.envMap,envMapIntensity:3}),this.highlightedSphereMaterial=new ce.MeshStandardMaterial({color:2616319,metalness:.7,roughness:.7,envMap:this.envMap,envMapIntensity:4}),this.activeSphereMaterial=new ce.MeshStandardMaterial({color:13434641,metalness:.7,roughness:.7,envMap:this.envMap,envMapIntensity:3}),this.highlightedActiveSphereMaterial=new ce.MeshStandardMaterial({color:13434641,metalness:.7,roughness:.7,envMap:this.envMap,envMapIntensity:4}),this.ghostSphere=new ce.Mesh(this.ghostSphereGeometry,this.ghostMaterial),this.ghostSphere.visible=this.props.showGhostSphere,this.scene.add(this.ghostSphere),this.spheres=[],this.modelMaterial=new ce.MeshStandardMaterial({color:16777215,metalness:.5,roughness:.6,envMap:this.envMap,emissive:2236962}),this.highlightedModelMaterial=new ce.MeshStandardMaterial({color:2616319,metalness:.5,roughness:.6,envMap:this.envMap,envMapIntensity:1.5,opacity:.75,transparent:!0,emissive:738892});var h=[{id:"aAxis",path:"models/v2/aAxis.obj",map:"textures/v2/aAxisMap.png"},{id:"bAxis",path:"models/v2/bAxis.obj",map:"textures/v2/bAxisMap.png"},{id:"xAxis",path:"models/v2/xAxis.obj",map:"textures/v2/xAxisMap.png"},{id:"yAxis",path:"models/v2/yAxis.obj",map:"textures/v2/yAxisMap.png"},{id:"v250Spindle",path:"models/v2/zAxisV250.obj",map:"textures/v2/zAxisV250Map.png"},{id:"v210Spindle",path:"models/v2/zAxis.obj",map:"textures/v2/zAxisMap.png"},{id:"base",path:"models/v2/base.obj",map:"textures/v2/baseMap.png"},{id:"baseButtons",path:"models/v2/base_buttons.obj",material:l},{id:"estopRing",path:"models/v2/estop_ring.obj",material:u},{id:"startStopRing",path:"models/v2/start_stop_ring.obj",material:d},{id:"v250ToolHolder",path:"models/v2/v250ToolHolder.obj",map:"textures/v2/v250ToolHolderAO.png",shiny:!0},{id:"toolHolder",path:"models/long_tool_holder.obj",material:l},{id:"toolHolderShort",path:"models/short_tool_holder.obj",material:l},{id:"toolColletHolder",path:"models/long_tool_collet_holder.obj",material:c},{id:"toolColletHolderShort",path:"models/short_tool_collet_holder.obj",material:c}];this.props.showDentalFixture&&h.push({id:"dentalFixture",path:"models/dental_fixture.obj",material:this.toolMaterial}),this.parts={},h.forEach(function(e){r.load(e.path,function(t){e.material&&t.traverse(function(t){t instanceof ce.Mesh&&(t.material=e.material)}),e.object=t,at.timing("Viewer3D","Loaded Model "+e.id,Math.round(J()()-a.startTime)).send()},function(e){},function(e){console.error(e)}),e.map?i.load(e.map,function(t){e.shiny?e.material=new ce.MeshStandardMaterial({map:t,metalness:1,roughness:.3,envMap:a.envMap}):e.material=new ce.MeshStandardMaterial({map:t,metalness:1,roughness:.4,envMapIntensity:1.25,envMap:a.envMap}),e.object&&e.object.traverse(function(t){t instanceof ce.Mesh&&(t.material=e.material)}),at.timing("Viewer3D","Loaded Texture "+e.id,Math.round(J()()-a.startTime)).send()},void 0,function(e){console.error(e)}):e.object&&e.object.traverse(function(t){t instanceof ce.Mesh&&(t.material=e.material)})});this.time=0,function e(){var t=!0;if(h.forEach(function(e){e.object&&e.material||(t=!1)}),t){h.forEach(function(e){a.parts[e.id]=e});var n=new ce.CylinderGeometry(.5,.5,6,32),r=new ce.SphereGeometry(.5,32,32),i=new ce.Mesh(n,l),o=new ce.Mesh(r,l),s=new ce.Group;if(i.position.z=3,i.rotation.x=Math.PI/2,o.position.z=.03125,s.add(i),a.parts.tool={object:s,material:l},a.parts.zAxis={object:new ce.Group},a.parts.zAxis.object.add(a.parts.v250Spindle.object),a.parts.zAxis.object.add(a.parts.v210Spindle.object),a.props.machine===xe?a.parts.v210Spindle.object.visible=!1:(a.parts.v250Spindle.object.visible=!1,a.parts.v250ToolHolder.object.visible=!1),a.parts.zAxis.object.position.z=3,a.parts.aAxis.object.rotation.x=0,a.parts.xAxis.object.add(a.parts.zAxis.object),a.parts.yAxis.object.add(a.parts.aAxis.object),a.parts.zAxis.object.add(a.parts.tool.object),a.parts.zAxis.object.add(a.parts.toolHolder.object),a.parts.zAxis.object.add(a.parts.v250ToolHolder.object),a.parts.toolHolder.object.add(a.parts.toolColletHolder.object),a.parts.toolHolder.object.visible=!1,a.parts.zAxis.object.add(a.parts.toolHolderShort.object),a.parts.toolHolderShort.object.add(a.parts.toolColletHolderShort.object),a.parts.aAxis.object.add(a.parts.bAxis.object),a.parts.bAxis.object.add(a.backplot.object),a.parts.bAxis.object.add(a.backplotStrip.object),a.parts.base.object.add(a.parts.yAxis.object),a.parts.base.object.add(a.parts.xAxis.object),a.parts.base.object.add(a.parts.baseButtons.object),a.parts.base.object.add(a.parts.estopRing.object),a.parts.base.object.add(a.parts.startStopRing.object),a.props.showDentalFixture){a.parts.bAxis.object.add(a.parts.dentalFixture.object);var c=rt(a.parts.dentalFixture.object);c.geometry.computeBoundingBox(),a.parts.dentalFixture.boundingBox=c.geometry.boundingBox.clone(),a.parts.dentalFixtureFocusPoint={id:"dentalFixtureFocusPoint",object:new ce.Object3D},a.parts.dentalFixtureFocusPoint.object.position.y=(3+tt)/25.4,a.parts.bAxis.object.add(a.parts.dentalFixtureFocusPoint.object)}a.scene.add(a.parts.base.object),a.props.showDentalFixture?a.cameraTransitions.setParent(a.parts.dentalFixtureFocusPoint.object):a.cameraTransitions.setParent(a.parts.yAxis.object),a.ready=!0,at.timing("Viewer3D","Ready",Math.round(J()()-a.startTime)).send()}else window.setTimeout(e,500)}(),this.addGestureListeners()}return Object(H.a)(e,null,[{key:"getInstance",value:function(){return e.instance}},{key:"createInstance",value:function(t,n){return e.instance=new e(t,n),e.instance}}]),e}(),st=n(27),ct=function(e){function t(){var e,n;Object(B.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(U.a)(this,(e=Object(X.a)(t)).call.apply(e,[this].concat(r)))).updateDimensions=function(){var e=n.props,t=e.hideTitleBar,a=e.onUpdateDimensions,r=window.innerWidth,i=window.innerHeight-(t?0:64);n.viewer.updateDimensions(r,i),a&&a(r,i)},n}return Object(Y.a)(t,e),Object(H.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.hideTitleBar,a=t.onUpdateDimensions;window.addEventListener("resize",this.updateDimensions),this.viewer=ot.createInstance(this.canvas,this.props);var r=window.innerWidth,i=window.innerHeight-(n?0:64);this.viewer.updateDimensions(r,i),a&&a(r,i);!function t(){e.animationRequestID=window.requestAnimationFrame(t),e.viewer.step(.01667),e.viewer.updateMachine(),e.viewer.render()}()}},{key:"componentWillUnmount",value:function(){this.animationRequestID&&window.cancelAnimationFrame(this.animationRequestID),this.viewer=null,window.removeEventListener("resize",this.updateDimensions)}},{key:"componentDidUpdate",value:function(){this.viewer.update(this.props)}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.hideTitleBar;return g.a.createElement("div",{className:a?"":n.container},g.a.createElement("canvas",{ref:function(t){return e.canvas=t}}))}}]),t}(m.Component),lt=Object(st.withStyles)({container:{paddingTop:64,overflow:"hidden"}})(ct),ut=n(1),dt=n(4),ht=n.n(dt),pt={G4:!0,G5:!0,"G5.1":!0,"G5.2":!0,"G5.3":!0,G7:!0,G8:!0,G10:!0,"G17.1":!0,"G18.1":!0,"G19.1":!0,G28:!0,"G28.1":!0,G30:!0,"G30.1":!0,G33:!0,"G33.1":!0,"G38.2":!0,"G38.3":!0,"G38.4":!0,"G38.5":!0,G41:!0,G42:!0,"G41.1":!0,"G42.1":!0,"G43.1":!0,"G43.2":!0,G54:!0,G55:!0,G56:!0,G57:!0,G58:!0,G59:!0,"G59.1":!0,"G59.2":!0,"G59.3":!0,G61:!0,"G61.1":!0,G64:!0,G73:!0,G76:!0,G80:!0,G81:!0,G82:!0,G83:!0,G84:!0,G85:!0,G86:!0,G87:!0,G88:!0,G89:!0,G92:!0,"G92.1":!0,"G92.2":!0,"G92.3":!0,G95:!0,G96:!0,G97:!0,G98:!0,G99:!0,M0:!0,M1:!0,M2:!0,M30:!0,M7:!0,M8:!0,M9:!0,M19:!0,M48:!0,M49:!0,M50:!0,M51:!0,M52:!0,M53:!0,M61:!0,M62:!0,M63:!0,M64:!0,M65:!0,M66:!0,M67:!0,M68:!0,M70:!0,M71:!0,M72:!0,M73:!0},mt={G0:"Move at machine's maximum speed.",G1:"Move at the current feed rate.",G2:"Make a clockwise arc move.",G3:"Make a counter-clockwise arc move.",G4:"Dwell in place.",G5:"Make a cubic spline move.","G5.1":"Make a quadratic spline move.","G5.2":"Make a NURBS move.","G5.3":"Make a NURBS move.",G80:"Cancel canned cycle.",G17:"Select XY plane.",G18:"Select XZ plane.",G19:"Select YZ plane.",G40:"Turn off cutter compensation.",G43:"Enable tool length offset.",G49:"Disable tool length offset.",G60:"Enable 5-axis inverse kinematics.","G60.1":"Disable 5-axis inverse Kinematics.",G90:"Set absolute distance mode.",G91:"Set incremental distance mode.","G90.1":"Set absolute arc distance mode.","G91.1":"Set incremental arc distance mode.",G93:"Set inverse time feed rate mode.",G94:"Set units per minute feed rate mode.",G7:"Enable lathe diameter mode.",G8:"Enable lathe radius mode.",G10:"Set tool table and coordinate system.","G17.1":"Select UV plane.","G18.1":"Select WU plane.","G19.1":"Select VW plane.",G28:"Go to predefined absolute position stored in parameters 5161-5166.","G28.1":"Store current position in parameters 5161-5166",G30:"Go to predefined absolute position stored in parameters 5181-5186.","G30.1":"Store current position in parameters 5181-5186.",G33:"Spindle synchronized motion.","G33.1":"Rigid tapping.","G38.2":"Probe toward workpiece, stop on contact, signal error if failure.","G38.3":"Probe toward workpiece, stop on contact.","G38.4":"Probe away from workpiece, stop on loss of contact, signal error if failure.","G38.5":"Probe away from workpiece, stop on loss of contact.",G41:"Enable cutter compensation left of programmed path.",G42:"Enable cutter compensation right of programmed path.","G41.1":"Enable cutter compensation left of programmed path with tool diameter.","G42.1":"Enable cutter compensation right of programmed path with tool diameter.","G43.1":"Dynamic tool length offset.","G43.2":"Apply additional tool length offset.",G54:"Select coordinate system 1 (the default).",G55:"Select coordinate system 2.",G56:"Select coordinate system 3.",G57:"Select coordinate system 4.",G58:"Select coordinate system 5.",G59:"Select coordinate system 6.","G59.1":"Select coordinate system 7.","G59.2":"Select coordinate system 8.","G59.3":"Select coordinate system 9.",G61:"Enable exact path mode.","G61.1":"Enable exact path mode.",G64:"Set path blending parameters.",G73:"Drilling cycle with chip breaking.",G76:"Threading cycle.",G81:"Drilling cycle.",G82:"Drilling cycle, dwell.",G83:"Peck drilling cycle.",G84:"Right-hand tapping cycle.",G85:"Boring cycle, feed out.",G86:"Boring cycle, spindle stop, rapid move out.",G87:"Back boring cycle.",G88:"Boring cycle, spindle stop, manual out.",G89:"Boring cycle, dwell, feed out.",G92:"Offsets the coordinate system by setting the current point to the axis numbers you want and stores the offsets in parameters 5211-5219.","G92.1":"Reset G92 offsets to zero and sets parameters 5211-5219 to zero.","G92.2":"Reset G92 offsets to zero.","G92.3":"Set the G92 offsets to the values saved in parameters 5211-5219.",G95:"Set units per revolution feed rate mode.",G96:"Spindle control mode, constant surface speed.",G97:"Spindle control mode, RPM mode.",G98:"Retract to the position that axis was in just before this series of one or more contiguous canned cycles was started.",G99:"Retract to the position specified by the R word of the canned cycle.",M3:"Turn on spindle going clockwise.",M4:"Turn on spindle going counter-clockwise.",M5:"Turn off spindle.",M6:"Change tool.",M0:"Pause program.",M1:"Pause program if optional stop switch is on.",M2:"End the program. Pressing cycle start will start the program at the beginning of the file.",M30:"End the program. Pressing cycle start will start the program at the beginning of the file.",M7:"Turn mist coolant on.",M8:"Turn flood coolant on.",M9:"Turn both mist and flood coolant off.",M19:"Orient spindle.",M48:"Enable speed and feed rate override controls.",M49:"Disable spindle speed and feed rate override controls.",M50:"Feed override control.",M51:"Spindle speed override control.",M52:"Use adaptive feed.",M53:"Enable feed stop switch.",M61:"Change the current tool number while in MDI or Manual mode.",M62:"Turn on digital output synchronized with motion.",M63:"Turn on digital output synchronized with motion.",M64:"Turn on digital output immediately.",M65:"Turn on digital output immediately.",M66:"Wait on digital input.",M67:"Set an analog output synchronized with motion.",M68:"Set an analog output immediately.",M70:"Save modal state.",M71:"Invalidate saved modal state.",M72:"Restore modal state.",M73:"Save modal state with a subroutine and restore state on subroutine endsub or any return path."},gt={G0:R.machineState.motion.rapid,G1:R.machineState.motion.linear,G2:R.machineState.motion.arcCW,G3:R.machineState.motion.arcCCW,G17:R.machineState.planeSelect.setXY,G18:R.machineState.planeSelect.setZX,G19:R.machineState.planeSelect.setYZ,G40:R.machineState.cutterCompensation.off,G43:R.machineState.tool.setToolLengthOffset,G49:R.machineState.tool.clearToolLengthOffset,G60:R.machineState.kinematicsMode.setFiveAxis,"G60.1":R.machineState.kinematicsMode.setTrivial,G90:R.machineState.distanceMode.setAbsolute,G91:R.machineState.distanceMode.setIncremental,"G90.1":R.machineState.distanceMode.setAbsoluteArc,"G91.1":R.machineState.distanceMode.setIncrementalArc,G93:R.machineState.feedRateMode.setInverseTime,G94:R.machineState.feedRateMode.setUnitsPerMinute,M3:R.machineState.spindleControl.cw,M4:R.machineState.spindleControl.ccw,M5:R.machineState.spindleControl.off,M6:R.machineState.tool.change},ft={G20:R.machineState.units.setIn,G21:R.machineState.units.setMm},vt={T:R.machineState.tool.set,S:R.machineState.spindleSpeed.set,F:R.machineState.feedRate.set},bt={G53:!0},Mt=function(e){return mt[e]},St=R.machineState.motion.setPosition,yt="error",xt="warning",Ot="info",wt="UNIMPLEMENTED",jt="UNRECOGNIZED",Et="MINIMUM_LIMIT",Tt="MAXIMUM_LIMIT",Pt="MULTIPLE_COMMANDS_IN_MODAL_GROUP",At="MULTIPLE_COMMANDS_WITH_POSITIONAL_ARGS",kt="ZERO_FEED_RATE",Ct="SET_TOOL_LENGTH_OFFSET",Lt="TOOL_LENGTH_OFFSET_COMMAND_DIFFERS_FROM_LOADED_TOOL";function Rt(e,t){return{message:"Can't run multiple commands in the same modal group on the same line. Codes "+e.slice(0,e.length-1).join(", ")+" and "+e[e.length-1]+" are in modal group "+t+".",codes:e,group:t,type:Pt,severity:yt}}function It(e,t){return{message:e+" axis exceeded maximum limit by "+t.toFixed(4)+".",axis:e,amount:t,type:Tt,severity:yt}}function Gt(){return{message:"Feed rate must be greater than 0 for linear or arc moves.",severity:yt,type:kt}}function Dt(e,t){return Object(M.a)({},e,{line:t})}var Nt,_t=function(e){var t=e.get(3),n=e.get(4),a=t*Math.PI/180,r=n*Math.PI/180,i=Math.cos(a),o=Math.sin(a),s=Math.cos(r),c=Math.sin(r);return ht.a.Map({X:-c*i,Y:o,Z:s*i})},zt=function(e,t){return Ft(e.set(2,e.get(2)),t)},Ft=function(e,t){var n=e.get(3),a=e.get(4),r=n*Math.PI/180,i=a*Math.PI/180,o=Math.cos(r),s=Math.sin(r),c=Math.cos(i),l=Math.sin(i),u=t,d=e.get(0),h=e.get(1),p=e.get(2),m=d*c+h*l*s-(p-u)*l*o,g=h*o+(p-u)*s,f=d*l-h*c*s+(p-u)*c*o;return ht.a.Map({X:m,Y:g,Z:f,A:n,B:a})},Zt=function(e,t){var n=e.get("A"),a=e.get("B"),r=n*Math.PI/180,i=a*Math.PI/180,o=Math.cos(r),s=Math.sin(r),c=Math.cos(i),l=Math.sin(i),u=t,d=e.get("X"),h=e.get("Y"),p=e.get("Z"),m=d*c+p*l,g=d*l*s+h*o-p*c*s,f=-d*l*o+h*s+p*c*o+u;return ht.a.List([m,g,f,n,a])},Vt={inverseKinematics:function(e,t){var n=e.get("kinematicsMode"),a=0;t||(a=e.get("tool").get("toolLengthOffset").get("Z"));var r=e.get("motion").get("position");return n===ze?Zt(r,a):ht.a.List([r.get("X"),r.get("Y"),r.get("Z")+a,r.get("A"),r.get("B")])},forwardKinematics:function(e,t){var n=e.get("kinematicsMode"),a=t?0:e.get("tool").get("toolLengthOffset").get("Z"),r=e.get("joints");return n===ze?Ft(r,a):ht.a.Map({X:r.get(0),Y:r.get(1),Z:r.get(2)-a,A:r.get(3),B:r.get(4)})}},Bt={extents:{max:[2.55,2.55,.1,135,9999],min:[-2,-2.5,-3.45,-25,-9999]},velocities:[1,1,1,37.5,37.5],accelerations:[10,10,10,300,300]},Ht=["X","Y","Z","A","B"],Ut=function(e){for(var t,n,a=[],r=0;r<e.size;r++){var i=e.get(r);i<Bt.extents.min[r]?a.push((t=Ht[r],n=Math.abs(i-Bt.extents.min[r]),{message:t+" axis exceeded minimum limit by "+n.toFixed(4)+".",axis:t,amount:n,type:Et,severity:yt})):i>Bt.extents.max[r]&&a.push(It(Ht[r],Math.abs(i-Bt.extents.max[r])))}return a.length>0?a:[]},Xt=_t,Yt=zt,Wt=Ft,Kt=Zt,Jt=Vt,qt=Bt,$t=Ht,Qt=Ut,en=(Nt={},Object(ut.a)(Nt,ye,d),Object(ut.a)(Nt,xe,h),Nt),tn=Object(b.b)(function(e,t){var n=e.get("machineState"),a=n.get("tool").get("loaded")-1,r=0,i=.125,o="NONE";if(a>=0){var s=n.get("tool").get("table").get(a);r=6.26+s.get("Z"),i=2*s.get("R"),o=s.get("holder")}var c=n.get("tool").get("toolLengthOffset").get("Z"),l=e.get("interpreter").get("currentTime"),u=0;"OFF"!==n.get("spindleControl")&&(u=2*l*Math.PI*n.get("spindleSpeed"),"CCW"===n.get("spindleControl")&&(u*=-1));var d=n.get("joints").toJS(),h=en[n.get("machine")].limits.extents;return{machine:n.get("machine"),responseToCameraGestures:!0,toolLength:r,toolDiameter:i,toolHolder:o,spindleAngle:u,toolOffsetZ:c,joints:d,limits:h,axes:"XYZAB",currentTime:e.get("interpreter").get("currentTime"),currentLine:e.get("interpreter").get("currentLine"),hideTitleBar:!e.get("ui").get("titleBar").get("visible"),cameraParent:e.get("viewer3D").get("cameraParent"),showModel:e.get("viewer3D").get("showModel"),dentalAlignerMode:e.get("viewer3D").get("dentalAlignerMode"),cameraMode:e.get("viewer3D").get("cameraMode"),rotating:e.get("viewer3D").get("rotating"),radius:e.get("viewer3D").get("radius"),orthographicZoom:e.get("viewer3D").get("orthographicZoom"),phi:e.get("viewer3D").get("phi"),theta:e.get("viewer3D").get("theta"),showViewCube:!0,smoothJointTransitions:!1,smoothModelTransition:!0,respondToCameraGestures:!0}},function(e,t){return{onUpdateDimensions:function(t,n){return e(V.viewer3D.setDimensions(t,n))},onCameraZoom:function(t){return e(V.viewer3D.cameraZoom(t))},onCameraStartRotating:function(){return e(V.viewer3D.cameraStartRotating())},onCameraStopRotating:function(){return e(V.viewer3D.cameraStopRotating())},onCameraRotate:function(t,n){return e(V.viewer3D.cameraRotate(t,n))},onCameraSetDirection:function(t,n,a){return e(V.viewer3D.cameraSetDirection(t,n,a))}}})(lt),nn=n(159),an=n.n(nn),rn=n(324),on=n.n(rn),sn=n(127),cn=n.n(sn),ln=n(74),un=n.n(ln),dn=function(e){function t(){var e,n;Object(B.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(U.a)(this,(e=Object(X.a)(t)).call.apply(e,[this].concat(r)))).handleFileSelect=function(e){var t=n.props,a=t.onFileSelect,r=t.onRead;1===e.target.files.length&&(a&&a(e.target.files[0]),r&&n.readFile(e.target.files[0]),n.fileInput.value="")},n.handleFileOpen=function(e){n.fileInput.click()},n.readFile=function(e){var t=n.props,a=t.onRead,r=t.onFinished,i=t.onError,o=t.chunkSize,s=t.stopReading,c=t.binary,l=e.size,u=o||65536,d=0,h=null,p=function(e){null===e.target.error?(c?(a(e.target.result,Math.min(u,e.target.result.byteLength),l),d+=e.target.result.byteLength):(a(e.target.result,Math.min(u,e.target.result.length),l),d+=e.target.result.length),d>=l?r&&r():s&&s()?r&&r():h(d,u)):i&&i(e.target.error)};(h=function(t,n){var a=new FileReader,r=e.slice(t,n+t);a.onload=p,c?a.readAsArrayBuffer(r):a.readAsText(r)})(d,u)},n}return Object(Y.a)(t,e),Object(H.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.children,r=t.color,i=t.component,o=t.disabled,s=t.disableFocusRipple,c=t.disableRipple,l=t.fullWidth,u=t.href,d=t.mini,h=t.size,p=t.variant,m=t.buttonClasses,f=t.accept;return g.a.createElement("span",null,g.a.createElement(un.a,{onClick:this.handleFileOpen,classes:m,component:i,color:r,disabled:o,disableFocusRipple:s,disableRipple:c,fullWidth:l,href:u,mini:d,size:h,variant:p},a),g.a.createElement("input",{onChange:this.handleFileSelect,ref:function(t){return e.fileInput=t},type:"file",accept:f,className:n.fileSelect}))}}]),t}(m.Component),hn=Object(st.withStyles)(function(e){return{fileSelect:{display:"none"}}})(dn),pn=n(158),mn=n.n(pn),gn=te(),fn=function(e){function t(){var e,n;Object(B.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(U.a)(this,(e=Object(X.a)(t)).call.apply(e,[this].concat(r)))).handleFileSelect=function(e){var t=n.props,a=t.onLoading,r=t.onSetFileName;n.fileSize=e.size,n.fileName=e.name,n.read=0,n.lines=[],n.buffer="",r&&r(e.name),gn.event("GCodeLoader","GCode File Size","GCode File Size",n.fileSize).send(),n.startTime=J()(),a&&a()},n.handleFinished=function(){var e=n.props.onFinished;n.stopReadingFile=!1,e&&e(),gn.timing("GCodeLoader","loaded gcode file",Math.round(J()()-n.startTime)).send()},n.handleRead=function(e,t){var a,r=n.props,i=r.onProgress,o=r.onLines,s=r.onError;n.read+=t;var c=Math.min(n.read/n.fileSize*100,100),l=(n.buffer+e).split("\n");n.buffer=l.pop(),(a=n.lines).push.apply(a,Object(W.a)(l.map(function(e){return e.replace(/\r/,"")}))),s&&n.lines.length>2e6&&(n.stopReadingFile=!0,o(n.lines),s(new Error("GCode program exceeds 2 million lines. Program truncated to "+n.lines.length+" lines."))),i&&i(c),o&&(n.read===t?o(n.lines.slice(),!0):n.read>=n.fileSize&&(o(n.lines),gn.event("GCodeLoader","Lines In GCode Program","Lines In GCode Program",n.lines.length).send()))},n.stopReading=function(){return n.stopReadingFile},n}return Object(Y.a)(t,e),Object(H.a)(t,[{key:"render",value:function(){return g.a.createElement(hn,{onFileSelect:this.handleFileSelect,onFinished:this.handleFinished,onRead:this.handleRead,stopReading:this.stopReading,chunkSize:65536,size:"small",accept:".ngc, .nc",color:"inherit"},g.a.createElement(mn.a,null)," GCode")}}]),t}(m.Component),vn=Object(b.b)(function(e,t){return{machineState:e.get("machineState")}},function(e,t){return{onSetFileName:function(t){return e(I.interpreter.setFileName(t))},onLoading:function(){return e(I.interpreter.startLoading())},onFinished:function(){return e(I.interpreter.endLoading())},onProgress:function(t){return e(I.interpreter.setLoadingProgress(t))},onLines:function(t,n){return e(I.interpreter.setLines(t,n))}}})(fn),bn=function(e){function t(){var e,n;Object(B.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(U.a)(this,(e=Object(X.a)(t)).call.apply(e,[this].concat(r)))).handleFileSelect=function(e){var t=n.props,a=t.binary,r=t.onLoading;n.fileSize=e.size,n.fileName=e.name,a?(n.read=0,n.buffer=""):(n.data=void 0,n.buffer=void 0,n.offset=0),r&&r()},n.handleFinished=function(){var e=n.props.onLoadModel;n.stopReadingFile=!1,e(n.buffer,n.fileName)},n.handleRead=function(e,t,a){var r=n.props,i=r.onProgress,o=r.onError;n.data||(n.buffer=new ArrayBuffer(a),n.data=new Uint8Array(n.buffer),n.offset=0);try{n.data.set(new Uint8Array(e),n.offset)}catch(c){o&&o(new Error("Error reading data chunk: "+c.message+", "+n.offset))}n.offset+=t;var s=Math.min(n.offset/n.fileSize*100,100);i&&i(s)},n.stopReading=function(){return n.stopReadingFile},n}return Object(Y.a)(t,e),Object(H.a)(t,[{key:"render",value:function(){var e=this.props,t=e.iconOnly,n=e.labelOnly,a=e.variant,r=e.size,i=e.color,o=e.label,s=void 0===o?"Model":o;return g.a.createElement(hn,{onFileSelect:this.handleFileSelect,onFinished:this.handleFinished,onRead:this.handleRead,stopReading:this.stopReading,chunkSize:65536,binary:!0,size:r,color:i,accept:".obj,.stl",variant:a},n?null:g.a.createElement(mn.a,null)," ",t?null:s)}}]),t}(m.Component),Mn=te(),Sn=Object(b.b)(function(e,t){return{}},function(e,t){return{onLoadModel:function(t,n){var a=ot.getInstance();if(n.endsWith(".obj"))if(a){var r=J()(),i=new TextDecoder("utf-8");a.loadObjModel(i.decode(t));var o=J()();Mn.timing("ModelLoader","load obj",Math.round(o-r)).send(),Mn.event("ModelLoader","OBJ File Size","OBJ File Size",t.byteLength).send()}else console.error("viewer not loaded yet");else if(n.endsWith(".stl"))if(a){var s=J()();a.loadSTLModel(t);var c=J()();Mn.timing("ModelLoader","load stl",Math.round(c-s)).send(),Mn.event("ModelLoader","STL File Size","STL File Size",t.byteLength).send()}else console.error("viewer not loaded yet");e(V.viewer3D.loadModel()),e(V.viewer3D.showModel())}}})(bn),yn=n(322),xn=n.n(yn),On=n(63),wn=n.n(On);var jn=function(e){var t=e.value,n=e.thickness;if(e.loading){var a=t.toFixed(2)+"%";return g.a.createElement(wn.a,{title:a},g.a.createElement(xn.a,{variant:"determinate",color:"inherit",value:t,thickness:n}))}return null},En=Object(b.b)(function(e,t){var n=0,a=3.6,r=!1;return e.get("interpreter").get("loading")?(n=e.get("interpreter").get("loadingProgress"),a=1,r=!0):e.get("interpreter").get("processing")&&(n=e.get("interpreter").get("processingProgress"),a=3.6,r=!0),{value:n,thickness:a,loading:r}},function(e,t){return{}})(jn),Tn=n(323),Pn=n.n(Tn),An=te(),kn=Object(st.withStyles)(function(e){return{appBar:{zIndex:e.zIndex.drawer+1,backgroundColor:"#333333"},title:{flex:1,color:"white",textDecoration:"none"},logo:{height:32,marginRight:10}}})(function(e){var t=e.classes,n=e.hideButtons,a=e.title;return g.a.createElement(an.a,{className:t.appBar},g.a.createElement(on.a,null,g.a.createElement("a",{href:"https://www.pocketnc.com",target:"_blank",rel:"noopener noreferrer"},g.a.createElement("img",{src:Pn.a,alt:"Pocket NC",className:t.logo,onClick:function(){return An.event("TitleBar","clicked link to pocketnc.com").send()}})),g.a.createElement(cn.a,{className:t.title},g.a.createElement("a",{href:"https://www.pocketnc.com",className:t.title,target:"_blank",rel:"noopener noreferrer",onClick:function(){return An.event("TitleBar","clicked link to pocketnc.com").send()}},a||"Pocket NC Simulator")),g.a.createElement(En,null),n?null:g.a.createElement(g.a.Fragment,null,g.a.createElement(vn,{onError:function(e){return console.error(e)}}),g.a.createElement(Sn,{size:"small",color:"inherit",onError:function(e){return console.error(e)}}))))}),Cn=n(332),Ln=n.n(Cn),Rn=n(333),In=n.n(Rn),Gn=n(205),Dn=n.n(Gn),Nn=n(12),_n=n.n(Nn),zn=n(325),Fn=(n(672),n(673),n(674),n(129)),Zn=n.n(Fn),Vn=n(326),Bn=n.n(Vn),Hn=(n(675),te()),Un=function(){var e=document.getElementsByClassName("ace_tooltip");if(e.length>0)for(var t=0;t<e.length;t++)document.body.appendChild(e[t])},Xn=function(e){function t(){var e,n;Object(B.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(U.a)(this,(e=Object(X.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(e){var t=n.props.onSetCurrentLine,a=e.editor,r=a.getCursorPosition();a.getSelection().isEmpty()&&t(r.row)},n.handleChange=function(e){Hn.event("Editor",e.action,e.action,e.lines.length).send()},n.handleDownload=function(){var e=n.props.fileName,t=n.editor.getValue(),a=document.createElement("a");a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),a.setAttribute("download",e),a.click()},n.handleFileNameChange=function(e){(0,n.props.onSetFileName)(e.target.value)},n.handleRef=function(e){n.container=e},n}return Object(Y.a)(t,e),Object(H.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.gcode,a=t.annotations;this.editor=zn.edit(this.container),this.editor.getSession().setMode("ace/mode/gcode"),this.editor.setTheme("ace/theme/chrome"),this.editor.$blockScrolling=1/0,this.editor.setShowPrintMargin(!1),this.editor.setOptions({readOnly:!0}),this.editor.session.on("changeScrollLeft",function(t){0!==t&&e.editor.session.setScrollLeft(0)});var r=this.editor.getSelection(),i=this.editor.getSession();r.on("changeCursor",function(e,t,n){}),r.on("changeSelection",function(e,t,n){});var o=i.getDocument();o.setValue(""),o.insertFullLines(0,n),i.setAnnotations(a.toJS()),o.on("change",this.handleChange),this.editor.on("guttermousemove",Un),this.editor.on("click",this.handleClick)}},{key:"componentWillUnmount",value:function(){this.editor=null}},{key:"shouldComponentUpdate",value:function(e){var t=this.props,n=t.gcode,a=t.annotations,r=t.currentLine,i=t.currentTab,o=t.running,s=t.fileName,c=e.gcode,l=e.annotations,u=e.currentLine,d=e.currentTab,h=e.running;return s!==e.fileName||h!==o||d!==i||c!==n||r!==u||a!==l}},{key:"componentDidUpdate",value:function(e){var t=e.gcode,n=e.annotations,a=e.running,r=this.props,i=r.gcode,o=r.annotations,s=r.currentLine,c=r.running,l=r.setLines,u=this.editor.getSession(),d=u.getDocument();if(!a&&c&&i===t){for(var h=1;!u.getLine(u.getLength()-h);)h++;l(u.getLines(0,u.getLength()-h))}c?(this.editor.container.style.backgroundColor="#f3f3f3",this.editor.setOptions({readOnly:!0})):(this.editor.container.style.backgroundColor="#ffffff",this.editor.setOptions({readOnly:!1})),t!==i&&(d.off("change",this.handleChange),d.setValue(""),d.insertFullLines(0,i),d.on("change",this.handleChange)),n!==o&&u.setAnnotations(o.toJS()),this.editor.gotoLine(s+1,1/0),this.editor.resize()}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.fileName,a=e.running;return g.a.createElement("div",{className:t.mainDiv},g.a.createElement("div",{ref:this.handleRef,className:t.container}),g.a.createElement("div",{className:t.gcodeTitleBar},g.a.createElement(Zn.a,{disabled:a,value:n,onChange:this.handleFileNameChange,style:{width:"calc(100% - 70px)"}})," ",g.a.createElement(un.a,{size:"small",onClick:this.handleDownload},g.a.createElement(Bn.a,null))))}}]),t}(m.Component),Yn=Object(st.withStyles)(function(e){return{mainDiv:{width:"100%",height:"100%"},container:{width:"100%",height:"calc(100% - 39px)"},gcodeTitleBar:{width:"100%",fontSize:"15px",borderTop:"1px solid #dddddd",color:"gray",paddingLeft:"5px"}}})(Xn),Wn=n(130),Kn=n(160),Jn=n.n(Kn),qn=n(55),$n=n.n(qn),Qn=n(57),ea=n.n(Qn),ta=n(58),na=n.n(ta),aa=n(329),ra=n.n(aa),ia=n(330),oa=n.n(ia),sa=n(331),ca=n.n(sa),la=n(131),ua=n(104),da=n.n(ua);function ha(){var e=Object(Wn.a)(["\n  && {\n    color: #ff0000;\n    width: 15px;\n  }"]);return ha=function(){return e},e}function pa(){var e=Object(Wn.a)(["\n  && {\n    color: #d4ba62;\n    width: 15px;\n  }"]);return pa=function(){return e},e}function ma(){var e=Object(Wn.a)(["\n  && {\n    color: #3f51b5;\n    width: 15px;\n  }"]);return ma=function(){return e},e}function ga(){var e=Object(Wn.a)(["\n  && {\n    padding-left: 8px\n  }\n"]);return ga=function(){return e},e}var fa=la.a.div(ga()),va=Object(la.a)(ra.a)(ma()),ba=Object(la.a)(oa.a)(pa()),Ma=Object(la.a)(ca.a)(ha()),Sa=function(e){function t(){var e,n;Object(B.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(U.a)(this,(e=Object(X.a)(t)).call.apply(e,[this].concat(r)))).handleSetToolLengthOffset=function(e,t){return function(a){var r=n.props.onSetTool;if("Enter"===a.key||"blur"===a.type){var i=parseFloat(a.target.value);if(isNaN(i))a.target.value=t;else a.target.value=i,r({P:e,Z:i});a.target.blur(),a.preventDefault()}}},n.handleSetToolDiameter=function(e,t){return function(a){var r=n.props.onSetTool;if("Enter"===a.key||"blur"===a.type){var i=parseFloat(a.target.value);if(isNaN(i))a.target.value=t;else a.target.value=i,r({P:e,R:.5*i});a.target.blur(),a.preventDefault()}}},n.handleSetToolHolder=function(e){return function(t){(0,n.props.onSetTool)({P:e,holder:t.target.value})}},n}return Object(Y.a)(t,e),Object(H.a)(t,[{key:"render",value:function(){var e=this.props,t=e.numLines,n=e.approximateTime,a=e.maxLimitMessage,r=e.minLimitMessage,i=e.unimplementedMessages,o=e.nonSummarizedWarnings,s=e.nonSummarizedErrors,c=e.toolLengthOffsetMessages,l=e.running,u=e.classes,d=e.toolTable,h=[];for(var p in a){var m=a[p],f=p+" positive limit exceeded by maximum of "+m.amount.toFixed(4)+" on line "+(m.line+1)+".";"Z"===p&&(f+=" Try shortening your tool by at least "+m.amount.toFixed(4)+" inches."),h.push(g.a.createElement($n.a,{key:p+"maxlimit",className:u.li},g.a.createElement(ea.a,{className:u.liIcon},g.a.createElement(Ma,null)),g.a.createElement(na.a,null,f)))}for(var v in r){var b=r[v],M=v+" negative limit exceeded by maximum of "+b.amount.toFixed(4)+" on line "+(b.line+1)+".";"Z"===v&&(M+=" Try extending your tool by at least "+b.amount.toFixed(4)+" inches."),h.push(g.a.createElement($n.a,{key:v+"minlimit",className:u.li},g.a.createElement(ea.a,{className:u.liIcon},g.a.createElement(Ma,null)),g.a.createElement(na.a,null,M)))}var S=Math.floor(n/60/60),y=Math.floor(n/60)%60,x=Math.floor(n)%60,O=[];S>0&&O.push(S+" hour"+(1!==S?"s":"")),y>0&&O.push(y+" minute"+(1!==y?"s":"")),x>0&&O.push(x+" second"+(1!==x?"s":""));var w=null;if(i.count()>0){var j={};i.forEach(function(e){j[e.code]=e.description});var E=[];for(var T in j)E.push(g.a.createElement($n.a,{key:T,className:u.li},g.a.createElement(ea.a,{className:u.liIcon},g.a.createElement(ba,null)),g.a.createElement(na.a,null,T,"'s intended usage: ",j[T])));w=[g.a.createElement($n.a,{key:"unimplementedText",className:u.li},g.a.createElement(ea.a,{className:u.liIcon},g.a.createElement(ba,null)),g.a.createElement(na.a,null,"Found ",E.length," code",1!==E.length?"s":""," on ",i.count()," line",1!==i.count()?"s":""," that ",1!==E.length?"aren't":"isn't"," implemented in the simulator. A real Pocket NC's behavior may differ from what is shown. Check the intended usage of each code below.")),g.a.createElement(fa,{key:"unimplementedCodes"},g.a.createElement(Jn.a,{dense:!0,disablePadding:!0,className:u.nested},E))]}var P=o.map(function(e,t){return g.a.createElement($n.a,{key:e.message+t,className:u.li},g.a.createElement(ea.a,{className:u.liIcon},g.a.createElement(ba,null)),g.a.createElement(na.a,null,"undefined"!==typeof e.line?"Warning on line "+(e.line+1)+": ":"",e.message))}),A=s.map(function(e,t){return g.a.createElement($n.a,{key:e.message+t,className:u.li},g.a.createElement(ea.a,{className:u.liIcon},g.a.createElement(Ma,null)),g.a.createElement(na.a,null,"undefined"!==typeof e.line?"Error on line "+(e.line+1)+": ":"",e.message))}),k=[];if(c.count()>0){var C={};for(var L in c.forEach(function(e){C[e.toolNumber]={toolLengthOffset:e.toolLengthOffset,toolDiameter:e.toolDiameter,toolHolder:e.toolHolder}}),C)k.push(g.a.createElement($n.a,{key:"usingTool"+L,className:u.li},g.a.createElement(ea.a,{className:u.liIcon},g.a.createElement(va,null)),g.a.createElement(na.a,null,"Using tool ",L))),k.push(g.a.createElement($n.a,{key:"toolLengthOffset"+L,className:u.li},g.a.createElement(ea.a,{className:u.liIcon},g.a.createElement(va,null)),g.a.createElement(na.a,null,"Tool ",L," Z offset ",g.a.createElement(Zn.a,{disabled:l,onBlur:this.handleSetToolLengthOffset(L,C[L].toolLengthOffset),onKeyPress:this.handleSetToolLengthOffset(L,C[L].toolLengthOffset),defaultValue:C[L].toolLengthOffset.toFixed(4)}),"."))),k.push(g.a.createElement($n.a,{key:"toolDiameter"+L,className:u.li},g.a.createElement(ea.a,{className:u.liIcon},g.a.createElement(va,null)),g.a.createElement(na.a,null,"Tool ",L," Diameter ",g.a.createElement(Zn.a,{disabled:l,onBlur:this.handleSetToolDiameter(L,C[L].toolDiameter),onKeyPress:this.handleSetToolDiameter(L,C[L].toolDiameter),defaultValue:C[L].toolDiameter.toFixed(4)}),"."))),k.push(g.a.createElement($n.a,{key:"toolHolder"+L,className:u.li},g.a.createElement(ea.a,{className:u.liIcon},g.a.createElement(va,null)),g.a.createElement(na.a,null,"Tool ",L," Holder",g.a.createElement(da.a,{disabled:l,checked:d.get(parseInt(L)-1).get("holder")===Se,value:Se,name:"toolHolder"+L,"aria-label":"Short Tool Holder",onChange:this.handleSetToolHolder(L),color:"primary"})," Short",g.a.createElement(da.a,{disabled:l,checked:d.get(parseInt(L)-1).get("holder")===Me,value:Me,name:"toolHolder"+L,"aria-label":"Long Tool Holder",onChange:this.handleSetToolHolder(L),color:"primary"})," Long")))}return g.a.createElement("div",{className:u.container},g.a.createElement(Jn.a,{dense:!0},[],h,A,P,w,g.a.createElement($n.a,{className:u.li},g.a.createElement(ea.a,{className:u.liIcon},g.a.createElement(va,{fontSize:"inherit",color:"primary"})),g.a.createElement(na.a,null,t," lines")),g.a.createElement($n.a,{className:u.li},g.a.createElement(ea.a,{className:u.liIcon},g.a.createElement(va,{fontSize:"inherit",color:"primary"})),g.a.createElement(na.a,null,"Approximately ",O.join(" ")," to run.")),k))}}]),t}(m.Component),ya=Object(st.withStyles)(function(e){return{container:{height:"100%",overflow:"scroll",marginLeft:10},nested:{paddingLeft:e.spacing.unit},li:{paddingLeft:"8px",paddingRight:"8px"},liIcon:{marginRight:0}}})(Sa),xa=n(84),Oa=function(e){return e.get("interpreter").get("messages")},wa=Object(xa.createSelector)([Oa],function(e){return e.filter(function(e){return"undefined"!==typeof e.line}).map(function(e){return{row:e.line,column:0,text:e.message,type:e.severity}})}),ja=Object(xa.createSelector)([Oa],function(e){var t=e.filter(function(e){return e.type===Tt}),n={};t.forEach(function(e){n[e.axis]||(n[e.axis]=[]),n[e.axis].push(e)});var a={};for(var r in n)a[r]=n[r].reduce(function(e,t){return t.amount>e.amount?t:e},{amount:0});return a}),Ea=Object(xa.createSelector)([Oa],function(e){var t=e.filter(function(e){return e.type===Et}),n={};t.forEach(function(e){n[e.axis]||(n[e.axis]=[]),n[e.axis].push(e)});var a={};for(var r in n)a[r]=n[r].reduce(function(e,t){return t.amount>e.amount?t:e},{amount:0});return a}),Ta=Object(xa.createSelector)([Oa],function(e){return e.filter(function(e){return e.type===wt})}),Pa=Object(xa.createSelector)([Oa],function(e){return e.filter(function(e){return e.severity===yt&&-1===[Tt,Et].indexOf(e.type)})}),Aa=Object(xa.createSelector)([Oa],function(e){return e.filter(function(e){return e.severity===xt&&-1===[wt].indexOf(e.type)})}),ka=Object(xa.createSelector)([Oa],function(e){return e.filter(function(e){return e.type===Ct})}),Ca=p,La=function(e){return e.get("alignerState")},Ra=function(e){return e.get("interpreter")},Ia=function(e){return e.get("machineState")},Ga=function(e){return e.get("interpreter").get("lines")},Da=function(e){return e.get("interpreter").get("linesPerIndex")},Na=function(e){return e.get("interpreter").get("times").last()},_a=function(e){var t=e.get("tool"),n=t.get("table"),a=t.get("loaded");return a>0?n.get(a-1):ht.a.Map({Z:-6,R:0})},za=Object(b.b)(function(e,t){return{numLines:e.get("interpreter").get("lines").length,approximateTime:e.get("interpreter").get("times").last(),maxLimitMessage:Ca.maxLimitMessage(e),minLimitMessage:Ca.minLimitMessage(e),unimplementedMessages:Ca.unimplementedMessages(e),nonSummarizedWarnings:Ca.nonSummarizedWarnings(e),nonSummarizedErrors:Ca.nonSummarizedErrors(e),toolLengthOffsetMessages:Ca.setToolLengthOffsetMessages(e),running:e.get("interpreter").get("running"),toolTable:e.get("machineState").get("tool").get("table")}},function(e,t){return{onSetTool:function(t){return e(V.machineState.tool.table.setTool(t))}}})(ya),Fa=te();var Za=Object(st.withStyles)(function(e){return{summary:{padding:"10px"},hidden:{display:"none"},toolbar:e.mixins.toolbar,tabNoTitleBar:{height:"100%",width:"100%"},tab:{height:"calc(100% - 112px)",width:"100%"},paper:{}}})(function(e){var t=e.classes,n=e.width,a=e.visible,r=e.currentLine,i=e.annotations,o=e.onScroll,s=e.onTabChange,c=e.onSetCurrentLine,l=e.currentTab,u=e.running,d=e.gcode,h=e.setLines,p=e.hideTitleBar,m=e.fileName,f=e.onSetFileName;return g.a.createElement(Ln.a,{variant:"persistent",open:a,PaperProps:{style:{width:n,height:"100vh"}},classes:{paper:t.paper}},p?null:g.a.createElement("div",{className:t.toolbar}),g.a.createElement(an.a,{position:"static",color:"default"},g.a.createElement(In.a,{value:l,onChange:s,indicatorColor:"primary",textColor:"primary",fullWidth:!0},g.a.createElement(Dn.a,{label:"GCode",onClick:function(){return Fa.event("GCodePane","clicked gcode tab").send()}}),g.a.createElement(Dn.a,{label:"Summary",onClick:function(){return Fa.event("GCodePane","clicked summary tab").send()}}))),g.a.createElement("div",{className:_n()(p?t.tabNoTitleBar:t.tab,Object(ut.a)({},t.hidden,0!==l))},g.a.createElement(Yn,{gcode:d,annotations:i,currentLine:r,onScroll:o,currentTab:l,running:u,setLines:h,fileName:m,onSetCurrentLine:c,onSetFileName:f})),g.a.createElement("div",{className:_n()(t.tab,Object(ut.a)({},t.hidden,1!==l))},g.a.createElement(za,null)))}),Va=Object(b.b)(function(e,t){var n=e.get("ui").get("gcodePane"),a=e.get("interpreter").get("lines");return{width:n.get("width"),visible:n.get("visible"),annotations:Ca.annotations(e),currentLine:e.get("interpreter").get("currentLine"),gcode:a,currentTab:n.get("currentTab"),running:e.get("interpreter").get("running"),hideTitleBar:!e.get("ui").get("titleBar").get("visible"),fileName:e.get("interpreter").get("fileName")}},function(e,t){return{onScroll:function(t){return e(V.ui.gcodePane.scroll(t))},onTabChange:function(t,n){return e(V.ui.gcodePane.setTab(n))},setLines:function(t){return e(V.interpreter.setLines(t))},onSetCurrentLine:function(t){return e(V.interpreter.setCurrentLine(t))},onSetFileName:function(t){return e(V.interpreter.setFileName(t))}}})(Za),Ba=function(e){function t(){var e,n;Object(B.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(U.a)(this,(e=Object(X.a)(t)).call.apply(e,[this].concat(r)))).handleMouseUp=function(e){n.dragging=!1},n.handleMouseDown=function(e){e.preventDefault(),n.dragging=!0},n.handleMouseMove=function(e){var t=n.props.onDrag;n.dragging&&t&&(e.preventDefault(),t(Math.min(Math.max(e.pageX,0),window.innerWidth)))},n}return Object(Y.a)(t,e),Object(H.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.left,a=e.width;return g.a.createElement("div",{className:t.divider,style:{left:n-.5*a,width:a},onMouseDown:this.handleMouseDown})}}]),t}(m.Component),Ha=Object(st.withStyles)(function(e){return{divider:{position:"absolute",height:"100%",zIndex:e.zIndex.drawer+1,cursor:"col-resize"}}})(Ba),Ua=Object(b.b)(function(e,t){return{left:e.get("ui").get("gcodePane").get("width")}},function(e,t){return{onDrag:function(t){return e(N.ui.gcodePane.setWidth(t))}}})(Ha),Xa=n(203),Ya=n.n(Xa),Wa=n(76),Ka=n.n(Wa),Ja=n(206),qa=n(334),$a=n.n(qa),Qa=n(340),er=n.n(Qa),tr=n(335),nr=n.n(tr),ar=n(336),rr=n.n(ar),ir=n(339),or=n.n(ir),sr=n(337),cr=n.n(sr),lr=n(338),ur=n.n(lr),dr=n(341),hr=n.n(dr),pr=function(e,t,n){return n=n||"0",(e+="").length>=t?e:new Array(t-e.length+1).join(n)+e},mr=te(),gr=function(e){function t(){var e,n;Object(B.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(U.a)(this,(e=Object(X.a)(t)).call.apply(e,[this].concat(r)))).handleMouseMove=function(e){var t=n.props,a=t.visible,r=t.onShow,i=t.onHide,o=t.visibleTimeout;e.buttons&&!n.clickedInOverlay||(!a&&r&&r(),i&&!n.over&&(n.timeout&&window.clearTimeout(n.timeout),n.timeout=setTimeout(function(){i()},o||2e3)))},n.handleMouseOver=function(){n.over=!0,n.timeout&&(window.clearTimeout(n.timeout),n.timeout=null)},n.handleMouseOut=function(){n.over=!1;var e=n.props,t=e.onHide,a=e.visibleTimeout;t&&(n.timeout&&window.clearTimeout(n.timeout),n.timeout=setTimeout(function(){t()},a||2e3))},n.handleMouseDown=function(){n.clickedInOverlay=!0},n.handleMouseUp=function(){n.clickedInOverlay=!1},n.handlePlay=function(e){var t=n.props.onPlay;mr.event("ControlsOverlay","clicked play").send(),t&&t(e)},n.handlePause=function(e){var t=n.props.onPause;mr.event("ControlsOverlay","clicked pause").send(),t&&t(e)},n.handleRun=function(e){var t=n.props.onRun;mr.event("ControlsOverlay","clicked run").send(),t&&t(e)},n.handlePrevious=function(e){var t=n.props.onPrevious;mr.event("ControlsOverlay","clicked previous").send(),t&&t(e)},n.handleNext=function(e){var t=n.props.onNext;mr.event("ControlsOverlay","clicked next").send(),t&&t(e)},n.handleStop=function(e){var t=n.props.onStop;mr.event("ControlsOverlay","clicked stop").send(),t&&t(e)},n.handleTogglePane=function(e){var t=n.props,a=t.onTogglePane;t.gcodePaneVisible?mr.event("ControlsOverlay","clicked hide gcode pane").send():mr.event("ControlsOverlay","clicked show gcode pane").send(),a&&a(e)},n}return Object(Y.a)(t,e),Object(H.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.visible,a=e.paused,r=e.running,i=e.loadedValue,o=e.value,s=e.timeMultiplierValue,c=e.currentTime,l=e.fadeTime,u=e.onSlider,d=e.onTimeSlider,h=Math.floor(c)%60,p=Math.floor(c/60)%60,m=Math.floor(c/60/60),f=pr(m,2)+":"+pr(p,2)+":"+pr(h,2),v=Math.log(s+1)/Math.log(1001);return g.a.createElement(Ya.a,{in:n,timeout:l||500},g.a.createElement("div",{className:t.overlay,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onMouseDown:this.handleMouseDown},g.a.createElement("div",null,g.a.createElement("div",{className:t.left},g.a.createElement(wn.a,{title:"Toggle GCode Pane",enterDelay:500,placement:"top",disableFocusListener:!0},g.a.createElement(Ka.a,{onClick:this.handleTogglePane},g.a.createElement($a.a,{className:t.button})))),g.a.createElement("div",{className:t.center},g.a.createElement(wn.a,{title:"Previous Line",enterDelay:500,placement:"top",disableFocusListener:!0},g.a.createElement(Ka.a,{onClick:this.handlePrevious},g.a.createElement(nr.a,{className:t.button}))),r?a?g.a.createElement(wn.a,{title:"Play",enterDelay:500,placement:"top",disableFocusListener:!0},g.a.createElement(Ka.a,{onClick:this.handlePlay},g.a.createElement(rr.a,{className:t.button}))):g.a.createElement(wn.a,{title:"Pause",enterDelay:500,placement:"top",disableFocusListener:!0},g.a.createElement(Ka.a,{onClick:this.handlePause},g.a.createElement(cr.a,{className:t.button}))):null,r?g.a.createElement(wn.a,{title:"Stop Program",enterDelay:500,placement:"top",disableFocusListener:!0},g.a.createElement(Ka.a,{onClick:this.handleStop},g.a.createElement(ur.a,{className:t.button}))):g.a.createElement(wn.a,{title:"Run Program",enterDelay:500,placement:"top",disableFocusListener:!0},g.a.createElement(Ka.a,{onClick:this.handleRun},g.a.createElement(or.a,{className:t.button}))),g.a.createElement(wn.a,{title:"Next Line",enterDelay:500,placement:"top",disableFocusListener:!0},g.a.createElement(Ka.a,{onClick:this.handleNext},g.a.createElement(er.a,{className:t.button})))),g.a.createElement("div",{className:t.right},g.a.createElement("div",{className:t.timeSliderContainer},g.a.createElement(Ja.a,{min:0,max:1,value:v,trackValue:1,onChange:function(e,t){return d(Math.pow(1001,t)-1)}})),g.a.createElement("div",{className:t.timeIconContainer},g.a.createElement(wn.a,{title:"Time Scale",enterDelay:500,placement:"top",disableFocusListener:!0},g.a.createElement(hr.a,{onClick:function(e){mr.event("ControlsOverlay","clicked reset time scale").send(),d(1)},className:t.timeIcon})),g.a.createElement("span",{className:t.timeMultiplierLabel},s.toFixed(2))))),g.a.createElement("br",{className:t.break}),g.a.createElement("div",{className:t.sliderControls},g.a.createElement("div",{className:t.sliderTime},f),g.a.createElement("div",{className:t.sliderContainer},g.a.createElement(Ja.a,{value:o,trackValue:i,onChange:function(e,t){return u(t)}})))))}}]),t}(m.Component),fr=Object(st.withStyles)(function(e){return{toolbar:e.mixins.toolbar,overlay:{zIndex:e.zIndex.drawer+3,position:"absolute",left:0,bottom:20,right:0,marginLeft:"auto",marginRight:"auto",width:"670px",maxWidth:"100%",textAlign:"center",verticalAlign:"middle",backgroundColor:"rgba(100,100,100,.75)",borderRadius:5,color:"white"},button:{color:"#dddddd"},left:{float:"left",width:"33.333%",textAlign:"left"},center:{float:"left",width:"33.333%",textAlign:"center"},right:{float:"left",width:"33.333%",marginBottom:0,textAlign:"right"},break:{lineHeight:0,clear:"both"},sliderTime:{float:"left",width:50,marginLeft:15,fontSize:10,lineHeight:"32px",verticalAlign:"middle"},sliderContainer:{float:"left",width:"calc(100% - 95px)",marginLeft:15,marginRight:15},timeSliderContainer:{width:"calc(100% - 100px)",float:"right",marginRight:15},timeIconContainer:{float:"right",lineHeight:"32px",cursor:"pointer"},timeIcon:{color:"#dddddd",verticalAlign:"middle"},timeMultiplierLabel:{fontSize:"10px",marginRight:5}}})(gr),vr=Object(b.b)(function(e,t){return{visible:e.get("ui").get("controlsOverlay").get("visible"),gcodePaneVisible:e.get("ui").get("gcodePane").get("visible"),loadedValue:e.get("interpreter").get("processingProgress"),value:e.get("interpreter").get("totalTime")>0?e.get("interpreter").get("currentTime")/e.get("interpreter").get("totalTime")*100:0,currentTime:e.get("interpreter").get("currentTime"),paused:e.get("interpreter").get("paused"),running:e.get("interpreter").get("running"),timeMultiplierValue:e.get("interpreter").get("timeMultiplier")}},function(e,t){return{onShow:function(){return e(V.ui.controlsOverlay.setVisible(!0))},onHide:function(){return e(V.ui.controlsOverlay.setVisible(!1))},onTogglePane:function(){return e(V.ui.gcodePane.togglePane())},onHome:function(){return e(V.ui.controlsOverlay.home())},onShuffle:function(){return e(V.ui.controlsOverlay.shuffle())},onPrevious:function(){return e(V.interpreter.previousLine())},onPlay:function(){return e(V.interpreter.unpause())},onRun:function(){return e(V.interpreter.run())},onStop:function(){return e(V.interpreter.stop())},onPause:function(){return e(V.interpreter.pause())},onNext:function(){return e(V.interpreter.nextLine())},onSlider:function(t){return e(V.interpreter.setCurrentLineWithPercentage(t))},onTimeSlider:function(t){return e(V.interpreter.setTimeMultiplier(t))}}})(fr),br=n(343),Mr=n.n(br),Sr=n(342),yr=n.n(Sr),xr=n(207),Or=n.n(xr),wr=n(78),jr=n.n(wr),Er=te(),Tr=function(e){function t(){var e;return Object(B.a)(this,t),(e=Object(U.a)(this,Object(X.a)(t).call(this))).handleClickOutOfMenu=function(){e.setState({parentMenuOpen:!1,perspectiveMenuOpen:!1})},e.handleMouseOver=function(){e.setState({active:!0})},e.handleMouseOut=function(){e.setState({active:!1})},e.toggleParentMenu=function(t){var n;e.setState((n=t.currentTarget,function(e){return{parentMenuOpen:!e.parentMenuOpen,parentAnchorEl:n}}))},e.togglePerspectiveMenu=function(t){var n;e.setState((n=t.currentTarget,function(e){return{perspectiveMenuOpen:!e.perspectiveMenuOpen,perspectiveAnchorEl:n}}))},e.handlePerspective=function(){var t=e.props.setPerspective;e.setState({perspectiveMenuOpen:!1}),Er.event("CameraButtons","set perspective").send(),t()},e.handleOrthographic=function(){var t=e.props.setOrthographic;e.setState({perspectiveMenuOpen:!1}),Er.event("CameraButtons","set orthographic").send(),t()},e.handleParentCamera=function(t){var n=e.props.parentCamera;Er.event("CameraButtons","parent camera to "+t).send(),n(t),e.setState({parentMenuOpen:!1})},e.state={parentMenuOpen:!1,perspectiveMenuOpen:!1,active:!1,parentAnchorEl:null,perspectiveAnchorEl:null},e}return Object(Y.a)(t,e),Object(H.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.hideTitleBar,r=t.showDentalFixture,i=this.state,o=i.parentMenuOpen,s=i.perspectiveMenuOpen,c=i.active,l=i.parentAnchorEl,u=i.perspectiveAnchorEl;return g.a.createElement("div",{className:a?n.cameraButtonsNoTitleBar:n.cameraButtons},g.a.createElement(un.a,{variant:"fab",className:_n()(n.button,Object(ut.a)({},n.active,c)),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onClick:this.toggleParentMenu},g.a.createElement(yr.a,null)),g.a.createElement("br",null),g.a.createElement(un.a,{variant:"fab",className:_n()(n.button,n.marginTop,Object(ut.a)({},n.active,c)),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onClick:this.togglePerspectiveMenu},g.a.createElement(Mr.a,null)),g.a.createElement("br",null),g.a.createElement(Or.a,{open:o,anchorEl:l,onClose:this.handleClickOutOfMenu},g.a.createElement(jr.a,{onClick:function(){return e.handleParentCamera(we)}},"Base"),g.a.createElement(jr.a,{onClick:function(){return e.handleParentCamera(Te)}},"Y"),g.a.createElement(jr.a,{onClick:function(){return e.handleParentCamera(Ee)}},"A"),g.a.createElement(jr.a,{onClick:function(){return e.handleParentCamera(je)}},"B"),g.a.createElement(jr.a,{onClick:function(){return e.handleParentCamera(Pe)}},"Tool"),r?g.a.createElement(jr.a,{onClick:function(){return e.handleParentCamera(Ae)}},"Dental Fixture"):null),g.a.createElement(Or.a,{open:s,anchorEl:u,onClose:this.handleClickOutOfMenu},g.a.createElement(jr.a,{onClick:function(){return e.handlePerspective()}},"Perspective"),g.a.createElement(jr.a,{onClick:function(){return e.handleOrthographic()}},"Orthographic")))}}]),t}(m.Component),Pr=Object(st.withStyles)(function(e){return{button:{width:"30px",height:"30px",minHeight:"30px",opacity:.25,transition:"opacity .5s"},extendedButton:{width:"110px",height:"30px",minHeight:"30px",opacity:.25,transition:"opacity .5s",textTransform:"none"},marginLeft:{marginLeft:"10px"},active:{opacity:1},marginTop:{marginTop:"5px"},cameraButtonsNoTitleBar:{position:"absolute",right:"20px",top:"20px",textAlign:"right"},cameraButtons:{position:"absolute",right:"20px",top:"85px",textAlign:"right"}}})(Tr),Ar=Object(b.b)(function(e,t){return{hideTitleBar:!e.get("ui").get("titleBar").get("visible")}},function(e,t){return{parentCamera:function(t){return e(V.viewer3D.parentCamera(t))},setPerspective:function(){return e(V.viewer3D.setPerspective())},setOrthographic:function(){return e(V.viewer3D.setOrthographic())}}})(Pr),kr=n(344),Cr=n.n(kr),Lr=n(345),Rr=n.n(Lr),Ir=Object(st.withStyles)(function(e){return{droNoTitleBar:{borderRadius:10,padding:"10px",backgroundColor:"rgba(100,100,100,.75)",color:"white",marginTop:10,textAlign:"right"},dro:{borderRadius:10,padding:"10px",backgroundColor:"rgba(100,100,100,.75)",color:"white",marginTop:10,textAlign:"right"},pre:{padding:0,margin:0}}})(function(e){var t=e.classes,n=e.hideTitleBar,a=e.X,r=e.Y,i=e.Z,o=e.A,s=e.B;return g.a.createElement("div",{className:n?t.droNoTitleBar:t.dro},g.a.createElement("pre",{className:t.pre},"X: ",a,g.a.createElement("br",null),"Y: ",r,g.a.createElement("br",null),"Z: ",i,g.a.createElement("br",null),"A: ",o,g.a.createElement("br",null),"B: ",s))}),Gr=Object(b.b)(function(e,t){var n=e.get("machineState").get("motion").get("position");return{hideTitleBar:!e.get("ui").get("titleBar").get("visible"),X:n.get("X").toFixed(4).padStart(8," "),Y:n.get("Y").toFixed(4).padStart(8," "),Z:n.get("Z").toFixed(4).padStart(8," "),A:n.get("A").toFixed(4).padStart(8," "),B:n.get("B").toFixed(4).padStart(8," ")}},function(e,t){return{}})(Ir),Dr=function(e){function t(){var e;return Object(B.a)(this,t),(e=Object(U.a)(this,Object(X.a)(t).call(this))).handleMouseOver=function(){e.setState({active:!0})},e.handleMouseOut=function(){e.setState({active:!1})},e.handleToggleModel=function(){var t=e.props,n=t.modelShown,a=t.showModel,r=t.hideModel;n?r():a()},e.state={active:!1},e}return Object(Y.a)(t,e),Object(H.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.hideTitleBar,a=e.modelShown,r=e.modelLoaded,i=this.state.active;return g.a.createElement("div",{className:n?t.otherButtonsNoTitleBar:t.otherButtons},r?g.a.createElement(un.a,{variant:"extendedFab",className:_n()(t.extendedButton,t.marginTop,Object(ut.a)({},t.active,i)),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onClick:this.handleToggleModel},"Model ",a?g.a.createElement(Cr.a,{className:t.marginLeft}):g.a.createElement(Rr.a,{className:t.marginLeft})):null,g.a.createElement(Gr,null))}}]),t}(m.Component),Nr=Object(st.withStyles)(function(e){return{button:{width:"30px",height:"30px",minHeight:"30px",opacity:.25,transition:"opacity .5s"},extendedButton:{width:"110px",height:"30px",minHeight:"30px",opacity:.25,transition:"opacity .5s",textTransform:"none"},marginLeft:{marginLeft:"10px"},active:{opacity:1},marginTop:{marginTop:"5px"},otherButtonsNoTitleBar:{position:"absolute",right:"20px",top:"180px",textAlign:"right"},otherButtons:{position:"absolute",right:"20px",top:"160px",textAlign:"right"}}})(Dr),_r=Object(b.b)(function(e,t){return{hideTitleBar:!e.get("ui").get("titleBar").get("visible"),modelShown:e.get("viewer3D").get("showModel"),modelLoaded:e.get("viewer3D").get("modelLoaded")}},function(e,t){return{showModel:function(){return e(V.viewer3D.showModel())},hideModel:function(){return e(V.viewer3D.hideModel())}}})(Nr),zr=Object(st.createMuiTheme)({typography:{useNextVariants:!0}}),Fr=Object(st.withStyles)(function(e){return{container:{position:"relative",width:"100vw",height:"100vh",overflow:"hidden"},machinePane:{position:"fixed",right:10,bottom:0},topSpacing:{marginTop:"10px"}}})(function(e){var t=e.classes,n=e.hideTitleBar,a=e.machine,r=e.onChangeMachine,i=e.running;return g.a.createElement(st.MuiThemeProvider,{theme:zr},g.a.createElement("div",{className:t.container},n?null:g.a.createElement(kn,null),g.a.createElement(Va,null),g.a.createElement(Ar,null),g.a.createElement(_r,null),g.a.createElement(Ua,{width:5}),g.a.createElement(vr,null),g.a.createElement(tn,null),g.a.createElement("div",{className:t.machinePane},g.a.createElement(da.a,{value:"V2-10",name:"V2-10",color:"default",disabled:i,checked:a===ye,onClick:function(){return r(ye)}})," V2-10",g.a.createElement("br",null),g.a.createElement(da.a,{value:"V2-50",name:"V2-50",color:"default",disabled:i,checked:a===xe,onClick:function(){return r(xe)}})," V2-50",g.a.createElement("br",null))))}),Zr=Object(b.b)(function(e,t){return{hideTitleBar:!e.get("ui").get("titleBar").get("visible"),machine:e.get("machineState").get("machine"),running:e.get("interpreter").get("running")}},function(e,t){return{onChangeMachine:function(t){e(V.machineState.machine.set(t))}}})(Fr),Vr=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Br(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var Hr,Ur,Xr,Yr,Wr,Kr,Jr,qr,$r,Qr,ei,ti=n(349),ni=n(92),ai=function(){function e(){Object(B.a)(this,e),this.windows=[]}return Object(H.a)(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),Object(H.a)(e,[{key:"addWindow",value:function(e,t){console.log("added window",t),this.windows.push({window:e,origin:t}),e.postMessage({type:"IFRAME/INITIALIZE"},t)}},{key:"sendMessage",value:function(e){this.windows.forEach(function(t){var n=t.window,a=t.origin;console.log("sending message to window with origin",a),n.postMessage(e,a)})}}]),e}(),ri=n(68),ii=n(77),oi=n(102),si=n(161),ci="OFF",li="RAPID",ui="LINEAR",di="ARC_CW",hi="ARC_CCW",pi=function(e,t,n,a,r){r||(r=1);var i,o,s,c,l,u=e.get("X"),d=e.get("Y"),h=e.get("Z"),p=t.get("I"),m=t.get("J"),g=t.get("K"),f=t.get("X"),v=t.get("Y"),b=t.get("Z");switch(n){case Ze:i=u-p,o=d-m,s=f-p,c=v-m,l=b-h;break;case Ve:i=h-g,o=u-p,s=b-g,c=f-p,l=v-d;break;case Be:i=-(h-g),o=d-m,s=-(b-g),c=v-m,l=f-u}var M=Math.sqrt(i*i+o*o),S=Math.atan2(o,i);S<0&&(S+=2*Math.PI);var y,x=Math.atan2(c,s);x<0&&(x+=2*Math.PI),a===di?(y=x-S)>nt?y=-(2*Math.PI-y):y<nt&&y>-nt&&(y-=2*Math.PI*r):(y=x-S)<-nt?y=2*Math.PI+y:y>-nt&&y<nt&&(y+=2*Math.PI*r);var O=l,w=y*M;return Math.sqrt(O*O+w*w)},mi=function(e,t,n,a,r,i){switch(e){case li:case ui:return function(e,t,n){return ht.a.Map({X:e.get("X")*(1-n)+t.get("X")*n,Y:e.get("Y")*(1-n)+t.get("Y")*n,Z:e.get("Z")*(1-n)+t.get("Z")*n,A:e.get("A")*(1-n)+t.get("A")*n,B:e.get("B")*(1-n)+t.get("B")*n,C:e.get("C")*(1-n)+t.get("C")*n})}(t,n,a);case ci:return n;case di:case hi:return function(e,t,n,a,r,i){i||(i=1);var o,s,c,l,u=e.get("X"),d=e.get("Y"),h=e.get("Z"),p=t.get("I"),m=t.get("J"),g=t.get("K"),f=t.get("X"),v=t.get("Y"),b=t.get("Z");switch(a){case Ze:o=u-p,s=d-m,c=f-p,l=v-m;break;case Ve:o=h-g,s=u-p,c=b-g,l=f-p;break;case Be:o=-(h-g),s=d-m,c=-(b-g),l=v-m}var M=Math.atan2(s,o);M<0&&(M+=2*Math.PI);var S,y=Math.atan2(l,c);y<0&&(y+=2*Math.PI),r===di?(S=y-M)>nt?S=-(2*Math.PI-S):S<nt&&S>-nt&&(S-=2*Math.PI*i):(S=y-M)<-nt?S=2*Math.PI+S:S>-nt&&S<nt&&(S+=2*Math.PI*i),S*=n;var x,O,w,j=Math.cos(S),E=Math.sin(S);switch(a){case Ze:x=p+(u-p)*j-(d-m)*E,O=m+(u-p)*E+(d-m)*j,w=h*(1-n)+b*n;break;case Ve:x=p+(u-p)*j+(h-g)*E,O=d*(1-n)+v*n,w=g-(u-p)*E+(h-g)*j;break;case Be:x=u*(1-n)+f*n,O=m+(d-m)*j-(h-g)*E,w=g+(d-m)*E+(h-g)*j}var T=e.get("A")*(1-n)+t.get("A")*n,P=e.get("B")*(1-n)+t.get("B")*n;return ht.a.Map({X:x,Y:O,Z:w,A:T,B:P})}(t,n,a,r,e,i);default:return console.error(e," motion mode not implemented, jumping to final position."),n}},gi=Object(S.c)((Hr={},Object(ut.a)(Hr,x.machineState.feedRateMode.setInverseTime,function(){return De}),Object(ut.a)(Hr,x.machineState.feedRateMode.setUnitsPerMinute,function(){return Ne}),Object(ut.a)(Hr,x.machineState.feedRateMode.setUnitsPerRevolution,function(){return _e}),Hr),Ne),fi=Object(S.c)(Object(ut.a)({},O.machineState.feedRate.set,function(e,t){return t.payload}),0),vi=Object(S.c)((Ur={},Object(ut.a)(Ur,P.machineState.planeSelect.setXY,function(){return Ze}),Object(ut.a)(Ur,P.machineState.planeSelect.setZX,function(){return Ve}),Object(ut.a)(Ur,P.machineState.planeSelect.setYZ,function(){return Be}),Object(ut.a)(Ur,P.machineState.planeSelect.setUV,function(){return He}),Object(ut.a)(Ur,P.machineState.planeSelect.setWU,function(){return Ue}),Object(ut.a)(Ur,P.machineState.planeSelect.setVW,function(){return Xe}),Ur),Ze),bi=Object(S.c)((Xr={},Object(ut.a)(Xr,w.machineState.units.setIn,function(){return Ye}),Object(ut.a)(Xr,w.machineState.units.setMm,function(){return We}),Xr),Ye),Mi=ht.a.Map({Z:0,R:0,holder:"NONE"}),Si=Object(S.c)((Yr={},Object(ut.a)(Yr,C.machineState.tool.set,function(e,t){return e.set("set",t.payload)}),Object(ut.a)(Yr,C.machineState.tool.change,function(e,t){return e.set("loaded",e.get("set"))}),Object(ut.a)(Yr,C.machineState.tool.setToolLengthOffset,function(e,t){var n=t.payload.H,a=e.get("loaded")-1;void 0!==n&&(a=n-1);var r=e.get("table").get(a);return e.set("toolLengthOffset",r)}),Object(ut.a)(Yr,C.machineState.tool.clearToolLengthOffset,function(e,t){return e.set("toolLengthOffset",Mi)}),Object(ut.a)(Yr,C.machineState.tool.table.setTool,function(e,t){var n=t.payload,a=n.P,r={X:n.X,Y:n.Y,Z:n.Z,A:n.A,B:n.B,C:n.C,U:n.U,V:n.V,W:n.W,R:n.R,I:n.I,J:n.J,Q:n.Q,holder:n.holder};for(var i in r)void 0===r[i]&&delete r[i];var o=e.get("table");return e.set("table",o.set(a-1,o.get(a-1).merge(r)))}),Yr),ht.a.Map({set:0,loaded:0,toolLengthOffset:Mi,table:ht.a.List([ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me}),ht.a.Map({Z:-3,R:.0625,holder:Me})])})),yi=Object(S.c)((Wr={},Object(ut.a)(Wr,j.machineState.kinematicsMode.setFiveAxis,function(){return ze}),Object(ut.a)(Wr,j.machineState.kinematicsMode.setTrivial,function(){return Fe}),Wr),Fe),xi=Object(S.c)(Object(ut.a)({},E.machineState.cutterCompensation.off,void 0),Ke),Oi=Object(S.c)(Object(ut.a)({},k.machineState.spindleSpeed.set,function(e,t){return t.payload}),0),wi=Object(S.c)((Kr={},Object(ut.a)(Kr,A.machineState.spindleControl.off,function(){return"OFF"}),Object(ut.a)(Kr,A.machineState.spindleControl.ccw,function(){return"CCW"}),Object(ut.a)(Kr,A.machineState.spindleControl.cw,function(){return"CW"}),Kr),"OFF"),ji=Object(S.c)(Object(ut.a)({},L.machineState.machine.set,function(e,t){return t.payload}),ye),Ei=ht.a.Map({mode:ci,distanceMode:Le,arcDistanceMode:Ge,turns:0,issuedMotionCommand:!1,position:ht.a.Map({X:0,Y:1,Z:0,A:0,B:0,C:0,I:0,J:0,K:0})}),Ti=function(e,t){var n=e.get("position"),a=t.payload,r=a.X,i=a.Y,o=a.Z,s=a.A,c=a.B,l=a.C,u=a.I,d=a.J,h=a.K,p=a.units,m=a.G53,g=e.get("distanceMode"),f=e.get("arcDistanceMode"),v={X:r,Y:i,Z:o,A:s,B:c,C:l};for(var b in v)void 0===v[b]?delete v[b]:p!==We||"X"!==b&&"Y"!==b&&"Z"!==b||(v[b]=v[b]/25.4);var M={I:u,J:d,K:h};for(var S in M)void 0===M[S]?M[S]=0:p===We&&(M[S]=M[S]/25.4);var y=e.get("position");if(m||(y=g===Le?e.get("position").merge(v):y.withMutations(function(e){for(var t in v)e.set(t,e.get(t)+v[t])})),f===Ie)y=e.get("position").merge(M);else{var x={I:"X",J:"Y",K:"Z"};y=y.withMutations(function(e){for(var t in M)e.set(t,n.get(x[t])+M[t])})}return y},Pi=Object(S.c)((Jr={},Object(ut.a)(Jr,R.machineState.distanceMode.setAbsolute,function(e,t){return e.set("distanceMode",Le)}),Object(ut.a)(Jr,R.machineState.distanceMode.setIncremental,function(e,t){return e.set("distanceMode",Re)}),Object(ut.a)(Jr,R.machineState.motion.nonMotionCommand,function(e,t){return e.set("issuedMotionCommand",!1)}),Object(ut.a)(Jr,R.machineState.motion.off,function(e,t){return e.set("mode",ci)}),Object(ut.a)(Jr,R.machineState.motion.rapid,function(e,t){return e.withMutations(function(e){return e.set("position",Ti(e,t)).set("issuedMotionCommand",!0).set("mode",li)})}),Object(ut.a)(Jr,R.machineState.motion.linear,function(e,t){return e.withMutations(function(e){return e.set("position",Ti(e,t)).set("issuedMotionCommand",!0).set("mode",ui)})}),Object(ut.a)(Jr,R.machineState.motion.arcCW,function(e,t){var n=t.payload.P;return e.withMutations(function(e){return e.set("position",Ti(e,t)).set("turns",n).set("issuedMotionCommand",!0).set("mode",di)})}),Object(ut.a)(Jr,R.machineState.motion.arcCCW,function(e,t){var n=t.payload.P;return e.withMutations(function(e){return e.set("position",Ti(e,t)).set("turns",n).set("issuedMotionCommand",!0).set("mode",hi)})}),Object(ut.a)(Jr,R.machineState.motion.setPosition,function(e,t){return e.withMutations(function(e){return e.set("position",Ti(e,t)).set("issuedMotionCommand",!0)})}),Jr),Ei),Ai=Pi,ki=n(105),Ci={G4:0,G10:0,G28:0,G30:0,G53:0,G92:0,"G92.1":0,"G92.2":0,"G92.3":0,G0:1,G1:1,G2:1,G3:1,G33:1,"G38.2":1,G73:1,G76:1,G81:1,G82:1,G83:1,G84:1,G85:1,G86:1,G87:1,G88:1,G89:1,G17:2,G18:2,G19:2,"G17.1":2,"G18.1":2,"G19.1":2,G90:3,G91:3,"G90.1":4,"G91.1":4,G93:5,G94:5,G95:5,G20:6,G21:6,G40:7,G41:7,G42:7,"G41.1":7,"G42.1":7,G43:8,"G43.1":8,G49:8,G98:10,G99:10,G54:12,G55:12,G56:12,G57:12,G58:12,G59:12,"G59.1":12,"G59.2":12,"G59.3":12,G61:13,"G61.1":13,G664:13,G96:14,G97:14,G7:15,G8:15,M0:4,M1:4,M2:4,M30:4,M60:4,M3:7,M4:7,M5:7,M7:8,M8:8,M9:8,M48:9,M49:9},Li={G10:!0,G92:!0,G0:!0,G1:!0,G2:!0,G3:!0,G33:!0,"G38.2":!0,G73:!0,G76:!0,G81:!0,G82:!0,G83:!0,G84:!0,G85:!0,G86:!0,G87:!0,G88:!0,G89:!0,"G43.1":!0},Ri=n(346),Ii=function e(t){var n=this;Object(B.a)(this,e),this.getState=function(){return n.store.getState()},this.interpret=function(e){n.messages=[];var t,a={},r=[],i=Object(Ri.parseLine)(e);for(var o in i.words.forEach(function(e,t){var n=Object(ki.a)(e,2),i=n[0]+n[1],o=function(e){return Ci[e]}(i);void 0!==o&&(a[o]?a[o].push(i):a[o]=[i]),function(e){return Li[e]}(i)&&r.push(i)}),r.length>1&&n.messages.push({message:"Can't run multiple commands with positional arguments on the same line. Codes "+(t=r).slice(0,t.length-1).join(", ")+" and "+t[t.length-1]+" use positional arguments.",codes:t,type:At,severity:yt}),a)a[o].length>1&&n.messages.push(Rt(a[o],o));var s={},c=[],l=[],u=[],d=!1;i.words.forEach(function(e,t){var a=function(e){return vt[e]}(e[0]);a&&c.push([a,e[1]]);var r=e[0]+e[1];"G43"===r&&(d=!0);var i=function(e){return pt[e]}(r),o=function(e){return ft[e]}(r);o&&l.push(o());var h=function(e){return gt[e]}(r);h&&u.push(h(s));var p=function(e){return bt[e]}(r);p&&(s[r]=!0),i&&n.messages.push(function(e){var t=Mt(e);return{message:"Ignoring "+e+" as it is currently unimplemented in the simulator. Intended usage: "+t,description:t,severity:xt,type:wt,code:e}}(r)),o||i||p||h||a||(s[e[0]]=e[1],"G"!==e[0]&&"M"!==e[0]||n.messages.push(function(e){return{message:"Unrecognized G or M code: "+e,severity:yt,type:jt,code:e}}(r)))});var h=a[1];0===r.length&&["X","Y","Z","A","B","C","I","J","K"].reduce(function(e,t){return e||void 0!==s[t]},!1)&&(u.push(St(s)),h=!0),h||u.push(T.machineState.motion.nonMotionCommand()),l.forEach(function(e){n.store.dispatch(e)});var p=n.store.getState().get("units");if(s.units=p,c.forEach(function(e){var t=Object(ki.a)(e,2),a=t[0],r=t[1];n.store.dispatch(a(r))}),u.forEach(function(e){n.store.dispatch(e)}),h){var m=n.store.getState(),g=en[m.get("machine")];n.messages=n.messages.concat(g.getLimitErrors(m.get("joints")))}var f,v,b=n.store.getState();if(d){var M=b.get("tool"),S=M.get("loaded"),y=S;"undefined"!==typeof s.H&&(y=s.H),n.messages.push(function(e,t,n,a){return{message:"Set tool length offset to "+t.toFixed(4)+" which is what is stored under tool "+e+".",toolNumber:e,toolLengthOffset:t,toolDiameter:n,toolHolder:a,severity:Ot,type:Ct}}(y,M.get("toolLengthOffset").get("Z"),2*M.get("toolLengthOffset").get("R"),M.get("toolLengthOffset").get("holder"))),S!==y&&n.messages.push({message:"Tool specified by G43, T"+(f=y)+", differs from last tool loaded with M6, T"+(v=S)+". The simulator uses the last tool loaded with M6 to determine which tool to show, so your tool path may vary from what you would expect.",g43ToolNum:f,m6ToolNum:v,severity:xt,type:Lt})}return b};var a=t.machineState;this.store=Object(ri.createStore)(Di,a)},Gi=Object(oi.combineReducers)({machine:ji,feedRateMode:gi,feedRate:fi,units:bi,tool:Si,planeSelect:vi,kinematicsMode:yi,cutterCompensation:xi,spindleSpeed:Oi,spindleControl:wi,motion:Ai,joints:function(e,t){return e||ht.a.List([0,1.5,0,0,0])}}),Di=Object(si.a)(Gi,function(e,t){return e.set("joints",(n=e,Object(S.c)(Object(ut.a)({},Object(S.a)(R.machineState.motion.rapid,R.machineState.motion.linear,R.machineState.motion.arcCW,R.machineState.motion.arcCCW,R.machineState.motion.setPosition),function(e,t){var a,r=t.payload,i=r.X,o=r.Y,s=r.Z,c=r.A,l=r.B,u=r.C,d=r.units,h=r.G53,p=en[n.get("machine")];if(h){var m=p.kinematics.forwardKinematics(n,h),g={X:i,Y:o,Z:s,A:c,B:l,C:u};for(var f in g)void 0===g[f]?delete g[f]:d!==We||"X"!==f&&"Y"!==f&&"Z"!==f||(g[f]=g[f]/25.4);m=n.get("motion").get("distanceMode")===Le?m.merge(g):m.withMutations(function(e){for(var t in g)e.set(t,e.get(t)+g[t])}),a=p.kinematics.inverseKinematics(n.set("motion",n.get("motion").set("position",m)),h)}else a=p.kinematics.inverseKinematics(n);return a}),ht.a.List([0,0,0,0,0])))(e.get("joints"),t));var n},function(e,t){return e.set("motion",(n=e,Object(S.c)(Object(ut.a)({},Object(S.a)(R.machineState.tool.setToolLengthOffset,R.machineState.tool.clearToolLengthOffset,R.machineState.motion.rapid,R.machineState.motion.linear,R.machineState.motion.arcCW,R.machineState.motion.arcCCW,R.machineState.motion.setPosition,R.machineState.kinematicsMode.setFiveAxis,R.machineState.kinematicsMode.setTrivial),function(e,t){var a=en[n.get("machine")],r=e.get("position").merge(a.kinematics.forwardKinematics(n));return e.set("position",r)}),Ei))(e.get("motion"),t));var n}),Ni=function(e,t){var n=e.get("times"),a=0;if(t>=n.get(n.size-1))a=n.size-1,t=n.get(a);else if(0===t)a=0;else{for(var r=0,i=n.size-1,o=Math.floor(n.size/2);r+1<i;)n.get(o)>=t?i=o:r=o,o=Math.floor(.5*(r+i));a=t<n.get(r)?r:i}return e.withMutations(function(e){return e.set("currentLine",a).set("currentTime",t)})},_i=ht.a.Map({fileName:"sim.ngc",lines:[],messages:ht.a.List([]),states:ht.a.List([]),initialState:ht.a.Map({}),times:ht.a.List([]),linesPerIndex:1,loading:!1,loadingProgress:0,processing:!1,processingProgress:0,currentLine:0,totalTime:0,currentTime:0,paused:!0,running:!1,timeMultiplier:1}),zi=Object(S.c)((qr={},Object(ut.a)(qr,I.interpreter.startLoading,function(e,t){return e.withMutations(function(e){return e.set("lines",[]).set("loadingProgress",0).set("loading",!0).set("currentLine",0).set("currentTime",0).set("totalTime",0).set("states",ht.a.List([])).set("times",ht.a.List([])).set("messages",ht.a.List([]))})}),Object(ut.a)(qr,I.interpreter.endLoading,function(e,t){return e.set("loading",!1)}),Object(ut.a)(qr,I.interpreter.setFileName,function(e,t){return e.set("fileName",t.payload)}),Object(ut.a)(qr,I.interpreter.setLoadingProgress,function(e,t){return e.set("loadingProgress",t.payload)}),Object(ut.a)(qr,I.interpreter.setLines,function(e,t){return e.withMutations(function(e){return e.set("lines",t.payload.lines).set("currentLine",0).set("currentTime",0).set("paused",!0).set("running",!0).set("linesPerIndex",Math.max(Math.min(Math.ceil(t.payload.lines.length/5e4),300),1)).set("states",ht.a.List([])).set("times",ht.a.List([])).set("messages",ht.a.List([]))})}),Object(ut.a)(qr,I.interpreter.startProcessing,function(e,t){return e.withMutations(function(e){return e.set("processingProgress",0).set("processing",!0).set("states",ht.a.List([])).set("times",ht.a.List([])).set("messages",ht.a.List([]))})}),Object(ut.a)(qr,I.interpreter.endProcessing,function(e,t){return e.set("processing",!1)}),Object(ut.a)(qr,I.interpreter.setProcessingProgress,function(e,t){return e.set("processingProgress",t.payload)}),Object(ut.a)(qr,I.interpreter.setInitialState,function(e,t){return e.set("initialState",t.payload)}),Object(ut.a)(qr,I.interpreter.appendIndices,function(e,t){var n;return e.set("states",(n=e.get("states")).push.apply(n,Object(W.a)(t.payload)))}),Object(ut.a)(qr,I.interpreter.appendMessages,function(e,t){var n;return e.set("messages",(n=e.get("messages")).push.apply(n,Object(W.a)(t.payload)))}),Object(ut.a)(qr,I.interpreter.appendTimes,function(e,t){var n,a=(n=e.get("times")).push.apply(n,Object(W.a)(t.payload)),r=e.get("lines");return e.withMutations(function(e){return e.set("times",a).set("totalTime",a.get(a.size-1)*r.length/a.size)})}),Object(ut.a)(qr,I.interpreter.pause,function(e,t){return e.set("paused",!0)}),Object(ut.a)(qr,I.interpreter.stop,function(e,t){return e.set("running",!1)}),Object(ut.a)(qr,I.interpreter.unpause,function(e,t){return e.get("currentTime")>=e.get("totalTime")-nt&&(e=e.set("currentTime",0).set("currentLine",0)),e.set("paused",!1)}),Object(ut.a)(qr,I.interpreter.run,function(e,t){return e.set("running",!0)}),Object(ut.a)(qr,I.interpreter.setTimeMultiplier,function(e,t){return e.set("timeMultiplier",t.payload)}),Object(ut.a)(qr,I.interpreter.previousLine,function(e,t){var n=Math.max(e.get("currentLine")-1,0),a=e.get("times").get(n);return e.set("currentLine",n).set("currentTime",a).set("paused",!0)}),Object(ut.a)(qr,I.interpreter.nextLine,function(e,t){var n=Math.min(e.get("currentLine")+1,e.get("lines").length-1),a=e.get("times").get(n);return e.set("currentLine",n).set("currentTime",a)}),Object(ut.a)(qr,I.interpreter.setCurrentLine,function(e,t){var n=Math.max(0,Math.min(e.get("lines").length-1,t.payload)),a=e.get("times").get(n);return e.set("currentLine",n).set("currentTime",a)}),Object(ut.a)(qr,I.interpreter.incrementTime,function(e,t){var n=e.get("currentTime"),a=e.get("timeMultiplier"),r=t.payload*a;return(e=Ni(e,n+r)).get("currentTime")>=e.get("totalTime")?e.set("paused",!0):e}),Object(ut.a)(qr,I.interpreter.setCurrentLineWithTime,function(e,t){return Ni(e,t.payload)}),Object(ut.a)(qr,I.interpreter.setCurrentLineWithPercentage,function(e,t){return Ni(e,e.get("totalTime")*t.payload/100).set("paused",!0)}),qr),_i),Fi=Object(S.c)(($r={},Object(ut.a)($r,z.viewer3D.parentCamera,function(e,t){return e.set("cameraParent",t.payload)}),Object(ut.a)($r,z.viewer3D.setPerspective,function(e,t){return e.set("cameraMode",ke)}),Object(ut.a)($r,z.viewer3D.setOrthographic,function(e,t){return e.set("cameraMode",Ce)}),Object(ut.a)($r,z.viewer3D.loadModel,function(e,t){return e.set("modelLoaded",!0)}),Object(ut.a)($r,z.viewer3D.showModel,function(e,t){return e.set("showModel",!0)}),Object(ut.a)($r,z.viewer3D.hideModel,function(e,t){return e.set("showModel",!1)}),Object(ut.a)($r,z.viewer3D.setDimensions,function(e,t){return e.set("width",t.payload.width).set("height",t.payload.height)}),Object(ut.a)($r,z.viewer3D.cameraSetRadius,function(e,t){return e.set("radius",t.payload)}),Object(ut.a)($r,z.viewer3D.cameraSetOrthographicZoom,function(e,t){return e.set("orthographicZoom",t.payload)}),Object(ut.a)($r,z.viewer3D.cameraSetPhi,function(e,t){return e.set("phi",t.payload)}),Object(ut.a)($r,z.viewer3D.cameraSetTheta,function(e,t){return e.set("theta",t.payload)}),Object(ut.a)($r,z.viewer3D.cameraZoom,function(e,t){var n=e.get("radius"),a=e.get("orthographicZoom"),r=t.payload;return r<0?(n*=.95,a/=.95):r>0&&(n/=.95,a*=.95),a=Math.min(50,Math.max(.1,a)),n=Math.min(50,Math.max(.1,n)),e.set("orthographicZoom",a).set("radius",n)}),Object(ut.a)($r,z.viewer3D.cameraStartRotating,function(e,t){return e.set("rotating",!0)}),Object(ut.a)($r,z.viewer3D.cameraStopRotating,function(e,t){return e.set("rotating",!1)}),Object(ut.a)($r,z.viewer3D.cameraSetDirection,function(e,t){var n=t.payload,a=n.x,r=n.y,i=n.z,o=Math.sqrt(a*a+r*r+i*i),s=0,c=0;return 0!==o&&(c=Math.atan2(a,i),s=Math.acos(Math.max(Math.min(r/o,1),-1))),(s<=nt||s>=Math.PI-nt)&&(c=e.get("theta")),e.withMutations(function(e){e.set("phi",s),e.set("theta",c)})}),Object(ut.a)($r,z.viewer3D.cameraRotate,function(e,t){if(e.get("rotating")){var n=e.get("width"),a=e.get("height"),r=t.payload,i=r.dx,o=r.dy,s=e.get("theta")-2*Math.PI*i/n*2,c=Math.max(nt,Math.min(Math.PI-nt,e.get("phi")-2*Math.PI*o/a*2));return e.withMutations(function(e){e.set("theta",s),e.set("phi",c)})}return e}),$r),ht.a.Map({width:500,height:500,showModel:!1,modelLoaded:!1,cameraParent:Te,cameraMode:ke,rotating:!1,radius:10,orthographicZoom:1,phi:Math.PI/4,theta:-Math.PI/2})),Zi=Object(S.c)((Qr={},Object(ut.a)(Qr,N.ui.gcodePane.setWidth,function(e,t){return e.set("width",t.payload)}),Object(ut.a)(Qr,N.ui.gcodePane.setSelected,function(e,t){return e.set("selectedLine",t.payload)}),Object(ut.a)(Qr,N.ui.gcodePane.setLineOffset,function(e,t){return e.set("lineOffset",t.payload)}),Object(ut.a)(Qr,N.ui.gcodePane.setShowLines,function(e,t){return e.set("showLines",t.payload)}),Object(ut.a)(Qr,N.ui.gcodePane.scroll,function(e,t){return e.set("lineOffset",e.get("lineOffset")+t.payload)}),Object(ut.a)(Qr,N.ui.gcodePane.setTab,function(e,t){return e.set("currentTab",t.payload)}),Object(ut.a)(Qr,N.ui.gcodePane.togglePane,function(e,t){return e.set("visible",!e.get("visible"))}),Qr),ht.a.Map({width:320,visible:!0,lineOffset:0,showLines:50,selectedLine:0,currentTab:0})),Vi=Object(S.c)(Object(ut.a)({},N.ui.controlsOverlay.setVisible,function(e,t){return e.set("visible",t.payload)}),ht.a.Map({visible:!1})),Bi=Object(S.c)(Object(ut.a)({},V.iframe.initialize,function(e,t){return e.set("visible",!1)}),ht.a.Map({visible:!0})),Hi=Object(oi.combineReducers)({gcodePane:Zi,controlsOverlay:Vi,titleBar:Bi}),Ui=function(e){var t=e.posx,n=e.posy,a=e.posz,r=e.dirx,i=e.diry,o=e.dirz,s=e.toolOffsetZ,c=e.offsetZ,l=e.xform,u=new ce.Vector3(t,n,a),d=new ce.Vector4(r,i,o,0),h=new ce.Matrix4;h.makeRotationFromEuler(new ce.Euler(l.get("rx")/180*Math.PI,l.get("ry")/180*Math.PI,l.get(NaN*Math.PI))),h.multiplyScalar(l.get("s")),h.setPosition(new ce.Vector3(l.get("tx"),l.get("ty"),l.get("tz"))),u.applyMatrix4(h),d.applyMatrix4(h);var p=Math.asin(d.y),m=Math.atan2(-d.x,d.z),g=Zt(ht.a.Map({A:180*p/Math.PI,B:180*m/Math.PI,X:u.x/25.4,Y:u.y/25.4,Z:u.z/25.4}),s);return g.set(2,g.get(2)+c)},Xi=ht.a.Map({machine:xe,width:500,height:500,toolOffsetZ:-3,editingOffsetZ:1.5,previewingOffsetZ:0,gettingStatus:!1,step:Je,modelFinalized:!1,finalizeModelClicked:!1,modelLoaded:!1,modelUploaded:!1,finishedProcessingModel:!1,scannersDetected:0,xform:ht.a.Map({s:1,rx:0,ry:0,rz:0,tx:0,ty:0,tz:0}),loading:ht.a.Map({}),points:ht.a.List([]),closePath:!1,pointsNeedSaving:!1,xformNeedsSaving:!1,activePoint:-1,highlightedPoint:-1,showGhostSphere:!1,ghostSpherePosition:ht.a.Map({x:0,y:0,z:0}),ghostSphereOpacity:.5,scannerKey:"",rfid:"",label:"",joints:ht.a.List([0,(5+tt)/25.4,0,0,0]),machineRotating:!1,rotateStartX:0,rotateStartY:0,modelHighlighted:!1,dragModelStartX:0,dragModelStartZ:0,paused:!0,time:0,timeMultiplier:1,times:ht.a.List([0])}),Yi=Xi.withMutations(function(e){e.delete("scannersDetected"),e.delete("width"),e.delete("height")}),Wi=Object(S.c)((ei={},Object(ut.a)(ei,V.alignerState.setTimes,function(e,t){return e.set("times",ht.a.List(t.payload))}),Object(ut.a)(ei,V.alignerState.setMachine,function(e,t){return e.set("machine",t.payload)}),Object(ut.a)(ei,V.alignerState.play,function(e,t){var n=.5*e.get("points").size;return e.get("time")>=n&&(e=e.set("time",0)),e.set("paused",!1)}),Object(ut.a)(ei,V.alignerState.pause,function(e,t){return e.set("paused",!0)}),Object(ut.a)(ei,V.alignerState.incrementTime,function(e,t){var n,a,r,i,o,s,c,l,u,d,h,p,m,g,f,v=e.get("time"),b=e.get("timeMultiplier"),M=e.get("times"),S=e.get("points"),y=t.payload*b,x=M.get(M.size-1),O=Math.min(v+y,x),w=e.get("closePath"),j=0;if(v>=x)j=1;else if(0===v)j=0;else{n=0,a=M.size-1;for(var E=Math.floor(M.size/2);n+1<a;)M.get(E)>v?a=E:n=E,E=Math.floor(.5*(n+a));j=(n+(v-M.get(n))/(M.get(a)-M.get(n)))/(M.size-1)}w?(o=(r=S.size)*j-(i=Math.floor(r*j)),i>=S.size&&(i=0)):o=(r=S.size-1)*j-(i=Math.floor(r*j)),w?(f=((g=((m=i)+1)%r)+1)%r,p=(m+r-1)%r):((m=i)>=r&&(m=r),(g=m+1)>=r&&(g=r),(f=g+1)>=r&&(f=r),(p=m-1)<0&&(p=0));var T=new ce.Vector3(S.get(p).get(0),S.get(p).get(1),S.get(p).get(2)),P=new ce.Vector3(S.get(m).get(0),S.get(m).get(1),S.get(m).get(2)),A=new ce.Vector3(S.get(g).get(0),S.get(g).get(1),S.get(g).get(2)),k=new ce.Vector3(S.get(f).get(0),S.get(f).get(1),S.get(f).get(2)),C=new ce.Vector3,L=new ce.Vector3,R=new ce.Vector3,I=new ce.Vector3;C.copy(P),L.copy(A);R.copy(A),R.sub(T),R.multiplyScalar(.5),I.copy(k),I.sub(P),I.multiplyScalar(.5);var G=(1+2*o)*(1-o)*(1-o)*C.x+o*(1-o)*(1-o)*R.x+o*o*(3-2*o)*L.x+o*o*(o-1)*I.x,D=(1+2*o)*(1-o)*(1-o)*C.y+o*(1-o)*(1-o)*R.y+o*o*(3-2*o)*L.y+o*o*(o-1)*I.y,N=(1+2*o)*(1-o)*(1-o)*C.z+o*(1-o)*(1-o)*R.z+o*o*(3-2*o)*L.z+o*o*(o-1)*I.z,_=new ce.Vector3(S.get(m).get(3),S.get(m).get(4),S.get(m).get(5)),z=new ce.Vector3(S.get(g).get(3),S.get(g).get(4),S.get(g).get(5)),F=_.angleTo(z),Z=new ce.Vector3;Z.crossVectors(_,z),Z.normalize();var V=new ce.Vector3;V.copy(_),V.applyAxisAngle(Z,F*o),s=G,c=D,l=N,u=V.x,d=V.y,h=V.z;var B=e.get("xform"),H=e.get("step"),U=e.get("toolOffsetZ"),X=H===$e?e.get("editingOffsetZ"):e.get("previewingOffsetZ"),Y=Ui({posx:s,posy:c,posz:l,dirx:u,diry:d,dirz:h,toolOffsetZ:U,offsetZ:X,xform:B});return e.withMutations(function(e){O>=x&&e.set("paused",!0),e.set("time",O),e.set("joints",Y),e.set("activePoint",i)})}),Object(ut.a)(ei,V.alignerState.setTimeWithPercentage,function(e,t){var n,a,r,i,o,s,c,l,u,d,h,p,m,g,f,v,b=e.get("points"),M=e.get("times"),S=M.last(),y=Math.min(t.payload/100*S,S),x=e.get("closePath");if(y>=S)n=1;else if(0===y)n=0;else{a=0,r=M.size-1;for(var O=Math.floor(M.size/2);a+1<r;)M.get(O)>y?r=O:a=O,O=Math.floor(.5*(a+r));n=(a+(y-M.get(a))/(M.get(r)-M.get(a)))/(M.size-1)}x?(s=(i=b.size)*n-(o=Math.floor(i*n)),o>=b.size&&(o=0)):s=(i=b.size-1)*n-(o=Math.floor(i*n)),x?(v=((f=((g=o)+1)%i)+1)%i,m=(g+i-1)%i):((g=o)>=i&&(g=i),(f=g+1)>=i&&(f=i),(v=f+1)>=i&&(v=i),(m=g-1)<0&&(m=0));var w=new ce.Vector3(b.get(m).get(0),b.get(m).get(1),b.get(m).get(2)),j=new ce.Vector3(b.get(g).get(0),b.get(g).get(1),b.get(g).get(2)),E=new ce.Vector3(b.get(f).get(0),b.get(f).get(1),b.get(f).get(2)),T=new ce.Vector3(b.get(v).get(0),b.get(v).get(1),b.get(v).get(2)),P=new ce.Vector3,A=new ce.Vector3,k=new ce.Vector3,C=new ce.Vector3;P.copy(j),A.copy(E);k.copy(E),k.sub(w),k.multiplyScalar(.5),C.copy(T),C.sub(j),C.multiplyScalar(.5);var L=(1+2*s)*(1-s)*(1-s)*P.x+s*(1-s)*(1-s)*k.x+s*s*(3-2*s)*A.x+s*s*(s-1)*C.x,R=(1+2*s)*(1-s)*(1-s)*P.y+s*(1-s)*(1-s)*k.y+s*s*(3-2*s)*A.y+s*s*(s-1)*C.y,I=(1+2*s)*(1-s)*(1-s)*P.z+s*(1-s)*(1-s)*k.z+s*s*(3-2*s)*A.z+s*s*(s-1)*C.z,G=new ce.Vector3(b.get(g).get(3),b.get(g).get(4),b.get(g).get(5)),D=new ce.Vector3(b.get(f).get(3),b.get(f).get(4),b.get(f).get(5)),N=G.angleTo(D),_=new ce.Vector3;_.crossVectors(G,D),_.normalize();var z=new ce.Vector3;z.copy(G),z.applyAxisAngle(_,N*s),c=L,l=R,u=I,d=z.x,h=z.y,p=z.z;var F=e.get("xform"),Z=e.get("step"),V=e.get("toolOffsetZ"),B=Z===$e?e.get("editingOffsetZ"):e.get("previewingOffsetZ"),H=Ui({posx:c,posy:l,posz:u,dirx:d,diry:h,dirz:p,toolOffsetZ:V,offsetZ:B,xform:F});return e.withMutations(function(e){y>=S&&e.set("paused",!0),e.set("time",y),e.set("joints",H),e.set("activePoint",o)})}),Object(ut.a)(ei,V.alignerState.setTimeMultiplier,function(e,t){return e.set("timeMultiplier",t.payload)}),Object(ut.a)(ei,V.alignerState.closePath,function(e,t){return e.set("closePath",!0).set("pointsNeedSaving",!0)}),Object(ut.a)(ei,V.alignerState.setDragModelStartPoint,function(e,t){var n=t.payload,a=n.x,r=n.z;return e.withMutations(function(e){e.set("dragModelStartX",a),e.set("dragModelStartZ",r)})}),Object(ut.a)(ei,V.alignerState.setModelPosition,function(e,t){var n=t.payload,a=n.x,r=n.y,i=n.z,o=e.get("xform").withMutations(function(e){e.set("tx",a),e.set("ty",r),e.set("tz",i)});return e.set("xform",o).set("xformNeedsSaving",!0)}),Object(ut.a)(ei,V.alignerState.setModelOrientation,function(e,t){var n=t.payload,a=n.x,r=n.y,i=n.z,o=e.get("xform");return e.set("xform",o.withMutations(function(e){e.set("rx",a),e.set("rz",r),e.set("rz",i)})).set("xformNeedsSaving",!0)}),Object(ut.a)(ei,V.alignerState.dragModel,function(e,t){var n=t.payload,a=n.x,r=n.z,i=e.get("dragModelStartX"),o=e.get("dragModelStartZ"),s=a-i,c=r-o,l=e.get("xform");return e.withMutations(function(e){e.set("xform",l.withMutations(function(e){e.set("tx",e.get("tx")+s),e.set("tz",e.get("tz")+c)})),e.set("dragModelStartX",a),e.set("dragModelStartZ",r),e.set("xformNeedsSaving",!0)})}),Object(ut.a)(ei,V.alignerState.setHighlightModel,function(e,t){return e.set("highlightModel",!!t.payload)}),Object(ut.a)(ei,V.alignerState.resetState,function(e,t){return e.merge(Yi)}),Object(ut.a)(ei,V.alignerState.setDimensions,function(e,t){var n=t.payload,a=n.width,r=n.height;return e.set("width",a).set("height",r)}),Object(ut.a)(ei,V.alignerState.startRotatingMachine,function(e,t){var n=t.payload,a=n.x,r=n.y;return e.set("rotateStartX",a).set("rotateStartY",r).set("machineRotating",!0)}),Object(ut.a)(ei,V.alignerState.stopRotatingMachine,function(e,t){return e.set("machineRotating",!1)}),Object(ut.a)(ei,V.alignerState.rotateMachine,function(e,t){var n=t.payload,a=n.x,r=n.y;if(e.get("machineRotating")){var i,o=e.get("rotateStartX"),s=e.get("rotateStartY"),c=e.get("width"),l=e.get("height"),u=a/c*2-1-(o/c*2-1),d=r/l*2-1-(s/l*2-1),h=e.get("joints").get(3)+300*d,p=e.get("joints").get(4)+300*u,m=e.get("points"),g=m,f=!1;if(m.size>0){var v=e.get("activePoint"),b=m.get(v),M=e.get("step"),S=e.get("toolOffsetZ"),y=M===$e?e.get("editingOffsetZ"):e.get("previewingOffsetZ"),x=e.get("xform"),O=new ce.Vector3(b.get(0),b.get(1),b.get(2)),w=new ce.Matrix4;w.makeRotationFromEuler(new ce.Euler(x.get("rx")/180*Math.PI,x.get("ry")/180*Math.PI,x.get("rz")/180*Math.PI)),w.multiplyScalar(x.get("s")),w.setPosition(new ce.Vector3(x.get("tx"),x.get("ty"),x.get("tz"))),O.applyMatrix4(w),i=(i=Zt(ht.a.Map({A:h,B:p,X:O.x/25.4,Y:O.y/25.4,Z:O.z/25.4}),S)).set(2,i.get(2)+y);var j=new ce.Matrix4;j.getInverse(w);var E=new ce.Vector4(-Math.sin(p*Math.PI/180),Math.sin(h*Math.PI/180),Math.cos(p*Math.PI/180),0);E.applyMatrix4(j),E.normalize(),g=m.set(v,b.set(3,E.x).set(4,E.y).set(5,E.z)),f=!0}else i=e.get("joints").set(3,h).set(4,p);return e.set("joints",i).set("rotateStartX",a).set("rotateStartY",r).set("points",g).set("pointsNeedSaving",f)}return e}),Object(ut.a)(ei,V.alignerState.pointsSaved,function(e,t){return e.set("pointsNeedSaving",!1)}),Object(ut.a)(ei,V.alignerState.transformSaved,function(e,t){return e.set("xformNeedsSaving",!1)}),Object(ut.a)(ei,V.alignerState.nextPoint,function(e,t){var n=e.get("points"),a=e.get("times"),r=(e.get("activePoint")+1)%n.size,i=n.get(r),o=e.get("step"),s=e.get("toolOffsetZ"),c=o===$e?e.get("editingOffsetZ"):e.get("previewingOffsetZ"),l=e.get("xform"),u=Ui({posx:i.get(0),posy:i.get(1),posz:i.get(2),dirx:i.get(3),diry:i.get(4),dirz:i.get(5),toolOffsetZ:s,offsetZ:c,xform:l});return e.set("activePoint",r).set("joints",u).set("time",a.get(r))}),Object(ut.a)(ei,V.alignerState.prevPoint,function(e,t){var n=e.get("times"),a=e.get("points"),r=e.get("closePath"),i=e.get("time"),o=e.get("activePoint");n.get(o)===i&&(o=r?(o-1+a.size)%a.size:Math.max(o-1,0));var s=n.get(o),c=a.get(o),l=e.get("step"),u=e.get("toolOffsetZ"),d=l===$e?e.get("editingOffsetZ"):e.get("previewingOffsetZ"),h=e.get("xform"),p=Ui({posx:c.get(0),posy:c.get(1),posz:c.get(2),dirx:c.get(3),diry:c.get(4),dirz:c.get(5),toolOffsetZ:u,offsetZ:d,xform:h});return e.set("activePoint",o).set("joints",p).set("time",s)}),Object(ut.a)(ei,V.alignerState.setActivePoint,function(e,t){var n=t.payload,a=e.get("points"),r=.5*a.size,i=a.get(n),o=e.get("closePath"),s=e.get("step"),c=e.get("toolOffsetZ"),l=s===$e?e.get("editingOffsetZ"):e.get("previewingOffsetZ"),u=e.get("xform"),d=Ui({posx:i.get(0),posy:i.get(1),posz:i.get(2),dirx:i.get(3),diry:i.get(4),dirz:i.get(5),toolOffsetZ:c,offsetZ:l,xform:u});return e.set("activePoint",n).set("joints",d).set("time",r*n/(o?a.size:a.size-1))}),Object(ut.a)(ei,V.alignerState.setHighlightedPoint,function(e,t){return e.set("highlightedPoint",t.payload)}),Object(ut.a)(ei,V.alignerState.updatePointPosition,function(e,t){var n=t.payload,a=n.posx,r=n.posy,i=n.posz,o=e.get("points"),s=e.get("activePoint"),c=o.get(s);return e.set("points",o.set(s,c.withMutations(function(e){e.set(0,a),e.set(1,r),e.set(2,i)}))).set("pointsNeedSaving",!0)}),Object(ut.a)(ei,V.alignerState.deletePoint,function(e,t){var n=e.get("activePoint"),a=e.get("points");if(a.size>0){var r=e.get("closePath"),i=e.set("points",a.delete(n)).set("activePoint",1===a.size?-1:0===n?r?Math.max(a.size-2,0):0:n-1),o=i.get("activePoint");if(o>-1){var s=i.get("points").get(o),c=e.get("step"),l=e.get("toolOffsetZ"),u=c===$e?e.get("editingOffsetZ"):e.get("previewingOffsetZ"),d=e.get("xform"),h=Ui({posx:s.get(0),posy:s.get(1),posz:s.get(2),dirx:s.get(3),diry:s.get(4),dirz:s.get(5),toolOffsetZ:l,xform:d,offsetZ:u});return i.set("joints",h)}return i.set("joints",Xi.get("joints"))}return e}),Object(ut.a)(ei,V.alignerState.addPoint,function(e,t){var n=t.payload,a=n.posx,r=n.posy,i=n.posz,o=n.dirx,s=n.diry,c=n.dirz,l=e.get("step"),u=e.get("toolOffsetZ"),d=l===$e?e.get("editingOffsetZ"):e.get("previewingOffsetZ"),h=e.get("xform"),p=Ui(Object(M.a)({},t.payload,{toolOffsetZ:u,offsetZ:d,xform:h})),m=e.get("activePoint"),g=e.get("points");return e.set("points",g.insert(m+1,ht.a.List([a,r,i,o,s,c]))).set("activePoint",m+1).set("joints",p).set("pointsNeedSaving",!0)}),Object(ut.a)(ei,V.alignerState.showGhostSphere,function(e,t){return e.set("showGhostSphere",!0)}),Object(ut.a)(ei,V.alignerState.hideGhostSphere,function(e,t){return e.set("showGhostSphere",!1)}),Object(ut.a)(ei,V.alignerState.setGhostSpherePosition,function(e,t){return e.set("ghostSpherePosition",e.get("ghostSpherePosition").withMutations(function(e){return e.set("x",t.payload.x).set("y",t.payload.y).set("z",t.payload.z)}))}),Object(ut.a)(ei,V.alignerState.setGhostSphereOpacity,function(e,t){return e.set("ghostSphereOpacity",t.payload)}),Object(ut.a)(ei,V.alignerState.setJoints,function(e,t){return e.set("joints",ht.a.List(t.payload))}),Object(ut.a)(ei,V.alignerState.setRfid,function(e,t){return e.set("rfid",t.payload)}),Object(ut.a)(ei,V.alignerState.setStep,function(e,t){var n=t.payload,a=e.set("step",n);if(e.get("points").size>0){var r=e.get("activePoint"),i=e.get("points").get(r),o=e.get("toolOffsetZ"),s=n===$e?e.get("editingOffsetZ"):e.get("previewingOffsetZ"),c=e.get("xform"),l=Ui({posx:i.get(0),posy:i.get(1),posz:i.get(2),dirx:i.get(3),diry:i.get(4),dirz:i.get(5),xform:c,toolOffsetZ:o,offsetZ:s});a=a.set("joints",l)}else a=a.set("joints",Xi.get("joints"));return a}),Object(ut.a)(ei,V.alignerState.modelLoaded,function(e,t){return e.set("modelLoaded",!0)}),Object(ut.a)(ei,V.alignerState.modelUploaded,function(e,t){return e.set("modelUploaded",!0)}),Object(ut.a)(ei,V.alignerState.finalizeModel,function(e,t){return e.set("modelFinalized",!0)}),Object(ut.a)(ei,V.alignerState.finalizeModelClick,function(e,t){return e.set("finalizeModelClicked",!0)}),Object(ut.a)(ei,V.alignerState.clearFinalizeModelClick,function(e,t){return e.set("finalizeModelClicked",!1)}),Object(ut.a)(ei,V.alignerState.finishedProcessing,function(e,t){return e.set("finishedProcessingModel",!0)}),Object(ut.a)(ei,V.alignerState.importedTransformAndPoints,function(e,t){return e.withMutations(function(e){e.set("points",ht.a.List(t.payload.points.points.map(function(e){return ht.a.List(e)}))),t.payload.points.points.length>0&&e.set("activePoint",0),e.set("closePath",t.payload.points.closed),e.set("xform",ht.a.Map(t.payload.xform))})}),Object(ut.a)(ei,V.alignerState.importTransformAndPoints,function(e,t){return e.set("loading",e.get("loading").set("waitingForScannerToScanRFIDToImport",ht.a.Map({label:"Please scan RFID to import...",variant:"indeterminate"})))}),Object(ut.a)(ei,V.alignerState.cancelImportTransformAndPoints,function(e,t){return e.set("loading",e.get("loading").delete("waitingForScannerToScanRFIDToImport"))}),Object(ut.a)(ei,V.alignerState.loading,function(e,t){var n=t.payload,a=n.id,r=n.label,i=n.variant,o=n.progress;return e.set("loading",e.get("loading").set(a,ht.a.Map({label:r,variant:i,progress:o})))}),Object(ut.a)(ei,V.alignerState.loadingProgress,function(e,t){var n=t.payload,a=n.id,r=n.progress,i=e.get("loading"),o=i.get(a);return e.set("loading",i.set(a,o.set("progress",r)))}),Object(ut.a)(ei,V.alignerState.stopLoading,function(e,t){var n=t.payload.id,a=e.get("loading");return e.set("loading",a.delete(n))}),Object(ut.a)(ei,V.alignerState.rotateCW,function(e,t){var n=e.get("xform"),a=new ce.Matrix4;a.makeRotationFromEuler(new ce.Euler(n.get("rx")/180*Math.PI,n.get("ry")/180*Math.PI,n.get("rz")/180*Math.PI)),a.setPosition(new ce.Vector3(n.get("tx"),n.get("ty"),n.get("tz")));var r=new ce.Matrix4;r.makeRotationY(-Math.PI/2),a.premultiply(r);var i=new ce.Euler;i.setFromRotationMatrix(a);var o=new ce.Vector3;return o.setFromMatrixPosition(a),e.set("xform",ht.a.Map({s:n.get("s"),rx:180*i.x/Math.PI,ry:180*i.y/Math.PI,rz:180*i.z/Math.PI,tx:o.x,ty:o.y,tz:o.z})).set("xformNeedsSaving",!0)}),Object(ut.a)(ei,V.alignerState.rotateCCW,function(e,t){var n=e.get("xform"),a=new ce.Matrix4;a.makeRotationFromEuler(new ce.Euler(n.get("rx")/180*Math.PI,n.get("ry")/180*Math.PI,n.get("rz")/180*Math.PI)),a.setPosition(new ce.Vector3(n.get("tx"),n.get("ty"),n.get("tz")));var r=new ce.Matrix4;r.makeRotationY(Math.PI/2),a.premultiply(r);var i=new ce.Euler;i.setFromRotationMatrix(a);var o=new ce.Vector3;return o.setFromMatrixPosition(a),e.set("xform",ht.a.Map({s:n.get("s"),rx:180*i.x/Math.PI,ry:180*i.y/Math.PI,rz:180*i.z/Math.PI,tx:o.x,ty:o.y,tz:o.z})).set("xformNeedsSaving",!0)}),Object(ut.a)(ei,V.alignerState.alignerStatusResponse,function(e,t){var n=t.payload,a=n.model,r=n.xform,i=n.finalized,o=n.processing,s=n.processedModel,c=n.points;return e.withMutations(function(e){if(e.set("modelFinalized",i),e.set("finalizeModelClicked",i),e.set("modelLoaded",!1),e.set("modelUploaded",!!a),e.set("processingModel",o),e.set("finishedProcessingModel",s),r?e.set("xform",ht.a.Map(r)):e.set("xform",Xi.get("xform")),c){var t=ht.a.List(c.points.map(function(e){return ht.a.List(e)}));if(e.set("closePath",c.closed),e.set("points",t),t.size>0){e.set("activePoint",t.size-1);var n=t.get(0),l=e.get("toolOffsetZ"),u=e.get("previewingOffsetZ"),d=e.get("xform"),h=Ui({posx:n.get(0),posy:n.get(1),posz:n.get(2),dirx:n.get(3),diry:n.get(4),dirz:n.get(5),toolOffsetZ:l,xform:d,offsetZ:u});e.set("joints",h)}else e.set("activePoint",-1);e.set("highlightedPoint",-1)}else e.set("points",ht.a.List([])),e.set("activePoint",-1),e.set("highlightedPoint",-1)})}),Object(ut.a)(ei,V.rfid.connectedScanner,function(e,t){return e.set("scannersDetected",e.get("scannersDetected")+1)}),Object(ut.a)(ei,V.rfid.disconnectedScanner,function(e,t){return e.set("scannersDetected",e.get("scannersDetected")-1)}),Object(ut.a)(ei,V.rfid.receivedRfidScanMessage,function(e,t){var n=t.payload,a=n.rfid,r=n.label,i=n.scannerKey;return e.get("loading").get("waitingForScannerToScanRFIDToImport")?e:e.withMutations(function(e){e.set("rfid",a),e.set("label",r),e.set("scannerKey",i)})}),ei),Xi),Ki=Object(oi.combineReducers)({machineState:Di,alignerState:Wi,interpreter:zi,ui:Hi,viewer3D:Fi}),Ji=Object(si.a)(Ki,function(e,t){return e.set("machineState",(n=e,Object(S.c)(Object(ut.a)({},Object(S.a)(V.interpreter.previousLine,V.interpreter.nextLine,V.interpreter.incrementTime,V.interpreter.setCurrentLineWithPercentage,V.interpreter.setCurrentLineWithTime,V.interpreter.setCurrentLine),function(e,t){var a=n.get("interpreter").get("currentLine"),r=a-1,i=n.get("interpreter").get("linesPerIndex"),o=n.get("interpreter").get("states").size;if(o>0){var s=Math.min(Math.floor(r/i),o-1),c=s<0?n.get("interpreter").get("initialState"):n.get("interpreter").get("states").get(s),l=Math.max(s*i,-1),u=c,d=n.get("interpreter").get("lines"),h=null,p=null,m=Math.min(Math.floor(a/i),o-1);if(r>l||m*i!==a){h=new Ii({machineState:u});for(var g=l;g<=r;)u=h.interpret(d[g]),g++}p=m*i===a?n.get("interpreter").get("states").get(m):h.interpret(d[a]);var f=en[p.get("machine")],v=u.get("joints"),b=f.kinematics.forwardKinematics(p.set("joints",v)),M=p.get("motion").get("position"),S=n.get("interpreter").get("times"),y=r<0?0:S.get(r),x=S.get(a),O=n.get("interpreter").get("currentTime"),w=1;x-y>0&&(w=(O-y)/(x-y));var j=p.get("motion").get("mode"),E=p.get("motion").get("turns"),T=p.get("planeSelect"),P=mi(j,b,M,w,T,E),A=p.set("motion",p.get("motion").set("position",P)),k=f.kinematics.inverseKinematics(A);return A.set("joints",k)}return e}),n.get("machineState")))(e.get("machineState"),t));var n}),qi=n(8),$i=n.n(qi),Qi=n(2),eo=$i.a.mark(oo),to=$i.a.mark(so),no=te(),ao=60,ro=3;function io(e,t,n,a,r,i){return new Promise(function(o){return setTimeout(function(){for(var s,c=[],l=[],u=[],d=[],h=e.getState(),p=0;p<a&&n<t.length;p++){s=e.interpret(t[n]),e.messages.length>0&&e.messages.forEach(function(e){return function(t){d.push(Dt(t,e))}}(n));var m=en[s.get("machine")],g=h.get("joints"),f=s.get("joints"),v=h.get("motion").get("position"),b=s.get("motion").get("position");if(s.get("motion").get("issuedMotionCommand")){var M=s.get("motion").get("turns"),S=s.get("motion").get("mode"),y=s.get("planeSelect"),x=s.get("units"),O=0,w=s.get("feedRate"),j=s.get("feedRateMode");if(j!==De&&x===We&&(w/=25.4),S!==li)if(j===De)w<nt?d.push(Dt(Gt(),n)):O=1/w*ao;else if(j===Ne)if(S===ui)if(w<nt)d.push(Dt(Gt(),n));else{for(var E=0,T=0;T<ro;T++){var P=Math.abs(f.get(T)-g.get(T));E=Math.max(E,P),O=Math.max(O,P/w*ao)}if(E>-nt&&E<nt)for(var A=3;A<g.size;A++){var k=Math.abs(f.get(A)-g.get(A));O=Math.max(O,k/w*ao)}}else if(S===di||S===hi){if(w<nt)d.push(Dt(Gt(),n));else O=pi(v,b,y,S,M)/w*ao}else O=0;else O=3;for(var C=m.limits.velocities,L=m.limits.accelerations,R=0,I=3;I<g.size;I++){var G=Math.abs(f.get(I)-g.get(I));R=Math.max(G,R)}for(var D=0;D<g.size;D++){var N=C[D]*C[D]/(.5*L[D]),_=Math.abs(f.get(D)-g.get(D)),z=0;z=R<nt&&R>-nt?_/C[D]:_>=N?Math.max(_-N)/C[D]+2*C[D]/(.5*L[D]):2*Math.sqrt(_/L[D]),O=Math.max(O,z)}i+=O;var F=g,Z=f,V=s,B=m.kinematics.forwardKinematics(V.set("joints",F)),H=V.get("motion").get("position"),U=V.get("kinematicsMode"),X=Math.abs(Z.get(3)-F.get(3)),Y=Math.abs(Z.get(4)-F.get(4));if((X>nt||Y>nt)&&U!==ze||S!==li&&S!==ui){var W=40,K=!0,J=[];if(S!==li&&S!==ui||!(Y>-nt||X>-nt)){if(S===di||S===hi){var q=pi(v,b,y,S,M);W=Math.max(Math.ceil(q/.1),5)}}else{var $=Math.max(Z.get(0),F.get(0)),Q=Math.max(Z.get(1),F.get(1)),ee=Math.max(6-Z.get(2),6-F.get(2)),te=Math.sqrt($*$+ee*ee),ne=Math.sqrt(Q*Q+ee*ee),ae=X*Math.PI/180*ne,re=Y*Math.PI/180*te;W=Math.max(Math.ceil(re/.1),Math.ceil(ae/.1),5)}for(;K;){for(var ie=0,oe=void 0,se=0;se<W;se++){var ce=se/(W-1),le=i-O+ce*O,he=void 0;he=0===ce?.01/O:-.01/O;var pe=s.get("motion").get("turns"),me=mi(S,B,H,ce,y,pe),ge=mi(S,B,H,ce+he,y,pe),fe=m.kinematics.inverseKinematics(V.set("motion",V.get("motion").set("position",me))),ve=m.kinematics.inverseKinematics(V.set("motion",V.get("motion").set("position",ge))),be=m.workPieceSpace(fe,_a(V).get("Z")),Me=m.toolOrientation(fe),Se=m.workPieceSpace(ve,_a(V).get("Z")),ye=[be.get("X"),be.get("Y"),be.get("Z")],xe=[Se.get("X"),Se.get("Y"),Se.get("Z")],Oe=[Me.get("X"),Me.get("Y"),Me.get("Z")],we=void 0;if(he>0){var je=xe[0]-ye[0],Ee=xe[1]-ye[1],Te=xe[2]-ye[2];we=Math.sqrt(je*je+Ee*Ee+Te*Te)/.01}else{var Pe=ye[0]-xe[0],Ae=ye[1]-xe[1],ke=ye[2]-xe[2];we=Math.sqrt(Pe*Pe+Ae*Ae+ke*ke)/.01}if(S===li?J.push({position:ye,color:ue,speed:we,time:le,line:n,normal:Oe}):J.push({position:ye,color:de,speed:we,time:le,line:n,normal:Oe}),se>0){var Ce=ye[0]-oe[0],Le=ye[1]-oe[1],Re=ye[2]-oe[2],Ie=Math.sqrt(Ce*Ce+Le*Le+Re*Re);ie=Math.max(ie,Ie)}oe=ye}ie>1.5*.1?(W=Math.ceil(W*ie/.1),J=[]):K=!1}for(var Ge=0;Ge<J.length;Ge++)u.push(J[Ge])}else{var _e=_a(h).get("Z"),Fe=_a(s).get("Z"),Ze=m.workPieceSpace(g,_e),Ve=m.workPieceSpace(f,Fe),Be=m.toolOrientation(g),He=m.toolOrientation(f),Ue=Be.get("X"),Xe=Be.get("Y"),Ye=Be.get("Z"),Ke=He.get("X"),Je=He.get("Y"),qe=He.get("Z"),$e=Ze.get("X"),Qe=Ze.get("Y"),et=Ze.get("Z"),tt=Ve.get("X"),at=Ve.get("Y"),rt=Ve.get("Z"),it=tt-$e,ot=at-Qe,st=rt-et,ct=Math.sqrt(it*it+ot*ot+st*st)/O;switch(S){case li:u.push({position:[$e,Qe,et],color:ue,speed:ct,time:i-O,line:n,normal:[Ue,Xe,Ye]}),u.push({position:[tt,at,rt],color:ue,speed:ct,time:i,line:n,normal:[Ke,Je,qe]});break;case ui:u.push({position:[$e,Qe,et],color:de,speed:ct,time:i-O,line:n,normal:[Ue,Xe,Ye]}),u.push({position:[tt,at,rt],color:de,speed:ct,time:i,line:n,normal:[Ke,Je,qe]});break;default:console.error("shouldn't get here")}}}l.push(i),n%r===0&&c.push(s),h=s,n++}o({line:n,states:c,times:l,points:u,messages:d})})})}function oo(e){var t,n,a,r,i,o,s,c,l,u,d,h,p,m,g,f,v,b,M,S,y,x,O;return $i.a.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return t=J()(),w.next=3,Object(Qi.e)(V.interpreter.startProcessing());case 3:return w.next=5,Object(Qi.f)(Ia);case 5:return n=w.sent,w.next=8,Object(Qi.f)(Ga);case 8:return a=w.sent,w.next=11,Object(Qi.f)(Da);case 11:return r=w.sent,i=new Ii({machineState:n}),w.next=15,Object(Qi.e)(V.interpreter.setInitialState(n));case 15:o=pe.getInstance(),s=10,c=12,l=240,u=10,d=200,o.clear(),h=0,p=0,m=[],g=[],f=[];case 27:if(!(p<a.length)){w.next=54;break}return S=J()(),w.next=31,Object(Qi.b)(io,i,a,p,s,r,h);case 31:if(y=w.sent,x=J()(),s=document.hasFocus()?Math.max(Math.floor(s*c/(x-S)),u):Math.max(Math.floor(s*l/(x-S)),u),(v=g).push.apply(v,Object(W.a)(y.times)),(b=f).push.apply(b,Object(W.a)(y.states)),(M=m).push.apply(M,Object(W.a)(y.messages)),h=y.times[y.times.length-1],p=y.line,o.addPoints(y.points),!(g.length>=d||p>=a.length)){w.next=52;break}return w.next=43,Object(Qi.e)(V.interpreter.appendIndices(f));case 43:return w.next=45,Object(Qi.e)(V.interpreter.appendTimes(g));case 45:return w.next=47,Object(Qi.e)(V.interpreter.appendMessages(m));case 47:return w.next=49,Object(Qi.e)(V.interpreter.setProcessingProgress(p/a.length*100));case 49:f=[],g=[],m=[];case 52:w.next=27;break;case 54:return w.next=56,Object(Qi.e)(V.interpreter.endProcessing());case 56:if(e.preview){w.next=67;break}return no.timing("interpreter","parsed gcode",Math.round(J()()-t)),w.next=60,Object(Qi.f)(Na);case 60:return O=w.sent,no.event("interpreter","calculated approximate run time","calculated approximate run time",Math.round(1e3*O)),w.next=64,Object(Qi.f)(Ta);case 64:w.sent.forEach(function(e){no.event("interpreter","unimplemented code "+e.code)}),no.send();case 67:case"end":return w.stop()}},eo)}function so(){return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Qi.i)(V.interpreter.setLines,oo);case 2:case"end":return e.stop()}},to)}var co=$i.a.mark(ho),lo=$i.a.mark(po);function uo(){return new Promise(function(e){return window.requestAnimationFrame(function(){e()})})}function ho(e){var t,n,a,r,i,o;return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=.016;case 1:return e.next=4,Object(Qi.f)(Ra);case 4:if(n=e.sent,a=n.get("running"),r=n.get("paused"),!a||r){e.next=17;break}return i=performance.now(),e.next=11,Object(Qi.b)(uo);case 11:return e.next=13,Object(Qi.e)(V.interpreter.incrementTime(t));case 13:o=performance.now(),t=(o-i)/1e3,e.next=18;break;case 17:return e.abrupt("break",20);case 18:e.next=1;break;case 20:case"end":return e.stop()}},co)}function po(){return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Qi.i)([V.interpreter.setLines,V.interpreter.pause,V.interpreter.unpause,V.interpreter.run,V.interpreter.nextLine,V.interpreter.previousLine,V.interpreter.setCurrentLineWithPercentage],ho);case 2:case"end":return e.stop()}},lo)}var mo=$i.a.mark(fo),go="%\nG20\nG90 G94 G40 G17\nG53 G0 Z0\nG0 A0 B0\nG0 X0\nM5\nM0\nT4 M6\nG43\nS8500 M3\nF20\n\nG0 A90\nG0 X1 Y1\nG1 Z0\nG1 X-1\nG1 y-1\nG1 X1\nG1 Y1\n\nG49\nG53 G0 Z0\n\nM5\nM30\n%\n";function fo(){return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Qi.e)(V.interpreter.setLines(go.split("\n")));case 2:case"end":return e.stop()}},mo)}var vo=$i.a.mark(Mo),bo=$i.a.mark(So);function Mo(e){var t;return $i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(e),t=ai.getInstance(),console.log(t.windows),t.sendMessage(e),void(n.next=6);case 6:case"end":return n.stop()}},vo)}function So(){return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Qi.h)(V.iframe.toRockhopper,Mo);case 2:case"end":return e.stop()}},bo)}var yo=$i.a.mark(Eo),xo=$i.a.mark(To),Oo=1e3,wo=function(e){return e.open().then(function(){return e.selectConfiguration(1)}).then(function(){return e.claimInterface(2)}).then(function(){return e.selectAlternateInterface(2,0)}).then(function(){return e.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:1,index:2})}).then(function(){return{device:e}}).catch(function(e){return{error:e}})},jo=function(e){return e.transferIn(5,64).then(function(e){return{data:(new TextDecoder).decode(e.data)}}).catch(function(e){return{error:e}})};function Eo(e,t){var n,a,r,i,o,s,c,l,u,d;return $i.a.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,Object(Qi.b)(wo,e);case 2:if(n=h.sent,!(a=n.device)){h.next=49;break}return h.next=7,Object(Qi.e)(V.rfid.connectedScanner());case 7:r="",i=!0;case 9:if(!i){h.next=47;break}return h.next=12,Object(Qi.b)(jo,a);case 12:if(o=h.sent,s=o.data,c=o.error,!s){h.next=40;break}if(!((l=(r+=s).indexOf("\r\n"))>-1)){h.next=38;break}if(u=r.slice(0,l),h.prev=20,!(d=JSON.parse(u)).error){h.next=27;break}return h.next=25,Object(Qi.e)(V.rfid.receivedErrorMessage(d));case 25:h.next=30;break;case 27:if(!d.rfid){h.next=30;break}return h.next=30,Object(Qi.e)(V.rfid.receivedRfidScanMessage(d));case 30:h.next=37;break;case 32:return h.prev=32,h.t0=h.catch(20),console.error(h.t0),h.next=37,Object(Qi.e)(V.rfid.receivedIncompleteMessage());case 37:r=r.slice(l+2);case 38:h.next=45;break;case 40:if(!c){h.next=45;break}return h.next=43,Object(Qi.e)(V.rfid.disconnectedScanner());case 43:t(a),i=!1;case 45:h.next=9;break;case 47:h.next=50;break;case 49:t(a);case 50:case"end":return h.stop()}},yo,null,[[20,32]])}function To(){var e;return $i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=!1;try{e=window.self!==window.top}catch(n){e=!0}if(e||!navigator.usb){t.next=6;break}return t.delegateYield($i.a.mark(function e(){var t,n,a;return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=function(e){var n=t.indexOf(e);n>-1&&t.splice(n,1)},a=$i.a.mark(function e(){var a,r;return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.usb.getDevices();case 2:return a=e.sent,r=[],a.forEach(function(e){t.includes(e)||(t.push(e),r.push(e))}),e.next=7,Object(Qi.a)(r.map(function(e){return Object(Qi.d)(Eo,e,n)}));case 7:return e.next=9,Object(Qi.c)(Oo);case 9:case"end":return e.stop()}},e)});case 3:return e.delegateYield(a(),"t0",5);case 5:e.next=3;break;case 7:case"end":return e.stop()}},e)})(),"t0",4);case 4:t.next=9;break;case 6:return console.log("blah2"),t.next=9,Object(Qi.c)(1e3);case 9:case"end":return t.stop()}},xo)}var Po=n(347),Ao=n.n(Po),ko=n(132),Co=n.n(ko),Lo=n(208),Ro=function(e,t,n){var a=new ne.Vector3(e[0],e[1],e[2]),r=new ne.Vector3(t[0],t[1],t[2]);a.multiplyScalar(1/25.4);var i=Math.asin(r.y),o=Math.atan2(-r.x,r.z),s=Math.cos(i),c=Math.sin(i),l=Math.cos(o),u=Math.sin(o),d=new ne.Vector3;return n?(d.x=a.x*l+a.z*u,d.y=a.x*u*c+a.y*s-a.z*l*c,d.z=-a.x*u*s+a.y*c+a.z*l*s):(d.x=a.x,d.y=a.y,d.z=a.z),{X:d.x,Y:d.y,Z:d.z,A:180*i/Math.PI,B:180*o/Math.PI}};function Io(e){for(var t=e.map(function(e){return[[e[0],e[1],e[2]],[e[3],e[4],e[5]]]}),n=[],a=new ne.Vector3,r=new ne.Vector3,i=new ne.Vector3,o=new ne.Vector3,s=new ne.Vector3,c=new ne.Vector3,l=new ne.Vector3(1,0,0),u=0;u<t.length;u++){i.set(t[u][0][0],t[u][0][1],t[u][0][2]),s.set(t[u][1][0],t[u][1][1],t[u][1][2]),u===t.length-1?(o.set(t[0][0][0],t[0][0][1],t[0][0][2]),c.set(t[0][1][0],t[0][1][1],t[0][1][2])):(o.set(t[u+1][0][0],t[u+1][0][1],t[u+1][0][2]),c.set(t[u+1][1][0],t[u+1][1][1],t[u+1][1][2])),s.normalize(),c.normalize();var d=s.angleTo(c);d>1e-5&&(l.crossVectors(s,c),l.normalize());var h=Ro([i.x,i.y,i.z],[s.x,s.y,s.z],!0),p=Ro([o.x,o.y,o.z],[c.x,c.y,c.z],!0),m=Math.abs(h.A-p.A),g=Math.abs(h.B-p.B);m>180&&(m=360-m),g>180&&(g=360-g);for(var f=Math.PI/180,v=Math.max(Math.ceil(d/f),2,Math.ceil(m),Math.ceil(g)),b=0;b<v;b++){var M=b/(v-1);a.lerpVectors(i,o,M),r.copy(s),r.applyAxisAngle(l,d*M),n.push([[a.x,a.y,a.z],[r.x,r.y,r.z]])}}var S=0,y=Ro(n[0][0],n[0][1],!0),x=[],O=y;return n.forEach(function(e){var t=Object(ki.a)(e,2),n=t[0],a=t[1],r=Ro(n,a,!0);r.Z<S&&(S=r.Z);var i=r.X-O.X,o=r.Y-O.Y,s=r.Z-O.Z,c=r.A-O.A,l=r.B-O.B;l>180?l-=360:l<-180&&(l+=360);var u={};Math.abs(i)>1e-5&&(u.X=i),Math.abs(o)>1e-5&&(u.Y=o),Math.abs(s)>1e-5&&(u.Z=s),Math.abs(c)>1e-5&&(u.A=c),Math.abs(l)>1e-5&&(u.B=l),Object.keys(u).length>0&&x.push(u),O=r}),x}var Go="https://rfid-rest.pocketnc.com/aligner";var Do=function(e){var t=e.rfid,n=e.size,a=e.apiKey;return fetch(Go+"/"+t+"/getUploadModelPost?size="+n,{headers:{"x-api-key":a}}).then(function(e){return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})},No=function(e){var t=e.rfid,n=e.apiKey;return fetch(Go+"/"+t+"/submitProcessModelJob",{method:"POST",headers:{"x-api-key":n}}).then(function(e){return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})},_o=function(e){var t=e.rfid,n=e.apiKey;return fetch(Go+"/"+t+"/getDownloadProcessedModelUrl",{method:"GET",headers:{"x-api-key":n}}).then(function(e){return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})},zo=function(e){var t=e.rfid,n=e.apiKey;return fetch(Go+"/"+t+"/getGCode",{method:"GET",headers:{"x-api-key":n}}).then(function(e){return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})},Fo=function(e){var t=e.rfid,n=e.apiKey;return fetch(Go+"/"+t+"/processedModelExists",{method:"GET",headers:{"x-api-key":n}}).then(function(e){return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})},Zo=function(e){var t=e.rfid,n=e.apiKey;return fetch(Go+"/"+t+"/getStatus",{method:"GET",headers:{"x-api-key":n}}).then(function(e){return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})},Vo=function(e){var t=e.rfid,n=e.apiKey;return fetch(Go+"/"+t+"/finalize",{method:"PUT",headers:{"x-api-key":n}}).then(function(e){return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})},Bo=function(e){var t=e.rfid,n=e.apiKey,a=e.points;return fetch(Go+"/"+t+"/savePoints",{method:"PUT",headers:{"x-api-key":n},body:JSON.stringify(a)}).then(function(e){return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})},Ho=function(e){var t=e.rfid,n=e.apiKey,a=e.rfidImport;return fetch(Go+"/"+t+"/importTransformAndPoints?rfidImport="+a,{method:"PUT",headers:{"x-api-key":n}}).then(function(e){return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})},Uo=function(e){var t=e.rfid,n=e.apiKey,a=e.xform;return fetch(Go+"/"+t+"/saveTransform",{method:"PUT",headers:{"x-api-key":n},body:JSON.stringify(a)}).then(function(e){return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})},Xo=function(e){var t=e.rfid,n=e.apiKey,a=e.label;return fetch(Go+"/"+t+"/createLabel?label="+a,{method:"PUT",headers:{"x-api-key":n}}).then(function(e){return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})},Yo=function(e){var t=e.rfid;return fetch(Go+"/"+t+"/getDemoKey",{headers:{}}).then(function(e){return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})},Wo=$i.a.mark(ls),Ko=$i.a.mark(us),Jo=$i.a.mark(ds),qo=$i.a.mark(hs),$o=$i.a.mark(ps),Qo=$i.a.mark(ms),es=$i.a.mark(gs),ts=$i.a.mark(fs),ns=$i.a.mark(vs),as=$i.a.mark(bs),rs=$i.a.mark(Ms),is=$i.a.mark(ys),os=$i.a.mark(xs),ss=$i.a.mark(Os),cs=$i.a.mark(ws);function ls(e,t,n){var a,r,i,o;return $i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:for(r in a=new FormData,e.fields)a.append(r,e.fields[r]);a.append("file",new File([new Blob([t])],"filename")),i=Object(ii.c)(function(t){var r;return Co()({url:e.url,method:"POST",data:a,cancelToken:new Co.a.CancelToken(function(e){return r=e}),onUploadProgress:function(e){t(n(e.loaded/e.total*100))}}).then(function(){t(ii.a)}).catch(function(e){console.error("upload error",e),t(ii.a)}),function(){return r()}}),s.prev=4;case 5:return s.next=8,Object(Qi.g)(i);case 8:return o=s.sent,s.next=11,Object(Qi.e)(o);case 11:s.next=5;break;case 13:return s.prev=13,s.finish(13);case 15:case"end":return s.stop()}},Wo,null,[[4,,13,15]])}function us(e,t){var n,a,r,i=arguments;return $i.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:n=i.length>2&&void 0!==i[2]?i[2]:"arraybuffer",a=Object(ii.c)(function(a){var r;return Co()({url:e,method:"GET",responseType:n,cancelToken:new Co.a.CancelToken(function(e){return r=e}),onDownloadProgress:function(e){a(t(e.loaded/e.total*100))}}).then(function(e){a(e.data),a(ii.a)}).catch(function(e){console.error("download error",e),a(ii.a)}),function(){return r()}}),o.prev=2;case 3:return o.next=6,Object(Qi.g)(a);case 6:if((r=o.sent).type!==t(0).type){o.next=12;break}return o.next=10,Object(Qi.e)(r);case 10:o.next=13;break;case 12:return o.abrupt("return",r);case 13:o.next=3;break;case 15:return o.prev=15,o.finish(15);case 17:case"end":return o.stop()}},Ko,null,[[2,,15,17]])}function ds(e){var t,n,a,r;return $i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:t=e.rfid,n=e.apiKey;case 1:return i.next=4,Object(Qi.b)(Fo,{rfid:t,apiKey:n});case 4:if(a=i.sent,r=a.data,a.error,!r.exists){i.next=12;break}return i.abrupt("break",16);case 12:return i.next=14,Object(Qi.c)(5e3);case 14:i.next=1;break;case 16:return i.next=18,Object(Qi.e)(V.alignerState.finishedProcessing());case 18:case"end":return i.stop()}},Jo)}function hs(e){var t,n,a,r,i,o,s,c;return $i.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=new Uint8Array(e.payload),l.next=3,Object(Qi.f)(La);case 3:if(n=l.sent,a=n.get("rfid"),r=t.byteLength,i=n.get("scannerKey"),!a||!i){l.next=29;break}return l.next=10,Object(Qi.e)(V.alignerState.loading("preparingToUploadModel","Preparing to upload model...","indeterminate"));case 10:return l.next=12,Object(Qi.b)(Do,{rfid:a,size:r,apiKey:i});case 12:return o=l.sent,s=o.data,c=o.error,l.next=17,Object(Qi.e)(V.alignerState.stopLoading("preparingToUploadModel"));case 17:if(!c){l.next=21;break}console.error(c),l.next=29;break;case 21:return l.next=23,Object(Qi.e)(V.alignerState.loading("uploadModel","Uploading model...","determinate",0));case 23:return l.next=25,Object(Qi.b)(ls,s.post,t,function(e){return V.alignerState.loadingProgress("uploadModel",e)});case 25:return l.next=27,Object(Qi.e)(V.alignerState.stopLoading("uploadModel"));case 27:return l.next=29,Object(Qi.e)(V.alignerState.modelUploaded());case 29:case"end":return l.stop()}},qo)}function ps(e){var t,n,a,r,i,o;return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Qi.f)(La);case 2:if(t=e.sent,n=t.get("rfid"),a=t.get("scannerKey"),!n||!a){e.next=45;break}case 6:return e.next=9,Object(Qi.f)(La);case 9:if(!e.sent.get("modelUploaded")){e.next=12;break}return e.abrupt("break",16);case 12:return e.next=14,Object(Qi.c)(1e3);case 14:e.next=6;break;case 16:return e.next=18,Object(Qi.e)(V.alignerState.loading("finalizing","Finalizing model...","indeterminate"));case 18:return e.next=20,Object(Qi.b)(Vo,{rfid:n,apiKey:a});case 20:return r=e.sent,e.next=23,Object(Qi.e)(V.alignerState.stopLoading("finalizing"));case 23:if(!r.error){e.next=30;break}return console.error("Error finalizing model",r.error),e.next=27,Object(Qi.e)(V.alignerState.clearFinalizeModelClick());case 27:return e.abrupt("return");case 30:return e.next=32,Object(Qi.e)(V.alignerState.finalizeModel());case 32:return e.next=34,Object(Qi.e)(V.alignerState.loading("processingModel","Processing model...","indeterminate"));case 34:return e.next=36,Object(Qi.b)(No,{rfid:n,apiKey:a});case 36:if(i=e.sent,o=i.data,i.error,!o.success){e.next=43;break}return e.next=43,Object(Qi.b)(ds,{rfid:n,apiKey:a});case 43:return e.next=45,Object(Qi.e)(V.alignerState.stopLoading("processingModel"));case 45:case"end":return e.stop()}},$o)}function ms(e){var t,n,a,r,i,o,s,c,l,u,d,h,p,m;return $i.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return t=e.payload,n=t.rfid,a=t.label,r=t.scannerKey,i=r,g.next=4,Object(Qi.f)(La);case 4:if(!(o=g.sent).get("loading").get("waitingForScannerToScanRFIDToImport")){g.next=22;break}return g.next=8,Object(Qi.e)(V.alignerState.stopLoading("waitingForScannerToScanRFIDToImport"));case 8:return g.next=10,Object(Qi.e)(V.alignerState.loading("importingTransformAndPoints","Importing model position and points...","indeterminate"));case 10:return g.next=12,Ho({rfid:o.get("rfid"),apiKey:i,rfidImport:n});case 12:return s=g.sent,c=s.data,(l=s.error)&&console.error(l),g.next=18,Object(Qi.e)(V.alignerState.stopLoading("importingTransformAndPoints"));case 18:return g.next=20,Object(Qi.e)(V.alignerState.importedTransformAndPoints(c));case 20:g.next=99;break;case 22:return g.next=24,Object(Qi.e)(V.alignerState.loading("getStatus","Verifying scanned ID...","indeterminate"));case 24:return g.next=26,Zo({rfid:n,apiKey:i});case 26:return u=g.sent,d=u.data,h=u.error,g.next=31,Object(Qi.e)(V.alignerState.stopLoading("getStatus"));case 31:if(!h){g.next=36;break}return console.error("Error fetching status",h),g.next=35,Object(Qi.e)(V.alignerState.resetState());case 35:return g.abrupt("return");case 36:return g.next=38,Object(Qi.e)(V.alignerState.alignerStatusResponse(d));case 38:if(!d.aligner){g.next=97;break}if(d.label){g.next=44;break}return g.next=42,Object(Qi.b)(Xo,{rfid:n,apiKey:i,label:a});case 42:g.sent.success;case 44:if(p=ot.getInstance(),!d.model){g.next=91;break}if(!(d.points&&d.points.length>0)){g.next=53;break}return g.next=49,Object(Qi.e)(V.viewer3D.parentCamera(Pe));case 49:return g.next=51,Object(Qi.e)(V.alignerState.setStep(Qe));case 51:g.next=55;break;case 53:return g.next=55,Object(Qi.e)(V.alignerState.setStep($e));case 55:return g.next=57,Object(Qi.e)(V.alignerState.loading("downloadModel","Downloading model...","determinate",0));case 57:return g.next=59,Object(Qi.b)(us,d.model,function(e){return V.alignerState.loadingProgress("downloadModel",e)},"arraybuffer");case 59:return m=g.sent,p.loadSTLModel(m),g.next=63,Object(Qi.e)(V.viewer3D.loadModel());case 63:return g.next=65,Object(Qi.e)(V.viewer3D.showModel());case 65:return g.next=67,Object(Qi.e)(V.alignerState.modelLoaded());case 67:return g.next=69,Object(Qi.e)(V.alignerState.stopLoading("downloadModel"));case 69:if(!d.finalized){g.next=87;break}if(!d.processing){g.next=79;break}return g.next=73,Object(Qi.e)(V.alignerState.loading("processingModel","Processing model...","indeterminate"));case 73:return g.next=75,Object(Qi.b)(ds,{rfid:n,apiKey:i});case 75:return g.next=77,Object(Qi.e)(V.alignerState.stopLoading("processingModel"));case 77:g.next=85;break;case 79:if(d.processedModel||console.error("model and transform are finalized, but don't have a processed model or a processing job"),!d.points||!d.points.closed){g.next=85;break}return g.next=83,Object(Qi.e)(V.viewer3D.parentCamera(Pe));case 83:return g.next=85,Object(Qi.e)(V.alignerState.setStep(Qe));case 85:g.next=89;break;case 87:return g.next=89,Object(Qi.e)(V.alignerState.setStep(qe));case 89:g.next=95;break;case 91:return g.next=93,Object(Qi.e)(V.viewer3D.parentCamera(Ae));case 93:return g.next=95,Object(Qi.e)(V.alignerState.setStep(Je));case 95:g.next=99;break;case 97:return g.next=99,Object(Qi.e)(V.alignerState.resetState());case 99:case"end":return g.stop()}},Qo)}function gs(e){var t,n,a,r,i,o,s;return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Qi.f)(La);case 2:return t=e.sent,n=t.get("rfid"),a=t.get("label"),r=t.get("scannerKey"),e.next=8,Object(Qi.e)(V.alignerState.loading("preparingToDownloadProcessedModel","Preparing to download processed model...","indeterminate"));case 8:return e.next=10,Object(Qi.b)(_o,{rfid:n,apiKey:r});case 10:return i=e.sent,o=i.data,i.error,e.next=16,Object(Qi.e)(V.alignerState.stopLoading("preparingToDownloadProcessedModel"));case 16:return e.next=18,Object(Qi.e)(V.alignerState.loading("downloadProcessedModel","Downloading processed model...","determinate",0));case 18:return e.next=20,Object(Qi.b)(us,o.url,function(e){return V.alignerState.loadingProgress("downloadProcessedModel",e)},"arraybuffer");case 20:return s=e.sent,e.next=23,Object(Qi.e)(V.alignerState.stopLoading("downloadProcessedModel"));case 23:return e.next=25,Object(Qi.b)(Lo.saveAs,new Blob([new Uint8Array(s)]),a+".stl");case 25:case"end":return e.stop()}},es)}function fs(e){var t,n,a,r,i,o,s;return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Qi.f)(La);case 2:return t=e.sent,n=t.get("rfid"),a=t.get("label"),r=t.get("scannerKey"),e.next=8,Object(Qi.e)(V.alignerState.loading("downloadGCode","Downloading G code...","indeterminate"));case 8:return e.next=10,Object(Qi.b)(zo,{rfid:n,apiKey:r});case 10:return i=e.sent,o=i.data,s=i.error,e.next=15,Object(Qi.e)(V.alignerState.stopLoading("downloadGCode"));case 15:if(!o.error&&!s){e.next=18;break}return console.error(o.error,s),e.abrupt("return");case 18:return e.next=20,Object(Qi.b)(Lo.saveAs,new Blob([o.gcode]),a+".ngc");case 20:case"end":return e.stop()}},ts)}function vs(e){var t,n,a,r,i,o,s;return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Qi.f)(La);case 2:if(t=e.sent,n=t.get("rfid"),a=t.get("scannerKey"),!n||!a){e.next=24;break}if(!t.get("pointsNeedSaving")){e.next=24;break}return r={points:t.get("points").toJS(),closed:t.get("closePath")},e.next=11,Object(Qi.e)(V.alignerState.loading("savingPoints","Saving points...","indeterminate"));case 11:return e.next=13,Object(Qi.b)(Bo,{rfid:n,apiKey:a,points:r});case 13:return i=e.sent,o=i.data,s=i.error,e.next=18,Object(Qi.e)(V.alignerState.stopLoading("savingPoints"));case 18:if(!s&&o.success){e.next=22;break}console.error("error saving points",s),e.next=24;break;case 22:return e.next=24,Object(Qi.e)(V.alignerState.pointsSaved());case 24:case"end":return e.stop()}},ns)}function bs(e){var t,n,a,r,i,o,s;return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Qi.f)(La);case 2:if(t=e.sent,n=t.get("rfid"),a=t.get("scannerKey"),!n||!a){e.next=24;break}if(!t.get("xformNeedsSaving")){e.next=24;break}return r={xform:t.get("xform").toJS()},e.next=11,Object(Qi.e)(V.alignerState.loading("savingTransform","Saving model position...","indeterminate"));case 11:return e.next=13,Object(Qi.b)(Uo,{rfid:n,apiKey:a,xform:r});case 13:return i=e.sent,o=i.data,s=i.error,e.next=18,Object(Qi.e)(V.alignerState.stopLoading("savingTransform"));case 18:if(!s&&o.success){e.next=22;break}console.error("error saving transform",s),e.next=24;break;case 22:return e.next=24,Object(Qi.e)(V.alignerState.transformSaved());case 24:case"end":return e.stop()}},as)}function Ms(e){var t,n,a,r,i,o,s,c,l;return $i.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(t=ge.getInstance(),n=pe.getInstance(),t.clear(),n.clear(),a=J()(),e.type!==V.alignerState.alignerStatusResponse().type){u.next=10;break}return u.next=8,Object(Qi.g)(V.alignerState.modelLoaded);case 8:return u.next=10,Object(Qi.c)(1e3);case 10:return u.next=12,Object(Qi.f)(La);case 12:if(r=u.sent,!(i=ot.getInstance()).parts.model){u.next=22;break}if(o=new ce.Vector3,s=new ce.Vector4,c=r.get("points").toJS(),l=c.length,300,!(l>0)){u.next=22;break}return u.delegateYield($i.a.mark(function e(){var n,u,d,h,p,m,g,f,v,b,M,S,y,x,O,w,j,E,T,P,A,k,C,L,R,I,G,D,N,_,z,F,Z,B,H,U,X,Y,W,K,q,$,Q,ee,te,ne,ae,re,ie,oe,se,le,ue,de,he,pe,me,ge,fe,ve,be,Me;return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=-.002,u=new ce.Vector3,d=new ce.Vector3,h=new ce.Vector3,p=new ce.Vector3,m=new ce.Vector3,g=new ce.Vector3,f=new ce.Vector3,v=new ce.Vector3,b=new ce.Vector3,M=new ce.Vector3,S=new ce.Vector3,y=new ce.Vector4,x=new ce.Vector3,O=new ce.Vector3,w=new ce.Vector3,j=new ce.Vector3,E=[],T=[],(P=new ce.Matrix4).getInverse(i.parts.bAxis.object.matrixWorld),A=0;case 22:if(!(A<300)){e.next=76;break}if(k=A/299,C=void 0,L=void 0,R=void 0,I=void 0,G=void 0,r.get("closePath")?(C=l*k-Math.floor(l*k),R=Math.floor(l*k)%l,G=((I=(R+1)%l)+1)%l,L=(R+l-1)%l):(C=(l-1)*k-Math.floor((l-1)*k),(R=Math.floor((l-1)*k))>=l&&(R=l-1),(I=R+1)>=l&&(I=l-1),(G=I+1)>=l&&(G=l-1),(L=R-1)<0&&(L=0)),u.set(c[L][0],c[L][1],c[L][2]),d.set(c[R][0],c[R][1],c[R][2]),h.set(c[I][0],c[I][1],c[I][2]),p.set(c[G][0],c[G][1],c[G][2]),f.copy(d),v.copy(h),.5,m.copy(h),m.sub(u),m.multiplyScalar(.5),g.copy(p),g.sub(d),g.multiplyScalar(.5),D=(1+2*C)*(1-C)*(1-C)*f.x+C*(1-C)*(1-C)*m.x+C*C*(3-2*C)*v.x+C*C*(C-1)*g.x,N=(1+2*C)*(1-C)*(1-C)*f.y+C*(1-C)*(1-C)*m.y+C*C*(3-2*C)*v.y+C*C*(C-1)*g.y,_=(1+2*C)*(1-C)*(1-C)*f.z+C*(1-C)*(1-C)*m.z+C*C*(3-2*C)*v.z+C*C*(C-1)*g.z,b.set(c[R][3],c[R][4],c[R][5]),M.set(c[I][3],c[I][4],c[I][5]),z=b.angleTo(M),x.crossVectors(b,M),x.normalize(),O.copy(b),O.applyAxisAngle(x,z*C),o.set(D,N,_),s.set(O.x,O.y,O.z,0),o.applyMatrix4(i.parts.model.object.matrixWorld),s.applyMatrix4(i.parts.model.object.matrixWorld),s.normalize(),w.set(o.x+5*s.x/25.4,o.y+5*s.y/25.4,o.z+5*s.z/25.4),j.set(-s.x,-s.y,-s.z),i.raycaster.set(w,j),T.length=0,T.length>0?(S.x=T[0].point.x-s.x*n,S.y=T[0].point.y-s.y*n,S.z=T[0].point.z-s.z*n):(S.x=o.x-s.x*n,S.y=o.y-s.y*n,S.z=o.z-s.z*n),y.set(s.x,s.y,s.z,0),y.applyMatrix4(P),S.applyMatrix4(P),E.push([S.x,S.y,S.z,y.x,y.y,y.z,R,C]),!(J()()-a>6)){e.next=73;break}return e.next=71,Object(Qi.c)(0);case 71:a=J()(),P.getInverse(i.parts.bAxis.object.matrixWorld);case 73:A++,e.next=22;break;case 76:for(F=r.get("closePath"),Z=F?l:l-1,B=[0],H=en[ye].limits.velocities,U=en[ye].limits.accelerations,X=0;X<Z;X++){for(Y=void 0,void 0,K=void 0,q=void 0,W=X,F?(Y=(W-1+l)%l,q=((K=(W+1)%l)+1)%l):(Y=Math.max(W-1,0),K=W+1,q=Math.min(K+1,l-1)),u.set(c[Y][0],c[Y][1],c[Y][2]),d.set(c[W][0],c[W][1],c[W][2]),h.set(c[K][0],c[K][1],c[K][2]),p.set(c[q][0],c[q][1],c[q][2]),f.copy(d),v.copy(h),.5,m.copy(h),m.sub(u),m.multiplyScalar(.5),g.copy(p),g.sub(d),g.multiplyScalar(.5),b.set(c[W][3],c[W][4],c[W][5]),M.set(c[K][3],c[K][4],c[K][5]),$=b.angleTo(M),x.crossVectors(b,M),x.normalize(),5,Q=[],ee=0;ee<5;ee++)ne=(1+2*(te=ee/4))*(1-te)*(1-te)*f.x+te*(1-te)*(1-te)*m.x+te*te*(3-2*te)*v.x+te*te*(te-1)*g.x,ae=(1+2*te)*(1-te)*(1-te)*f.y+te*(1-te)*(1-te)*m.y+te*te*(3-2*te)*v.y+te*te*(te-1)*g.y,re=(1+2*te)*(1-te)*(1-te)*f.z+te*(1-te)*(1-te)*m.z+te*te*(3-2*te)*v.z+te*te*(te-1)*g.z,O.copy(b),O.applyAxisAngle(x,$*te),o.set(ne,ae,re),s.set(O.x,O.y,O.z,0),o.applyMatrix4(i.parts.model.object.matrixWorld),s.applyMatrix4(i.parts.model.object.matrixWorld),s.normalize(),Q.push([25.4*o.x,25.4*o.y,25.4*o.z,s.x,s.y,s.z]);ie=Io(Q),oe=0,ie.forEach(function(e){var t={X:0,Y:1,Z:2,A:3,B:4},n={X:0,Y:1,Z:2},a=0;for(var r in{A:3,B:4})"undefined"!==typeof e[r]&&(a=Math.max(a,Math.abs(e[r])));var i=0;if(a<nt)for(var o in n)"undefined"!==typeof e[o]&&(i=Math.max(i,Math.abs(e[o])/H[n[o]]));else for(var s in t)"undefined"!==typeof e[s]&&(i=Math.max(i,.7*Math.sqrt(Math.abs(e[s])/U[t[s]])));oe+=i}),se=B[B.length-1],B.push(se+oe)}return e.next=84,Object(Qi.e)(V.alignerState.setTimes(B));case 84:le=new ce.Vector3,ue=new ce.Vector3,de=1/25.4,he=new ce.Vector3,(pe=new ce.Vector4).w=0,me=new ce.Vector3(1,0,0),ge=new ce.Vector3(0,1,0),fe=0;case 93:if(!(fe<E.length)){e.next=117;break}if(ve=E[fe],he.x=ve[0],he.y=ve[1],he.z=ve[2],pe.x=ve[3],pe.y=ve[4],pe.z=ve[5],le.x=pe.x,le.y=pe.y,le.z=pe.z,be=Math.asin(pe.y),Me=Math.atan2(-pe.x,pe.z),ue.set(0,1,0),ue.applyAxisAngle(me,-be).applyAxisAngle(ge,-Me),t.addPoints([{position:[he.x+.5*ue.x*de,he.y+.5*ue.y*de,he.z+.5*ue.z*de],color:[1,1,1],normal:[le.x,le.y,le.z],line:0,time:0},{position:[he.x-.5*ue.x*de,he.y-.5*ue.y*de,he.z-.5*ue.z*de],color:[1,1,1],normal:[le.x,le.y,le.z],line:0,time:0}]),!(J()()-a>6)){e.next=114;break}return e.next=113,Object(Qi.c)(0);case 113:a=J()();case 114:fe++,e.next=93;break;case 117:case"end":return e.stop()}},e)})(),"t0",22);case 22:case"end":return u.stop()}},rs)}function Ss(){return new Promise(function(e){return window.requestAnimationFrame(function(){e()})})}function ys(e){var t,n,a,r;return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=.016;case 1:return e.next=4,Object(Qi.f)(La);case 4:if(n=e.sent,!n.get("paused")){e.next=10;break}return e.abrupt("break",19);case 10:return a=performance.now(),e.next=13,Object(Qi.b)(Ss);case 13:return e.next=15,Object(Qi.e)(V.alignerState.incrementTime(t));case 15:r=performance.now(),t=(r-a)/1e3;case 17:e.next=1;break;case 19:case"end":return e.stop()}},is)}function xs(){return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Qi.i)([V.alignerState.play,V.alignerState.pause,V.alignerState.setActivePoint,V.alignerState.nextPoint,V.alignerState.prevPoint],ys);case 2:case"end":return e.stop()}},os)}function Os(){var e,t,n,a,r;return $i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(e=Ao.a.parse(document.location.search),!(t=e.demoKey)){i.next=15;break}return i.next=5,Object(Qi.e)(V.alignerState.loading("verifyingDemoKey","Verifying demo key...","indeterminate"));case 5:return i.next=7,Object(Qi.b)(Yo,{rfid:t});case 7:return n=i.sent,a=n.data,r=n.error,i.next=12,Object(Qi.e)(V.alignerState.stopLoading("verifyingDemoKey"));case 12:return r&&console.error("Error fetching demo key",r),i.next=15,Object(Qi.e)(V.rfid.receivedRfidScanMessage(a));case 15:case"end":return i.stop()}},ss)}function ws(){return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Qi.a)([xs(),Os(),Object(Qi.i)(V.rfid.receivedRfidScanMessage,ms),Object(Qi.i)(V.alignerState.uploadModel,hs),Object(Qi.i)(V.alignerState.finalizeModelClick,ps),Object(Qi.i)(V.alignerState.downloadProcessedModel,gs),Object(Qi.i)(V.alignerState.downloadGCode,fs),Object(Qi.i)(V.alignerState.savePoints,vs),Object(Qi.i)(V.alignerState.saveTransform,bs),Object(Qi.i)([V.alignerState.addPoint,V.alignerState.rotateMachine,V.alignerState.updatePointPosition,V.alignerState.deletePoint,V.alignerState.closePath,V.alignerState.alignerStatusResponse,V.alignerState.importedTransformAndPoints],Ms)]);case 2:case"end":return e.stop()}},cs)}var js=$i.a.mark(Es);function Es(){return $i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Qi.a)([so(),po(),fo(),So(),To(),ws()]);case 2:case"end":return e.stop()}},js)}var Ts=n(348),Ps=Object(ii.b)(),As=Object(ri.createStore)(Ji,ht.a.Map(),Object(Ts.composeWithDevTools)(Object(ri.applyMiddleware)(Ps)));Ps.run(Es),te().pageview("/",document.location.href,document.title).send(),console.log("Pocket NC Simulator v0.3.2"),console.log("Commit","e4789748ec064ad1f94e876369b65c2d57a1af9a"),window.addEventListener("message",function(e){if(e.origin!==document.location.origin){var t=V.iframe.initialize().type,n=V.iframe.rockhopper({}).type,a=V.iframe.embedGcode().type,r=ai.getInstance();switch(e.data.type){case t:As.dispatch(V.iframe.initialize(e.data.payload)),r.addWindow(e.source,e.origin);break;case n:if("file_content"===e.data.payload.id){var i=e.data.payload.data.split("\n").map(function(e){return e.replace("\r","")});As.dispatch(V.interpreter.setLines(i))}else if(e.data.payload.id.startsWith("tool_table")){var o=e.data.payload.id.split(":")[1],s=e.data.payload.data[3],c=e.data.payload.data[10];As.dispatch(V.machineState.tool.table.setTool({P:o,Z:s,R:c}))}break;case a:var l=e.data.payload.split("\n").map(function(e){return e.trim()});As.dispatch(V.interpreter.setLines(l))}}}),window.focus(),v.a.render(g.a.createElement(b.a,{store:As},g.a.createElement(ti.a,{hashType:"noslash"},g.a.createElement(ni.a,{path:"/",exact:!0,component:Zr}))),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat(".","/service-worker.js");Vr?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Br(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):Br(e)})}}()}},[[354,1,2]]]);
//# sourceMappingURL=main.83e97dee.chunk.js.map